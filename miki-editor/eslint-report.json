[{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\AiPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":1,"column":92,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":99},{"ruleId":"no-unused-vars","severity":1,"message":"'API_KEY' is assigned a value but never used.","line":8,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'SERVER_URL' is assigned a value but never used.","line":9,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'CUSTOM_API_ENDPOINT' is assigned a value but never used.","line":15,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'CUSTOM_API_KEY' is assigned a value but never used.","line":16,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":21},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":26,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":26,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1043,1097],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":42,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":42,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1485,1525],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":62,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":62,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2289,2329],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":65,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":65,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2417,2467],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":68,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":68,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2526,2565],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":78,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":78,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2862,2940],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":86,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":86,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3194,3237],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":89,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":89,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3322,3367],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":92,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":92,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3466,3514],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":99,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":99,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3596,3644],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":108,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":108,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3844,3911],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'inEditorCommandContext' is assigned a value but never used.","line":122,"column":71,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":93},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":125,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":125,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4440,4580],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":137,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":137,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4782,4831],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":144,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":144,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5022,5060],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":148,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":148,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5195,5242],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":280,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":280,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9206,9280],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":284,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":284,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9372,9415],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":297,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":297,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9742,9805],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":302,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":302,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9956,10027],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":308,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":308,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10155,10197],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":311,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":311,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10239,10279],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":318,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":318,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10454,10529],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":329,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":329,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10848,10893],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":351,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":351,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11874,12010],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":358,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":358,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12231,12269],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":605,"column":17,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":1020,"endColumn":3},{"ruleId":"no-unused-vars","severity":1,"message":"'promptInput' is assigned a value but never used.","line":606,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":606,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'userInputRows' is assigned a value but never used.","line":608,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":608,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'setUserInputRows' is assigned a value but never used.","line":608,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":608,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'proactiveSuggestionTimeoutRef' is assigned a value but never used.","line":613,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":613,"endColumn":38},{"ruleId":"no-unused-vars","severity":1,"message":"'additionalContext' is assigned a value but never used.","line":617,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":617,"endColumn":27},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":632,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":632,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[27277,27326],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":635,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":635,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[27426,27466],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":651,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":651,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[27908,27939],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":662,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":662,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[28263,28298],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isLoading'. Either include it or remove the dependency array.","line":670,"column":6,"nodeType":"ArrayExpression","endLine":670,"endColumn":70,"suggestions":[{"desc":"Update the dependencies array to be: [editorContext, conversation, userInput, searchRelatedDocuments, isLoading]","fix":{"range":[28453,28517],"text":"[editorContext, conversation, userInput, searchRelatedDocuments, isLoading]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'handleInputChange' is assigned a value but never used.","line":672,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":672,"endColumn":26},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":697,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":697,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[29371,29412],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":699,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":699,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[29510,29550],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":715,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":715,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[30044,30083],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":719,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":719,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[30310,30352],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":727,"column":19,"nodeType":"MemberExpression","messageId":"unexpected","endLine":727,"endColumn":30,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[30729,30776],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":748,"column":27,"nodeType":"MemberExpression","messageId":"unexpected","endLine":748,"endColumn":38,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[31749,31796],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":783,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":783,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[33307,33340],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":799,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":799,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[33983,34020],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has unnecessary dependencies: 'editorContext' and 'onApplyAiCommand'. Either exclude them or remove the dependency array.","line":813,"column":6,"nodeType":"ArrayExpression","endLine":813,"endColumn":92,"suggestions":[{"desc":"Update the dependencies array to be: [isLoading, onDisplaySuggestion, onStructuredCommand]","fix":{"range":[34366,34452],"text":"[isLoading, onDisplaySuggestion, onStructuredCommand]"}}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":840,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":840,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[35076,35109],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":844,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":844,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[35167,35214],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'handleSuggestionAction' is assigned a value but never used.","line":851,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":851,"endColumn":31},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":887,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":887,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[36938,36998],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":889,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":889,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[37022,37051],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":892,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":892,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[37088,37125],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":58,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useEffect, forwardRef, useImperativeHandle, useRef, useMemo } from 'react';\nimport DocumentSummaryManager from './utils/DocumentSummaryManager';\nimport DocumentSearchManager from './utils/DocumentSearchManager';\nimport './styles/AiPanel.css';\n\n// 환경 변수 처리 - Jest 호환성을 위해 기본값 사용\nconst API_TYPE = 'claude';\nconst API_KEY = '';\nconst SERVER_URL = 'http://localhost:3001';\n\n// API 설정\nconst CLAUDE_API_KEY = ''; // 환경변수에서 API 키 가져오기\nconst CLAUDE_API_URL = 'https://api.anthropic.com/v1/messages';\nconst CLAUDE_MODEL = 'claude-3-5-haiku-20241022';\nconst CUSTOM_API_ENDPOINT = 'http://localhost:3100/api/ai/command';\nconst CUSTOM_API_KEY = 'dev_key';\n\n// 문서 요약 관리 인스턴스 생성\nconst documentSummaryManager = new DocumentSummaryManager();\nconst documentSearchManager = new DocumentSearchManager(); // 문서 검색 매니저 인스턴스 추가\n\n// Claude API 응답을 Miki 포맷으로 변환하는 함수\nconst transformClaudeResponse = (claudeResponse) => {\n  try {\n    if (!claudeResponse || !claudeResponse.content || claudeResponse.content.length === 0) {\n      console.error('Claude API 응답 형식 오류:', claudeResponse);\n      return JSON.stringify({\n        isSuggestion: false,\n        isCommand: false,\n        action: \"display_text\",\n        commandType: \"error\",\n        displayText: \"Claude API 응답 형식이 올바르지 않습니다.\"\n      });\n    }\n\n    // Claude 응답에서 텍스트 추출\n    const textContent = claudeResponse.content\n      .filter(item => item.type === 'text')\n      .map(item => item.text)\n      .join('\\n');\n\n    console.log('추출된 텍스트 내용:', textContent);\n\n    // JSON 블록 추출 (```json ... ``` 형식)\n    const jsonMatch = textContent.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n    \n    if (jsonMatch && jsonMatch[1]) {\n      try {\n        // 마지막 시도: JSON.parse 실패 시 안전한 대안 사용\n        try {\n          // eval() 대신 안전한 JSON 파싱 시도\n          // 기본적인 JSON 수정을 통해 파싱 가능하게 만들기\n          let cleanJson = jsonMatch[1].trim();\n          \n          // 일반적인 JavaScript 객체 표기법을 JSON으로 변환\n          cleanJson = cleanJson\n            .replace(/([{,]\\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*:/g, '$1\"$2\":') // 키를 따옴표로 감싸기\n            .replace(/:\\s*'([^']*)'/g, ': \"$1\"') // 단일 따옴표를 이중 따옴표로\n            .replace(/:\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*([,}])/g, ': \"$1\"$2'); // 값을 따옴표로 감싸기\n          \n          const jsonObj = JSON.parse(cleanJson);\n          console.log('안전한 JSON 파싱 성공:', jsonObj);\n          return JSON.stringify(jsonObj);\n        } catch (safeParseError) {\n          console.error('안전한 JSON 파싱도 실패:', safeParseError);\n          \n          // 모든 파싱이 실패하면 텍스트 응답으로 처리\n          console.log('JSON 파싱 실패, 텍스트 응답으로 처리');\n          return JSON.stringify({\n            isSuggestion: false,\n            isCommand: false,\n            action: \"display_text\",\n            commandType: \"info\",\n            displayText: jsonMatch[1].trim() // 원본 JSON 문자열을 텍스트로 표시\n          });\n        }\n      } catch (parseError) {\n        console.error('Claude 응답에서 JSON 파싱 실패:', parseError, '원본 텍스트:', jsonMatch[1]);\n        \n        // JSON 파싱 실패 시 다른 형태의 JSON을 찾아봄\n        const altJsonMatch = textContent.match(/{[\\s\\S]*}/);\n        if (altJsonMatch) {\n          try {\n            // 중괄호 내부 내용만 추출해서 파싱 시도\n            const jsonContent = altJsonMatch[0];\n            console.log('대체 JSON 형식 찾음:', jsonContent);\n            \n            const altParsedJson = JSON.parse(jsonContent);\n            console.log('대체 JSON 파싱 성공:', altParsedJson);\n            return JSON.stringify(altParsedJson);\n          } catch (altParseError) {\n            console.error('대체 JSON 파싱도 실패:', altParseError);\n          }\n        }\n      }\n    }\n    \n    // JSON 파싱이 모두 실패하면 텍스트 응답으로 처리\n    console.log('JSON 형식을 찾을 수 없어 텍스트 응답으로 처리합니다.');\n    return JSON.stringify({\n      isSuggestion: false,\n      isCommand: false,\n      action: \"display_text\",\n      commandType: \"info\",\n      displayText: textContent\n    });\n  } catch (error) {\n    console.error('Claude 응답 변환 오류:', error, '원본 응답:', claudeResponse);\n    return JSON.stringify({\n      isSuggestion: false,\n      isCommand: false,\n      action: \"display_text\",\n      commandType: \"error\",\n      displayText: \"AI 응답 처리 중 오류가 발생했습니다. 다시 시도해주세요.\"\n    });\n  }\n};\n\n// AI API와 통신하여 응답을 받아오는 함수\nconst getAiResponse = async (requestData, editorContext, isProactiveSuggestionCheck = false) => {\n  const { fullContent, selection } = editorContext;\n  const { text: userCommand, type: commandTypeSource, commandContext: inEditorCommandContext } = requestData || {};\n  \n  // 환경 변수 디버깅 로그 추가\n  console.log('API 환경 설정:', {\n    API_TYPE,\n    CLAUDE_API_KEY: CLAUDE_API_KEY ? '설정됨' : '설정되지 않음',\n    CLAUDE_API_URL,\n    CLAUDE_MODEL\n  });\n  \n  // 개발 모드나 시뮬레이션 모드에서는 가짜 응답 반환 - 조건 수정\n  // const useSimulation = true; // 문제 해결을 위해 항상 시뮬레이션 모드 사용\n  const useSimulation = false; // 백엔드 프록시 서버를 통해 실제 Claude API 호출\n  \n  if (useSimulation) {\n    console.log('시뮬레이션 응답을 사용합니다. 명령:', userCommand);\n    return await simulateAiResponse(requestData, editorContext, isProactiveSuggestionCheck);\n  }\n  \n  // Claude API를 사용하는 경우\n  if (API_TYPE === 'claude' && CLAUDE_API_KEY) {\n    try {\n      console.log('Claude API로 요청 전송 중...');\n      \n      // 선제적 제안 체크 시 복잡한 작업은 건너뛰기\n      if (isProactiveSuggestionCheck && (!fullContent || fullContent.length < 10)) {\n        console.log('선제적 제안 체크: 컨텍스트가 충분하지 않아 건너뜁니다.');\n        return null;\n      }\n      \n      // 문서 요약 처리 (토큰 최적화)\n      let contextDescription = \"\";\n      let documentSummary = null;\n      \n      if (fullContent) {\n        // 문서 ID 생성 (간단하게 타임스탬프 사용)\n        const docId = `doc_${Date.now()}`;\n        \n        // 문서 요약 처리\n        documentSummary = documentSummaryManager.processDocument(docId, fullContent);\n        \n        if (documentSummary) {\n          // 요약된 정보 사용\n          contextDescription += \"현재 문서 구조:\\n\" + documentSummary.summary + \"\\n\\n\";\n          \n          // 선택 영역 주변 컨텍스트만 상세하게 제공\n          if (selection && selection.cursor) {\n            const lineNumber = selection.cursor[0];\n            const context = documentSummaryManager.getContextAroundLine(docId, lineNumber, 10);\n            \n            if (context) {\n              contextDescription += `현재 커서가 위치한 \"${context.section}\" 섹션 내용:\\n`;\n              contextDescription += \"```\\n\" + context.context + \"\\n```\\n\\n\";\n            } else {\n              // 컨텍스트를 찾지 못한 경우 전체 문서의 일부만 제공\n              contextDescription += \"현재 문서는 \" + fullContent.length + \"자 분량입니다.\\n\";\n              if (fullContent.length > 1000) {\n                contextDescription += \"문서 내용 일부:\\n```\\n\" + fullContent.substring(0, 1000) + \"...\\n```\\n\\n\";\n              } else {\n        contextDescription += \"문서 내용:\\n```\\n\" + fullContent + \"\\n```\\n\\n\";\n      }\n            }\n          } else {\n            // 커서 정보가 없는 경우 전체 문서 정보 요약만 제공\n            contextDescription += \"현재 문서는 \" + fullContent.length + \"자 분량입니다.\\n\";\n          }\n        } else {\n          // 요약 실패 시 원래 방식으로 처리\n          contextDescription += \"현재 문서는 \" + fullContent.length + \"자 분량입니다.\\n\";\n          \n          // 문서가 너무 길면 일부만 사용\n          if (fullContent.length > 3000) {\n            contextDescription += \"문서 내용 일부:\\n```\\n\" + fullContent.substring(0, 3000) + \"...\\n```\\n\\n\";\n          } else {\n            contextDescription += \"문서 내용:\\n```\\n\" + fullContent + \"\\n```\\n\\n\";\n          }\n        }\n      }\n      \n      // 선택 영역 정보 추가\n      if (selection && selection.text) {\n        const selectionPreview = selection.text.length > 100 \n          ? selection.text.substring(0, 100) + \"...\" \n          : selection.text;\n        contextDescription += \"현재 선택된 텍스트: \\\"\" + selectionPreview + \"\\\"\\n\\n\";\n      } else if (selection && selection.cursor) {\n        contextDescription += \"커서 위치: \" + (selection.cursor[0]+1) + \"번째 줄, \" + selection.cursor[1] + \"번째 문자\\n\\n\";\n      }\n      \n      // 명령 정보\n      const commandInfo = (userCommand || '(선제적 제안 요청)');\n      const commandSource = (commandTypeSource || '직접 입력');\n      \n      // 선제적 제안 정보\n      const proactiveInfo = isProactiveSuggestionCheck\n        ? \"이것은 선제적 제안 요청입니다. 문서 컨텍스트를 보고 도움이 될만한 제안이 있으면 제안하고, 없으면 null로 응답하세요.\"\n        : \"\";\n      \n      // 전체 프롬프트 구성\n      const prompt = `당신은 마크다운 위키 에디터 Miki의 AI 동료입니다. 사용자 요청에 따라 다음 두 가지 역할을 수행합니다:\n\n1. 글쓰기 동료: 사용자와 대화하며 글을 함께 발전시킵니다.\n2. 문서 관리자: 문서 검색, 링크 생성, 마크다운 서식 등을 지원합니다.\n\n응답 규칙:\n- 사용자 요청이 문서 링크/검색 관련이면 → insert_markdown_link 액션 생성\n- 사용자 요청이 일반 대화/글 확장이면 → insert_content 액션 생성\n- 사용자 요청이 마크다운 서식 관련이면 → 해당 서식 액션 생성\n\n컨텍스트 정보:\n${contextDescription}\n\n현재 명령 (${commandSource}):\n${commandInfo}\n\n${proactiveInfo}\n\nJSON 응답 형식:\n\\`\\`\\`json\n{\n  \"isSuggestion\": true,\n  \"suggestionType\": \"[액션 유형]\",\n  \"displayText\": \"[사용자에게 보여줄 제안 텍스트]\",\n  \"actions\": [\n    {\n      \"actionType\": \"[액션 타입]\",\n      \"range\": \"cursor\",\n      \"content\": \"[삽입할 내용]\"\n    }\n  ]\n}\n\\`\\`\\`\n\n액션 타입 목록:\n- insert_content: 일반 텍스트 삽입 (대화/글 확장)\n- insert_markdown_link: 마크다운 링크 삽입\n- format_bold, format_italic 등: 마크다운 서식\n\n중요: 반드시 위 JSON 형식으로만 응답하세요. 다른 설명이나 텍스트는 포함하지 마세요.`;\n      \n      // Claude API 요청 구성\n      const claudeRequest = {\n        model: CLAUDE_MODEL,\n        messages: [\n          {\n            role: \"user\",\n            content: [\n              {\n                type: \"text\",\n                text: prompt\n              }\n            ]\n          }\n        ],\n        max_tokens: 2000,\n        temperature: 0.1,\n      };\n\n      console.log('Claude API 요청 데이터:', JSON.stringify(claudeRequest, null, 2));\n\n      // 백엔드 API 엔드포인트\n      const backendUrl = 'http://localhost:3003/api/claude';\n      console.log('백엔드 API 요청 URL:', backendUrl);\n\n      // 백엔드 프록시 서버를 통해 API 호출\n      const response = await fetch(backendUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(claudeRequest),\n      });\n      \n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error(\"Claude API 응답 오류:\", response.status, errorText);\n        throw new Error(`Claude API 응답 오류: ${response.status}, ${errorText}`);\n      }\n      \n      const responseData = await response.json();\n      console.log('Claude 응답 수신 완료:', JSON.stringify(responseData, null, 2));\n      \n      // Claude 응답을 Miki 포맷으로 변환\n      return transformClaudeResponse(responseData);\n      \n    } catch (error) {\n      console.error('Claude API 통신 오류:', error);\n      \n      // 오류 발생 시 시뮬레이션으로 폴백\n      console.log('API 오류 발생, 시뮬레이션 응답으로 폴백');\n      return await simulateAiResponse(requestData, editorContext, isProactiveSuggestionCheck);\n    }\n  }\n  \n  // Claude API 설정이 없는 경우 시뮬레이션으로 대체\n  if (!CLAUDE_API_KEY) {\n    console.log('Claude API 키가 설정되지 않았습니다. 환경 변수에 API 키를 설정하거나 코드에 직접 입력하세요.');\n    // 사용자에게 알림 표시\n    return JSON.stringify({\n      isSuggestion: false,\n      isCommand: false,\n      action: \"display_text\",\n      commandType: \"error\",\n      displayText: \"Claude API 키가 설정되지 않았습니다. Miki Editor를 사용하려면 Claude API 키를 설정해주세요. AiPanel.jsx 파일의 CLAUDE_API_KEY 변수에 API 키를 직접 입력할 수 있습니다.\"\n    });\n  }\n  \n  console.log('Claude API 설정 확인 필요, 시뮬레이션 사용');\n  return await simulateAiResponse(requestData, editorContext, isProactiveSuggestionCheck);\n};\n\n// 기존 시뮬레이션 코드 유지\nconst simulateAiResponse = async (requestData, editorContext, isProactiveSuggestionCheck = false) => {\n  const { fullContent, selection } = editorContext;\n  const { text: userCommand, type: commandTypeSource, commandContext: inEditorCommandContext } = requestData || {};\n\n  let contextSummary = \"\";\n  if (fullContent) {\n    contextSummary += `Document is ${fullContent.length} chars long.`;\n  }\n  if (selection && selection.text) {\n    contextSummary += ` Selected: \"${selection.text.substring(0, 50)}...\".`;\n  } else if (selection && selection.cursor) {\n    contextSummary += ` Cursor at line ${selection.cursor[0]}, char ${selection.cursor[1]}.`;\n  }\n  if (inEditorCommandContext && inEditorCommandContext.fullLineText) {\n    contextSummary += ` Command issued on line ${inEditorCommandContext.lineNumber}: \"${inEditorCommandContext.fullLineText.trim()}\".`;\n  }\n\n  console.log(`시뮬레이션 AI: 명령 \"${userCommand}\" (유형: ${commandTypeSource}, 선제적 체크: ${isProactiveSuggestionCheck}). 컨텍스트: ${contextSummary}`);\n  \n  // 선제적 체크가 아닌 경우 더 긴 지연 시간으로 실제 API 호출 시뮬레이션\n  await new Promise(resolve => setTimeout(resolve, isProactiveSuggestionCheck ? 700 : 1300));\n\n  // 명령이 없으면 기본 응답\n  if (!userCommand && isProactiveSuggestionCheck) {\n    console.log('선제적 제안 체크이지만 제안할 내용 없음');\n    return null;\n  }\n\n  const lowerCommand = userCommand ? userCommand.toLowerCase() : \"\";\n  const suggestionId = `sugg_${Date.now()}_${Math.random().toString(36).substring(2, 7)}`;\n\n  // 일반 텍스트 응답 명령 처리\n  if (lowerCommand.startsWith('안녕') || \n      lowerCommand.includes('반가워') || \n      lowerCommand.includes('hello') || \n      lowerCommand.includes('hi')) {\n    return JSON.stringify({\n      isSuggestion: false,\n      isCommand: false,\n      action: \"display_text\",\n      commandType: \"info\",\n      displayText: `안녕하세요! Miki Editor의 AI 어시스턴트입니다. 무엇을 도와드릴까요?`\n    });\n  }\n  \n  // 에디터 명령어가 아닌 일반 질문으로 보이는 경우\n  if (lowerCommand.endsWith('?') || \n      lowerCommand.endsWith('을까요') || \n      lowerCommand.endsWith('일까요') || \n      lowerCommand.endsWith('인가요') ||\n      lowerCommand.startsWith('왜') ||\n      lowerCommand.startsWith('어떻게') ||\n      lowerCommand.startsWith('무엇')) {\n    return JSON.stringify({\n      isSuggestion: false,\n      isCommand: false,\n      action: \"display_text\",\n      commandType: \"info\",\n      displayText: `질문하신 \"${userCommand}\"에 관해서는, 에디터 기능이 아니라 일반적인 정보를 요청하신 것 같습니다. 저는 현재 에디터 내용을 수정하고 관리하는 기능에 중점을 두고 있습니다. 마크다운 형식 지정이나 문서 구조화에 관한 도움이 필요하시면 말씀해주세요.`\n    });\n  }\n\n  const getTargetRange = () => {\n    if (selection && selection.range && selection.text) return selection.range;\n    if (inEditorCommandContext && typeof inEditorCommandContext.lineNumber === 'number') {\n        const lineText = inEditorCommandContext.fullLineText;\n        // For Toast UI, line numbers are 1-based, array indices are 0-based for range.\n        // Assuming lineNumber is 1-based from editor, convert to 0-based for range.\n        const zeroBasedLine = inEditorCommandContext.lineNumber -1; \n        return { \n            from: [zeroBasedLine, 0], \n            to: [zeroBasedLine, lineText ? lineText.length : 0]\n        };\n    }\n    return selection?.range || null; // [[line, char], [line, char]]\n  };\n  const targetRange = getTargetRange();\n  const targetTextForCommand = selection?.text || (inEditorCommandContext?.fullLineText ? inEditorCommandContext.fullLineText.trim() : \"\");\n\n  // Helper to create the 'actions' part of the suggestion, or a direct command if needed.\n  const createAction = (actionType, commandType, content = null, customRange = null, additionalProps = {}) => {\n    return {\n      actionId: `act_${Date.now()}_${Math.random().toString(36).substring(2, 7)}`,\n      actionType: actionType,\n      commandType: commandType,\n      range: customRange || targetRange,\n      content: content,\n      targetText: targetTextForCommand,\n      ...additionalProps\n    };\n  };\n\n  // Helper to create the full suggestion JSON\n  const createSuggestionResponse = (suggestionType, displayText, actions, userCmd = userCommand, src = commandTypeSource) => {\n    return JSON.stringify({\n      isSuggestion: true,\n      suggestionId: suggestionId,\n      suggestionType: suggestionType,\n      displayText: displayText,\n      userCommand: userCmd,\n      source: src || (inEditorCommandContext ? \"user_command_editor\" : \"user_command_panel\"),\n      actions: Array.isArray(actions) ? actions : [actions],\n      confidenceScore: 0.9\n    });\n  };\n\n  // --- Proactive Suggestion Logic (isProactiveSuggestionCheck = true) ---\n  if (isProactiveSuggestionCheck) {\n    const lines = fullContent ? fullContent.split('\\n') : [];\n    if (lines.length > 15 && !fullContent.match(/^#\\s.+/m) && !fullContent.match(/^title:/im)) {\n      return createSuggestionResponse(\n        \"proactive_add_title\",\n        \"This document is getting quite long. Would you like me to suggest a title based on the content?\",\n        createAction(\"generate_title\", \"title_generation\", \"suggest a title for this document\", null, { targetText: fullContent }),\n        null, // No user command for proactive\n        \"proactive_ai_pattern_analysis\"\n      );\n    }\n    if (fullContent && fullContent.split('\\n').length > 20 && !fullContent.toLowerCase().includes(\"table of contents\") && fullContent.match(/^(##|###)\\s.+/gm)) {\n      return createSuggestionResponse(\n        \"proactive_add_toc\",\n        \"I see several headings. Would you like to add a Table of Contents?\",\n        createAction(\"create_toc\", \"toc\", fullContent),\n        null,\n        \"proactive_ai_pattern_analysis\"\n      );\n    }\n    const simpleListItems = lines.filter(line => line.trim().startsWith(\"- \") && !line.trim().startsWith(\"- [\"));\n    if (simpleListItems.length >= 3) {\n      return createSuggestionResponse(\n        \"proactive_convert_to_checklist\",\n        \"I see a list here. Would you like to convert it to a checklist (task list)?\",\n        createAction(\"convert_list\", \"taskList\", null, \"current_list_range\"), // Placeholder for actual range detection\n        null,\n        \"proactive_ai_pattern_analysis\"\n      );\n    }\n    const longParagraphs = lines.filter(line => line.length > 300 && !line.match(/^#+\\s/));\n    if (longParagraphs.length > 0) {\n        return createSuggestionResponse(\n            \"proactive_add_subheadings\",\n            \"Some paragraphs seem quite long. Would you like me to try and add subheadings to break them up?\",\n            createAction(\"generate_subheadings\", \"subheading_suggestion\", fullContent),\n            null,\n            \"proactive_ai_pattern_analysis\"\n        );\n    }\n    return null; // No proactive suggestion\n  }\n\n  // --- User Command Processing Logic (all become suggestions now) ---\n  if (lowerCommand.includes(\"bold\")) {\n    return createSuggestionResponse(\"format_bold\", `Format \"${targetTextForCommand || 'selection'}\" as bold?`, createAction(\"apply_style\", \"bold\"));\n  } else if (lowerCommand.includes(\"italic\")) {\n    return createSuggestionResponse(\"format_italic\", `Format \"${targetTextForCommand || 'selection'}\" as italic?`, createAction(\"apply_style\", \"italic\"));\n  } else if (lowerCommand.includes(\"strike\")) {\n    return createSuggestionResponse(\"format_strike\", `Format \"${targetTextForCommand || 'selection'}\" with strikethrough?`, createAction(\"apply_style\", \"strike\"));\n  } else if (lowerCommand.includes(\"inline code\")) {\n    return createSuggestionResponse(\"format_inline_code\", `Format \"${targetTextForCommand || 'selection'}\" as inline code?`, createAction(\"apply_style\", \"code\"));\n  }\n\n  if (lowerCommand.startsWith(\"insert \")) {\n    const contentToInsert = userCommand.substring(\"insert \".length).trim();\n    return createSuggestionResponse(\"insert_text\", `Insert \"${contentToInsert.substring(0,30)}...\"?`, createAction(\"insert_content\", \"text\", contentToInsert));\n  }\n  if (lowerCommand.startsWith(\"replace this with \") || lowerCommand.startsWith(\"replace selection with \")) {\n    const contentToReplaceWith = userCommand.substring(userCommand.indexOf(\" with \") + \" with \".length).trim();\n    return createSuggestionResponse(\"replace_text\", `Replace \"${targetTextForCommand || 'selection'}\" with \"${contentToReplaceWith.substring(0,30)}...\"?`, createAction(\"replace_content\", \"text\", contentToReplaceWith, targetRange));\n  }\n  if (lowerCommand.startsWith(\"change this line to \")) {\n    const newLineContent = userCommand.substring(\"change this line to \".length).trim();\n    if (inEditorCommandContext && typeof inEditorCommandContext.lineNumber === 'number'){\n        return createSuggestionResponse(\"replace_line_text\", `Change line ${inEditorCommandContext.lineNumber} to \"${newLineContent.substring(0,30)}...\"?`, createAction(\"replace_line\", \"text\", newLineContent, null, { lineNumber: inEditorCommandContext.lineNumber }));\n    }\n  }\n\n  const headingMatch = lowerCommand.match(/(?:make this|create|set as) (heading|h)(\\d)(?:\\s*:\\s*(.*))?/i);\n  if (headingMatch) {\n    const level = parseInt(headingMatch[2], 10);\n    const headingText = headingMatch[3] ? headingMatch[3].trim() : (targetTextForCommand || \"New Heading\");\n    if (level >= 1 && level <= 6) {\n      const headingContent = `${\"#\".repeat(level)} ${headingText}`;\n      let actionType = \"insert_content\";\n      let displayText = `Insert H${level}: \"${headingText}\"?`;\n      if (targetRange && targetRange.from[0] === targetRange.to[0] && targetTextForCommand) {\n         actionType = \"replace_line\";\n         displayText = `Change line to H${level}: \"${headingText}\"?`;\n         return createSuggestionResponse(`format_heading_${level}`, displayText, createAction(actionType, `h${level}`, headingContent, null, { lineNumber: targetRange.from[0] }));\n      } else {\n         return createSuggestionResponse(`create_heading_${level}`, displayText, createAction(actionType, `h${level}`, headingContent));\n      }\n    }\n  }\n\n  const linkMatch = lowerCommand.match(/(?:link this to|create link to|make this a link to) (https?:\\/\\/[^\\s]+)(?: with text (.*))?/i);\n  const internalLinkMatch = lowerCommand.match(/(?:link this to note|create internal link to) ([\\w\\s-]+)(?: with text (.*))?/i);\n  if (linkMatch) {\n    const url = linkMatch[1];\n    const linkText = linkMatch[2] || targetTextForCommand || \"link\";\n    return createSuggestionResponse(\"create_external_link\", `Create link to ${url} with text \"${linkText}\"?`, createAction(\"create_link\", \"external\", url, null, { linkText: linkText }));\n  } else if (internalLinkMatch) {\n    const noteName = internalLinkMatch[1];\n    const linkText = internalLinkMatch[2] || targetTextForCommand || noteName;\n    return createSuggestionResponse(\"create_internal_link\", `Create internal link to note \"${noteName}\" with text \"${linkText}\"?`, createAction(\"create_link\", \"internal\", slugify(noteName) + \".md\", null, { linkText: linkText, noteSlug: noteName }));\n  }\n\n  const listMatch = lowerCommand.match(/(?:create|make) (an? )?(ordered|numbered|bullet|unordered|task|check) list(?: with items:? (.*))?/i);\n  if (listMatch) {\n    let listTypeCmd = \"ul\";\n    if (listMatch[2].includes(\"order\") || listMatch[2].includes(\"number\")) listTypeCmd = \"ol\";\n    if (listMatch[2].includes(\"task\") || listMatch[2].includes(\"check\")) listTypeCmd = \"taskList\";\n    let items = listMatch[3] ? listMatch[3].split(/, | and /).map(item => item.trim()) : [\"Item 1\", \"Item 2\"];\n    if (targetTextForCommand && targetTextForCommand.includes('\\n')) {\n        items = targetTextForCommand.split('\\n').map(s => s.trim()).filter(s => s);\n    } else if (targetTextForCommand && !listMatch[3]) {\n        items = [targetTextForCommand.trim()];\n    }\n    return createSuggestionResponse(`create_list_${listTypeCmd}`, `Create ${listMatch[2]} list with items: ${items.join(', ').substring(0,50)}...?`, createAction(\"create_list\", listTypeCmd, items));\n  }\n  if (lowerCommand === \"convert current list to checklist\") {\n    return createSuggestionResponse(\"convert_to_checklist\", \"Convert current list to checklist?\", createAction(\"convert_list\", \"taskList\", null, targetRange || \"current_list_range\"));\n  }\n\n  const tableMatch = lowerCommand.match(/(?:create|make) a table(?: with (\\d+) columns? and (\\d+) rows?)?(?: with headers:? (.*))?/i);\n  if (tableMatch) {\n    const cols = tableMatch[1] ? parseInt(tableMatch[1], 10) : (tableMatch[3] ? tableMatch[3].split(/, | and /).length : 2);\n    const rows = tableMatch[2] ? parseInt(tableMatch[2], 10) : 2;\n    const headers = tableMatch[3] ? tableMatch[3].split(/, | and /).map(h => h.trim()) : Array(cols).fill(null).map((_, i) => `Header ${i + 1}`);\n    return createSuggestionResponse(\"create_table\", `Create a table with ${cols} cols, ${rows} rows, and headers: ${headers.join(', ')}?`, createAction(\"create_table\", \"table\", { rows: rows, cols: Math.max(cols, headers.length), headers: headers }));\n  }\n\n  const codeBlockMatch = lowerCommand.match(/(?:create|make) a (javascript|python|java|c\\+\\+|c#|ruby|php|go|rust|css|html|shell|bash|text)? code block(?: with content:? ([\\s\\S]*))?/i);\n  if (codeBlockMatch) {\n    const language = codeBlockMatch[1] || \"\";\n    const codeContent = codeBlockMatch[2] || targetTextForCommand || \"// your code here\";\n    return createSuggestionResponse(\"insert_code_block\", `Insert ${language || 'plain text'} code block?`, createAction(\"insert_code_block\", language || \"plaintext\", codeContent));\n  }\n  \n  if (lowerCommand.includes(\"make this a quote\") || lowerCommand.includes(\"blockquote\")) {\n    return createSuggestionResponse(\"format_quote\", `Format \"${targetTextForCommand || 'selection'}\" as a quote?`, createAction(\"apply_style\", \"quote\"));\n  }\n\n  const footnoteMatch = lowerCommand.match(/(?:add|create|insert) footnote(?: with text:? (.*))?/i);\n  if (footnoteMatch) {\n    const footnoteText = footnoteMatch[1] || \"Your footnote here\";\n    const refText = targetTextForCommand || \"reference\";\n    return createSuggestionResponse(\"insert_footnote\", `Insert footnote for \"${refText}\" with text \"${footnoteText.substring(0,30)}...\"?`, createAction(\"insert_footnote\", \"footnote\", footnoteText, null, { refText: refText }));\n  }\n\n  if (lowerCommand.includes(\"create table of contents\") || lowerCommand.includes(\"add toc\")) {\n    return createSuggestionResponse(\"create_toc_suggestion\", \"Create a Table of Contents for this document?\", createAction(\"create_toc\", \"toc\", fullContent));\n  }\n  \n  // Fallback for unhandled commands - now also a suggestion, but maybe a less confident one or just info.\n  // For now, let's make it a non-actionable info display via the old mechanism if no clear suggestion can be made.\n  return JSON.stringify({\n    isSuggestion: false, // This is not a suggestion to act upon, but info to display\n    isCommand: false,    // And not a direct command either\n    action: \"display_text\", // Tells AiPanel to just display this message\n    commandType: \"info\",\n    displayText: `I received your command: \"${userCommand}\". I'm not sure how to turn that into a specific suggestion right now. How can I help you with Markdown formatting or content generation?`,\n    targetText: userCommand\n  });\n};\n\nconst slugify = (str) =>\n  str.toLowerCase()\n     .trim()\n     .replace(/[\\s\\W-]+/g, '-')\n     .replace(/^-+|-+$/g, '');\n\nconst AiPanel = forwardRef(({ editorContext, onApplyAiCommand, onDisplaySuggestion, onStructuredCommand }, ref) => {\n  const [promptInput, setPromptInput] = useState(''); \n  const [userInput, setUserInput] = useState('');\n  const [userInputRows, setUserInputRows] = useState(3);\n  const userInputRef = useRef(null);\n  const [conversation, setConversation] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const conversationEndRef = useRef(null);\n  const proactiveSuggestionTimeoutRef = useRef(null);\n  const [relatedDocuments, setRelatedDocuments] = useState([]);\n  const [showRelatedDocuments, setShowRelatedDocuments] = useState(false);\n  const [selectedDocuments, setSelectedDocuments] = useState([]);\n  const [additionalContext, setAdditionalContext] = useState([]);\n  const [expanded, setExpanded] = useState(true); // 패널 확장 상태 추가\n  \n  // 패널 접기/펼치기 토글 함수\n  const handleExpandToggle = () => {\n    setExpanded(prev => !prev);\n  };\n\n  useEffect(() => {\n    conversationEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [conversation]);\n\n  // 문서 검색 기능\n  const searchRelatedDocuments = useCallback(async (searchQuery) => {\n    try {\n      console.log(\"AI 패널에서 관련 문서 검색 시작:\", searchQuery);\n      return await documentSearchManager.searchDocuments(searchQuery);\n    } catch (error) {\n      console.error(\"AI 패널 문서 검색 오류:\", error);\n      return [];\n    }\n  }, []);\n\n  // 프로액티브 제안 검사\n  useEffect(() => {\n    // 사용자가 질문 중일 때 관련 문서 검색 여부 확인\n    if (!userInput || userInput.length < 3 || isLoading) return;\n    \n    // 디바운스 실행으로 너무 자주 체크하지 않도록 함\n    const checkForProactiveSuggestions = async () => {\n      // 현재 입력중인 질문이 문서 검색이나 요약에 관한 것인지 확인\n      const isSearchQuery = /검색|찾아|유사한|관련된|문서/.test(userInput);\n      \n      if (isSearchQuery && conversation.length > 0) {\n        console.log(\"관련 문서 검색 쿼리 감지됨\");\n        \n        try {\n          const relatedDocs = await searchRelatedDocuments(userInput);\n          \n          if (relatedDocs.length > 0) {\n            // 검색 결과가 있으면 상태 업데이트하여 UI에 표시\n            setRelatedDocuments(relatedDocs);\n            setShowRelatedDocuments(true);\n          }\n        } catch (err) {\n          console.error(\"프로액티브 검색 오류:\", err);\n        }\n      }\n    };\n\n    // 디바운스 타이머 설정\n    const timer = setTimeout(checkForProactiveSuggestions, 2000);\n    return () => clearTimeout(timer);\n  }, [editorContext, conversation, userInput, searchRelatedDocuments]);\n\n  const handleInputChange = (event) => {\n    setPromptInput(event.target.value);\n  };\n\n  const processUserRequestInternal = useCallback(async (requestData, currentEditorContext) => {\n    const commandText = requestData.text;\n    if (!commandText || !commandText.trim() || isLoading || !currentEditorContext) return;\n\n    // Clear any existing UI suggestions in MikiEditor (MikiEditor will need a method for this)\n    if (onDisplaySuggestion) onDisplaySuggestion(null); \n\n    const userMessage = { type: 'user', text: commandText }; \n    setConversation(prev => [...prev, userMessage]);\n    setIsLoading(true);\n    setUserInput(''); // userInput 비우기\n\n    // 로딩 메시지 추가\n    const loadingMessage = { \n      type: 'ai', \n      text: '명령을 처리 중입니다...', \n      isLoading: true \n    };\n    setConversation(prev => [...prev, loadingMessage]);\n\n    try {\n      console.log('AI에 요청 전송 중:', commandText);\n      const rawAiResponse = await getAiResponse(requestData, currentEditorContext, false);\n      console.log(\"AI 원본 응답:\", rawAiResponse); // 디버깅용 로그 추가\n      \n      // 로딩 메시지 제거\n      setConversation(prev => prev.filter(msg => !msg.isLoading));\n      \n      let aiTextToDisplayInPanel = \"\";\n      let parsedResponse = null;\n      \n      if (rawAiResponse) {\n        try {\n          // 원본 응답이 null인 경우 처리\n          if (rawAiResponse === null) {\n            aiTextToDisplayInPanel = \"AI 응답이 없습니다. 다시 시도해주세요.\";\n          } else {\n            // JSON 형식으로 응답이 왔는지 확인\n            parsedResponse = JSON.parse(rawAiResponse);\n            console.log(\"파싱된 응답:\", parsedResponse); // 파싱된 응답 로그\n            \n            // 1단계: 구조화 명령(action/actionType 등)이 있으면 사용자에게 확인 요청\n            if (parsedResponse && (parsedResponse.action || parsedResponse.actionType || parsedResponse.isSuggestion)) {\n              console.log(\"구조화 명령 감지:\", parsedResponse); // 디버깅 로그\n              \n              // 에디터에 직접 명령을 전달하는 대신 표시를 위한 메시지로 변환\n                if (parsedResponse.isSuggestion && parsedResponse.displayText) {\n                  aiTextToDisplayInPanel = `💡 제안: ${parsedResponse.displayText}`;\n                \n                // onDisplaySuggestion 콜백이 있으면 제안을 표시합니다\n                if (onDisplaySuggestion) {\n                  console.log(\"제안을 에디터에 표시합니다:\", parsedResponse);\n                  onDisplaySuggestion(parsedResponse);\n                }\n                } else if (parsedResponse.action === \"display_text\" && parsedResponse.displayText) {\n                // display_text 액션은 텍스트만 표시하고 에디터를 변경하지 않음\n                  aiTextToDisplayInPanel = parsedResponse.displayText;\n                } else {\n                // 다른 모든 명령은 사용자 확인 후 실행하도록 AiPanel에 표시\n                aiTextToDisplayInPanel = \"AI가 에디터에 다음 작업을 수행하려고 합니다. 아래 '실행' 버튼을 클릭하면 변경이 적용됩니다.\";\n                \n                // 명령을 실행할 수 있는 버튼을 대화창에 추가\n                const pendingCommandMessage = { \n                  type: 'ai', \n                  text: aiTextToDisplayInPanel,\n                  isPendingCommand: true,\n                  pendingCommand: parsedResponse,\n                  actionButtons: [\n                    {\n                      label: '실행',\n                      action: () => {\n                        if (onStructuredCommand) {\n                          console.log(\"사용자 승인 후 명령 실행:\", parsedResponse);\n                          onStructuredCommand(parsedResponse);\n                          // 액션 버튼을 숨기고 텍스트 업데이트\n                          setConversation(prev => prev.map(msg => \n                            msg.isPendingCommand ? \n                              {...msg, text: \"✅ 명령이 실행되었습니다.\", isPendingCommand: false, actionButtons: null} : \n                              msg\n                          ));\n                        }\n                      }\n                    },\n                    {\n                      label: '취소',\n                      action: () => {\n                        // 액션 버튼을 숨기고 텍스트 업데이트\n                        setConversation(prev => prev.map(msg => \n                          msg.isPendingCommand ? \n                            {...msg, text: \"❌ 명령이 취소되었습니다.\", isPendingCommand: false, actionButtons: null} : \n                            msg\n                        ));\n                      }\n                    }\n                  ]\n                };\n                \n                setConversation(prev => [...prev.filter(msg => !msg.isLoading), pendingCommandMessage]);\n                return; // 이 함수 종료\n              }\n            } else if (parsedResponse.action === \"display_text\" && parsedResponse.displayText) {\n              aiTextToDisplayInPanel = parsedResponse.displayText;\n            } else {\n              aiTextToDisplayInPanel = `AI가 응답했지만 명확한 명령이 아닙니다: \"${JSON.stringify(parsedResponse)}\"`;\n            }\n          }\n        } catch (e) {\n          console.error(\"AI 응답 파싱 오류:\", e);\n          // JSON 파싱 실패 시 원본 텍스트를 응답으로 사용\n          if (typeof rawAiResponse === 'string') {\n            aiTextToDisplayInPanel = rawAiResponse.substring(0, 500) + \n              (rawAiResponse.length > 500 ? '...' : '');\n          } else {\n            aiTextToDisplayInPanel = \"AI 응답 처리 중 오류 발생. 다시 시도해주세요.\";\n          }\n        }\n      } else {\n        aiTextToDisplayInPanel = \"AI가 응답하지 않았습니다. 다시 시도해주세요.\";\n      }\n      \n      const aiMessage = { type: 'ai', text: aiTextToDisplayInPanel, rawResponseForDebug: rawAiResponse };\n      setConversation(prev => [...prev.filter(msg => !msg.isLoading), aiMessage]);\n    } catch (error) {\n      console.error(\"AI 응답 처리 오류:\", error);\n      \n      // 로딩 메시지 제거\n      setConversation(prev => prev.filter(msg => !msg.isLoading));\n      \n      const errorMessage = { \n        type: 'ai',\n        text: '요청 처리 중 오류가 발생했습니다: ' + error.message,\n        isError: true\n      };\n      setConversation(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [isLoading, onDisplaySuggestion, editorContext, onApplyAiCommand, onStructuredCommand]);\n\n  useImperativeHandle(ref, () => ({\n    triggerAiProcessing(commandData) {\n      if (editorContext) { \n        processUserRequestInternal(commandData, editorContext);\n      }\n    },\n    clearConversation() {\n      setConversation([]);\n      saveConversationToStorage([]);\n    },\n    // 대화 내용을 가져오는 메서드 추가\n    getConversation() {\n      return conversation;\n    },\n    // 저장된 대화 내용을 복원하는 메서드 추가\n    setConversation(savedConversation) {\n      if (Array.isArray(savedConversation)) {\n        setConversation(savedConversation);\n      }\n    }\n  }));\n\n  // 컴포넌트 언마운트 시 상태 보존\n  useEffect(() => {\n    // 컴포넌트가 마운트될 때 한번 실행됨\n    console.log('AiPanel 컴포넌트 마운트됨');\n    \n    return () => {\n      // 컴포넌트가 언마운트될 때 실행됨\n      console.log('AiPanel 컴포넌트 언마운트됨, 대화 내용 저장 시도');\n      if (conversation.length > 0) {\n        saveConversationToStorage(conversation);\n      }\n    };\n  }, [conversation]);\n\n  const handleSuggestionAction = (suggestion, accept) => {\n    // This function is now primarily for proactive suggestions shown in AiPanel, if any.\n    // Most suggestion interactions will happen in MikiEditor's UI.\n    // setActiveSuggestion(null); // Assuming activeSuggestion state is still used for panel-specific suggestions\n    if (accept && suggestion.command_on_accept && onApplyAiCommand) {\n        const userMessage = {type: 'user', text: `(Accepted suggestion: ${suggestion.message})`};\n        const aiMessage = {type: 'ai', text: `Okay, applying suggestion: ${suggestion.message}`};\n        setConversation(prev => [...prev, userMessage, aiMessage]);\n        onApplyAiCommand(suggestion.command_on_accept);\n    } else if (!accept) {\n        const userMessage = {type: 'user', text: `(Declined suggestion: ${suggestion.message})`};\n        setConversation(prev => [...prev, userMessage]);\n    }\n  };\n\n  // 사용자 입력 처리 함수\n  const handleUserInputChange = (event) => {\n    setUserInput(event.target.value);\n  };\n\n  // 키보드 입력 처리 함수\n  const handleInputKeyDown = (event) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n      \n      if (!isLoading && userInput.trim()) {\n        processUserRequestInternal({text: userInput.trim(), type: 'user_command_panel'}, editorContext);\n      }\n    }\n  };\n\n  // 대화 내용을 로컬 스토리지에 저장하는 함수\n  const saveConversationToStorage = (conversations) => {\n    try {\n      if (Array.isArray(conversations) && conversations.length > 0) {\n        localStorage.setItem('miki_ai_conversations', JSON.stringify(conversations));\n        console.log('대화 내용 저장 완료:', conversations.length, '개의 메시지');\n      } else {\n        console.log('저장할 대화 내용이 없음');\n      }\n    } catch (error) {\n      console.error('대화 내용 저장 오류:', error);\n    }\n  };\n\n  // 관련 문서 사용 핸들러\n  const handleUseRelatedDocument = useCallback((doc) => {\n    // 선택한 문서 정보를 AI 컨텍스트에 추가\n    const docInfo = {\n      title: doc.title,\n      content: doc.content || \"내용이 없습니다.\",\n      path: doc.path\n    };\n    \n    // 문서 내용을 AI 질문에 컨텍스트로 추가\n    setAdditionalContext(prev => [...prev, docInfo]);\n    \n    // 선택한 문서를 UI에 표시\n    setSelectedDocuments(prev => [...prev, docInfo]);\n    \n    // UI 상태 업데이트\n    setShowRelatedDocuments(false);\n    setRelatedDocuments([]);\n    \n    // 링크 생성 컴포넌트와 정보 공유 (향후 확장)\n    if (editorContext && editorContext.onDocumentSelected) {\n      editorContext.onDocumentSelected(docInfo);\n    }\n  }, [editorContext, setAdditionalContext]);\n\n  return (\n    <div className={`ai-panel ${expanded ? 'expanded' : 'collapsed'}`}>\n      {/* 패널 헤더 */}\n      <div className=\"panel-header\">\n        <h3>AI 어시스턴트</h3>\n        <div className=\"controls\">\n          <button onClick={handleExpandToggle}>\n            {expanded ? '접기' : '펼치기'}\n          </button>\n        </div>\n      </div>\n      \n      {/* 패널 내용 */}\n      <div className=\"panel-content\">\n        {/* 대화 내역 */}\n        <div className=\"conversation-history\">\n          {conversation.map((entry, index) => (\n            <div key={index} className={`message ${entry.type}`}>\n              <div className=\"message-header\">{entry.type === 'user' ? '👤 사용자' : '🤖 AI'}</div>\n              <div className=\"message-content\">{entry.text}</div>\n              \n              {/* 액션 버튼들 표시 */}\n              {entry.actionButtons && entry.actionButtons.length > 0 && (\n                <div className=\"action-buttons\">\n                  {entry.actionButtons.map((button, btnIndex) => (\n          <button \n                      key={btnIndex}\n                      onClick={button.action}\n                      className={button.label === '실행' ? 'accept-button' : 'cancel-button'}\n          >\n                      {button.label}\n          </button>\n                  ))}\n        </div>\n              )}\n            </div>\n          ))}\n          <div ref={conversationEndRef}></div>\n        </div>\n        \n        {/* 관련 문서 추천 영역 */}\n        {showRelatedDocuments && relatedDocuments.length > 0 && (\n          <div className=\"related-documents\">\n            <h4>관련 문서 추천</h4>\n            <div className=\"documents-list\">\n              {relatedDocuments.map((doc, idx) => (\n                <div key={idx} className=\"document-item\" onClick={() => handleUseRelatedDocument(doc)}>\n                  <div className=\"document-title\">{doc.title}</div>\n                  {doc.preview && <div className=\"document-preview\">{doc.preview}</div>}\n                  {doc.isSemanticMatch && <div className=\"match-type\">AI 추천</div>}\n                  </div>\n              ))}\n                </div>\n          </div>\n        )}\n        \n        {/* 선택된 문서 표시 영역 */}\n        {selectedDocuments.length > 0 && (\n          <div className=\"selected-documents\">\n            <h4>선택된 문서</h4>\n            <div className=\"documents-list\">\n              {selectedDocuments.map((doc, idx) => (\n                <div key={idx} className=\"document-item selected\">\n                  <div className=\"document-title\">{doc.title}</div>\n                  <button \n                    onClick={() => {\n                      setSelectedDocuments(prev => prev.filter((_, i) => i !== idx));\n                      setAdditionalContext(prev => prev.filter((_, i) => i !== idx));\n                    }}\n                    className=\"remove-button\"\n                  >\n                    ✕\n                  </button>\n          </div>\n        ))}\n      </div>\n          </div>\n        )}\n        \n        {/* 입력 영역 */}\n        <div className=\"input-area\">\n          <textarea \n            ref={userInputRef}\n            value={userInput}\n            onChange={handleUserInputChange}\n            onKeyDown={handleInputKeyDown}\n            placeholder=\"AI에게 질문하세요...\"\n            disabled={isLoading}\n          />\n            <button \n            onClick={() => !isLoading && userInput.trim() && processUserRequestInternal({text: userInput.trim(), type: 'user_command_panel'}, editorContext)}\n            disabled={isLoading || !userInput.trim()}\n            >\n            {isLoading ? '처리 중...' : '전송'}\n            </button>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nexport default AiPanel;\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\App.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":1,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":66},{"ruleId":"no-unused-vars","severity":1,"message":"'QueryClient' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'slugify' is assigned a value but never used.","line":26,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'queryClient' is assigned a value but never used.","line":85,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'saveStatus' is assigned a value but never used.","line":89,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'lastSaved' is assigned a value but never used.","line":91,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":14},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":165,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":165,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4755,4783],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":207,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":207,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5849,5880],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":212,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":212,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5969,6003],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":218,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":218,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6156,6190],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback, useMemo } from 'react';\nimport { QueryClient, QueryClientProvider, useQueryClient } from '@tanstack/react-query';\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools';\n\n// 컴포넌트 imports\nimport ErrorBoundary from './components/common/ErrorBoundary';\nimport MessageToast from './components/common/MessageToast';\nimport ErrorDisplay from './components/common/ErrorDisplay';\nimport { DocumentListSkeleton, EditorSkeleton, AiPanelSkeleton } from './components/common/LoadingSpinner';\nimport AppLayout from './components/layout/AppLayout';\n\n// 훅 imports\nimport { useDocuments } from './hooks/useDocuments';\nimport { useDocumentStore } from './stores';\nimport useResponsiveLayout from './hooks/useResponsiveLayout';\nimport useKeyboardShortcuts from './hooks/useKeyboardShortcuts';\nimport useAutoSave from './hooks/useAutoSave';\n\n// 설정 imports\nimport { queryClient } from './config/queryClient';\n\n// 유틸리티 imports\nimport { logError } from './utils/errorHandler';\n\n// 유틸리티 함수들\nconst slugify = (str) => {\n  return str\n    .toLowerCase()\n    .trim()\n    .replace(/[^\\w\\s-]/g, '')\n    .replace(/[\\s_-]+/g, '-')\n    .replace(/^-+|-+$/g, '');\n};\n\nconst extractTitleFromContent = (content) => {\n  if (!content || content.trim() === '') return '새 메모';\n  \n  const lines = content.split('\\n');\n  const firstLine = lines[0]?.trim() || '';\n  \n  if (firstLine === '') return '새 메모';\n  \n  const cleanTitle = firstLine\n    .replace(/^#+\\s*/, '')\n    .replace(/\\*\\*(.*?)\\*\\*/g, '$1')\n    .replace(/\\*(.*?)\\*/g, '$1')\n    .replace(/`(.*?)`/g, '$1')\n    .replace(/\\[(.*?)\\]\\(.*?\\)/g, '$1')\n    .trim();\n  \n  return cleanTitle || '새 메모';\n};\n\nconst createNewMemo = () => {\n  const timestamp = Date.now();\n  const randomSuffix = Math.random().toString(36).substring(2, 8);\n  return {\n    id: `memo_${timestamp}_${randomSuffix}`,\n    title: '새 메모',\n    content: '',\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    isEmpty: true\n  };\n};\n\nfunction AppContent() {\n  // 상태 관리\n  const [message, setMessage] = useState(null);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [editorContext, setEditorContext] = useState(null);\n  const [error, setError] = useState(null);\n  \n  // Refs\n  const editorRef = useRef(null);\n  const aiPanelRef = useRef(null);\n  const searchInputRef = useRef(null);\n  \n  // 커스텀 훅들\n  const { isMobile, isFullscreen, activeMobilePanel, setActiveMobilePanel, toggleFullscreen, editorPanelClass } = useResponsiveLayout();\n  const { data: documentsData, isLoading: isLoadingDocuments, error: documentsError, refetch: refetchDocuments } = useDocuments();\n  const { currentDocument, setCurrentDocument } = useDocumentStore();\n  const queryClient = useQueryClient();\n\n  // 자동 저장 훅\n  const {\n    saveStatus,\n    hasUnsavedChanges,\n    lastSaved,\n    manualSave,\n    getSaveStatusMessage,\n    isAutoSaving,\n    isManualSaving\n  } = useAutoSave({\n    document: currentDocument,\n    content,\n    title,\n    enabled: true,\n    onSaveStart: () => setMessage({ type: 'info', text: '저장 중...' }),\n    onSaveSuccess: () => setMessage({ type: 'success', text: '저장되었습니다.' }),\n    onSaveError: (error) => {\n      logError(error, 'save');\n      setMessage({ type: 'error', text: '저장 중 오류가 발생했습니다.' });\n    }\n  });\n\n  // 키보드 단축키 훅\n  useKeyboardShortcuts({\n    onSave: manualSave,\n    onNewDocument: () => newPost(),\n    onSearch: () => searchInputRef.current?.focus(),\n    onToggleFullscreen: toggleFullscreen,\n    onFocusEditor: () => editorRef.current?.focus?.(),\n    onFocusSearch: () => searchInputRef.current?.focus(),\n    disabled: false\n  });\n\n  // 에러 처리\n  useEffect(() => {\n    if (documentsError) {\n      logError(documentsError, 'load');\n      setError(documentsError);\n    }\n  }, [documentsError]);\n\n  // 메시지 닫기 핸들러\n  const handleCloseMessage = useCallback(() => {\n    setMessage(null);\n  }, []);\n\n  // 에러 닫기 핸들러\n  const handleCloseError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  // 에러 재시도 핸들러\n  const handleRetryError = useCallback(() => {\n    setError(null);\n    refetchDocuments();\n  }, [refetchDocuments]);\n\n  // 제목 변경 핸들러\n  const handleTitleChange = useCallback((e) => {\n    setTitle(e.target.value);\n  }, []);\n\n  // 에디터 컨텍스트 업데이트 핸들러\n  const handleEditorContextUpdate = useCallback((context) => {\n    setEditorContext(context);\n  }, []);\n\n  // 에디터 내용 변경 핸들러\n  const handleEditorChange = useCallback((newContent) => {\n    setContent(newContent);\n    const extractedTitle = extractTitleFromContent(newContent);\n    setTitle(extractedTitle);\n  }, []);\n\n  // 문서 로드\n  const loadPost = useCallback(async (id) => {\n    try {\n      // 실제 문서 로드 로직 구현\n      console.log(`문서 로드: ${id}`);\n    } catch (error) {\n      logError(error, 'load');\n      setMessage({ type: 'error', text: '문서 로드 중 오류가 발생했습니다.' });\n    }\n  }, []);\n\n  // 새 글 생성\n  const newPost = useCallback(() => {\n    const newMemo = createNewMemo();\n    setCurrentDocument(newMemo);\n    setTitle(newMemo.title);\n    setContent('');\n    \n    if (editorRef.current) {\n      editorRef.current.getEditorInstance().setMarkdown('');\n    }\n    \n    if (aiPanelRef.current) {\n      aiPanelRef.current.clearConversation();\n    }\n  }, [setCurrentDocument]);\n\n  // 문서 삭제 후 처리\n  const handleDeletePost = useCallback((deletedPost) => {\n    if (currentDocument && currentDocument.id === deletedPost.id) {\n      if (editorRef.current) {\n        editorRef.current.getEditorInstance().setMarkdown('');\n      }\n      \n      if (aiPanelRef.current) {\n        aiPanelRef.current.clearConversation();\n      }\n      \n      setCurrentDocument(null);\n      setTitle('');\n      setContent('');\n    }\n  }, [currentDocument, setCurrentDocument]);\n\n  // AI 명령 처리\n  const handleAiCommand = useCallback((command) => {\n    console.log('AI 명령:', command);\n  }, []);\n\n  // AI 제안 표시\n  const handleAiSuggestion = useCallback((suggestion) => {\n    console.log('AI 제안:', suggestion);\n  }, []);\n\n  // 내부 문서 링크 네비게이션\n  const handleNavigateToId = useCallback(async (docId) => {\n    if (!docId || docId === currentDocument?.id) return;\n    console.log(`네비게이션 요청: ${docId}`);\n    try {\n      await loadPost(docId);\n    } catch (error) {\n      logError(error, 'load');\n      setMessage({ type: 'error', text: `문서(${docId}) 로드 중 오류 발생` });\n    }\n  }, [loadPost, currentDocument?.id]);\n\n  // 로딩 상태 처리\n  if (isLoadingDocuments) {\n    return (\n      <div className=\"h-screen flex flex-col bg-gray-100\">\n        <header className=\"p-4 bg-blue-500 text-white\">\n          <div className=\"container mx-auto flex justify-between items-center\">\n            <h1 className=\"text-xl font-bold\">Miki Editor v7 AI 연동</h1>\n          </div>\n        </header>\n        \n        <div className=\"flex-grow p-4 overflow-hidden\">\n          <div className=\"flex h-full\" style={{ flexDirection: isMobile ? 'column' : 'row' }}>\n            {/* 문서 목록 스켈레톤 */}\n            <div className={`bg-white rounded shadow flex flex-col ${\n              isMobile ? 'block flex-grow mb-2' : 'w-1/5 mr-2'\n            }`}>\n              <div className=\"p-3 border-b\">\n                <div className=\"h-6 bg-gray-200 rounded w-20 animate-pulse\"></div>\n              </div>\n              <div className=\"flex-grow overflow-auto p-3\">\n                <DocumentListSkeleton />\n              </div>\n            </div>\n            \n            {/* 에디터 스켈레톤 */}\n            <div className={`bg-white rounded shadow flex flex-col ${\n              isMobile ? 'block flex-grow mb-2' : 'flex-1 mx-2'\n            }`}>\n              <EditorSkeleton />\n            </div>\n            \n            {/* AI 패널 스켈레톤 */}\n            <div className={`bg-white rounded shadow flex flex-col ${\n              isMobile ? 'block flex-grow' : 'w-1/4 ml-2'\n            }`}>\n              <AiPanelSkeleton />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-screen flex flex-col bg-gray-100\">\n      {/* 헤더 */}\n      <header className={`p-4 bg-blue-500 text-white ${isFullscreen ? 'hidden' : ''}`}>\n        <div className=\"container mx-auto flex justify-between items-center\">\n          <h1 className=\"text-xl font-bold\">Miki Editor v7 AI 연동</h1>\n        </div>\n      </header>\n      \n      {/* 에러 표시 */}\n      {error && (\n        <div className=\"p-4\">\n          <ErrorDisplay\n            error={error}\n            context=\"load\"\n            onRetry={handleRetryError}\n            onDismiss={handleCloseError}\n          />\n        </div>\n      )}\n      \n      {/* 메시지 토스트 */}\n      <MessageToast message={message} onClose={handleCloseMessage} />\n      \n      {/* 메인 컨텐츠 영역 */}\n      <div className=\"flex-grow p-4 overflow-hidden\">\n        <AppLayout\n          isFullscreen={isFullscreen}\n          isMobile={isMobile}\n          activeMobilePanel={activeMobilePanel}\n          setActiveMobilePanel={setActiveMobilePanel}\n          editorPanelClass={editorPanelClass}\n          \n          // DocumentSidebar props\n          documentsData={documentsData}\n          currentDocument={currentDocument}\n          searchQuery={searchQuery}\n          setSearchQuery={setSearchQuery}\n          searchInputRef={searchInputRef}\n          onLoadPost={loadPost}\n          onNewPost={newPost}\n          onDeletePost={handleDeletePost}\n          setMessage={setMessage}\n          \n          // EditorPanel props\n          title={title}\n          saveStatus={getSaveStatusMessage()}\n          isLoadingDocuments={isLoadingDocuments}\n          editorRef={editorRef}\n          onTitleChange={handleTitleChange}\n          onSavePost={manualSave}\n          onToggleFullscreen={toggleFullscreen}\n          onEditorContextUpdate={handleEditorContextUpdate}\n          onEditorChange={handleEditorChange}\n          onSendToAi={(data) => aiPanelRef.current?.triggerAiProcessing(data)}\n          onNavigateRequest={handleNavigateToId}\n          hasUnsavedChanges={hasUnsavedChanges}\n          isAutoSaving={isAutoSaving}\n          isManualSaving={isManualSaving}\n          \n          // AiPanelContainer props\n          aiPanelRef={aiPanelRef}\n          editorContext={editorContext}\n          onStructuredCommand={handleAiCommand}\n          onDisplaySuggestion={handleAiSuggestion}\n        />\n      </div>\n    </div>\n  );\n}\n\n// QueryClientProvider로 감싸는 메인 App 컴포넌트\nfunction App() {\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <AppContent />\n        {/* 개발 환경에서만 React Query DevTools 표시 */}\n        {process.env.NODE_ENV === 'development' && (\n          <ReactQueryDevtools initialIsOpen={false} />\n        )}\n      </QueryClientProvider>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\App_backup.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport './App.css';\nimport './index.css';\n\n// 간단한 테스트 컴포넌트\nfunction App() {\n  return (\n    <div className=\"h-screen flex flex-col bg-gray-100\">\n      <header className=\"p-4 bg-blue-500 text-white text-center font-bold\">\n        Miki Editor v7 Tailwind CSS 테스트\n      </header>\n      \n      <main className=\"flex-grow flex p-4\">\n        <div className=\"w-1/2 p-4 bg-white rounded-lg shadow-md mr-2\">\n          <h2 className=\"text-xl font-bold text-gray-800 mb-4\">왼쪽 패널</h2>\n          <p className=\"text-gray-600\">Tailwind CSS가 정상적으로 적용되었습니다.</p>\n          <button className=\"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors\">\n            테스트 버튼\n          </button>\n        </div>\n        \n        <div className=\"w-1/2 p-4 bg-white rounded-lg shadow-md ml-2\">\n          <h2 className=\"text-xl font-bold text-gray-800 mb-4\">오른쪽 패널</h2>\n          <div className=\"p-3 bg-yellow-100 border border-yellow-300 rounded-md\">\n            <p className=\"text-yellow-800\">Tailwind CSS 적용 테스트 알림</p>\n          </div>\n          <div className=\"mt-4 flex space-x-2\">\n            <span className=\"px-2 py-1 bg-green-100 text-green-800 rounded-full text-sm\">태그 1</span>\n            <span className=\"px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-sm\">태그 2</span>\n            <span className=\"px-2 py-1 bg-red-100 text-red-800 rounded-full text-sm\">태그 3</span>\n          </div>\n        </div>\n      </main>\n      \n      <footer className=\"p-4 bg-gray-200 text-center text-gray-600\">\n        Miki Editor 테스트 페이지 © 2024\n      </footer>\n    </div>\n  );\n}\n\nexport default App;\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\App_full_ui_bak.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState, useEffect, useCallback } from 'react';\nimport './App.css';\nimport './index.css';\nimport Split from 'react-split';\nimport MikiEditor from './MikiEditor';\nimport AiPanel from './AiPanel';\n\nfunction App() {\n  const editorRef = useRef(null);\n  const aiPanelRef = useRef(null);\n  const [editorContext, setEditorContext] = useState({\n    fullContent: '',\n    selection: null\n  });\n\n  // 에디터 컨텍스트 업데이트 핸들러\n  const handleEditorContextUpdate = useCallback((context) => {\n    setEditorContext(context);\n  }, []);\n\n  // AI 명령 처리 핸들러\n  const handleAiCommand = useCallback((command) => {\n    if (editorRef.current && command) {\n      editorRef.current.applyStructuredAiCommand(command);\n    }\n  }, []);\n\n  // AI 제안 표시 핸들러\n  const handleAiSuggestion = useCallback((suggestion) => {\n    if (editorRef.current && suggestion) {\n      editorRef.current.displayAiSuggestion(suggestion);\n    }\n  }, []);\n\n  return (\n    <div className=\"h-screen flex flex-col bg-gray-100\">\n      <header className=\"p-4 bg-blue-500 text-white text-center font-bold\">\n        Miki Editor v7 AI 연동\n      </header>\n      \n      <Split \n        className=\"flex-grow flex p-4\"\n        sizes={[60, 40]}\n        minSize={300}\n        gutterSize={10}\n        gutterAlign=\"center\"\n      >\n        <div className=\"p-2 bg-white rounded shadow mr-2 h-full overflow-y-auto flex flex-col\">\n          <h2 className=\"text-lg font-bold mb-4\">에디터 영역</h2>\n          <div className=\"flex-grow border rounded\">\n            <MikiEditor\n              ref={editorRef}\n              onContextUpdate={handleEditorContextUpdate}\n            />\n          </div>\n        </div>\n        \n        <div className=\"p-2 bg-white rounded shadow ml-2 h-full overflow-y-auto flex flex-col\">\n          <h2 className=\"text-lg font-bold mb-4\">AI 패널 영역</h2>\n          <AiPanel\n            ref={aiPanelRef}\n            editorContext={editorContext}\n            onCommand={handleAiCommand}\n            onSuggestion={handleAiSuggestion}\n          />\n        </div>\n      </Split>\n    </div>\n  );\n}\n\nexport default App;\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\KnowledgeGraph.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":56,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":56,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1911,1954],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport ForceGraph2D from 'react-force-graph-2d';\n\n// Function to process notes index into graph data\nconst processNotesForGraph = (notes) => {\n  if (!Array.isArray(notes) || notes.length === 0) {\n    return { nodes: [], links: [] };\n  }\n\n  const nodes = notes.map(note => ({\n    id: note.slug, // Use slug as unique ID\n    name: note.title,\n    val: 1, // Basic size, could be based on connections or content length\n    // Add other properties if needed, e.g., group based on tags\n  }));\n\n  const links = [];\n  const nodeIds = new Set(nodes.map(n => n.id));\n\n  notes.forEach(note => {\n    // Links based on explicit parent/child (if available)\n    if (note.parent && nodeIds.has(note.parent)) {\n      links.push({ source: note.slug, target: note.parent, type: 'parent' });\n    }\n\n    // Links based on tags (connect notes with shared tags)\n    if (note.tags && Array.isArray(note.tags)) {\n      note.tags.forEach(tag => {\n        notes.forEach(otherNote => {\n          if (note.slug !== otherNote.slug && otherNote.tags && otherNote.tags.includes(tag)) {\n            // Avoid duplicate links\n            const exists = links.some(\n              link => (link.source === note.slug && link.target === otherNote.slug) || (link.source === otherNote.slug && link.target === note.slug)\n            );\n            if (!exists) {\n              links.push({ source: note.slug, target: otherNote.slug, type: 'tag', tag: tag });\n            }\n          }\n        });\n      });\n    }\n    \n    // TODO: Add links based on [[wiki-links]] if parsed and available in index\n  });\n\n  return { nodes, links };\n};\n\nfunction KnowledgeGraph({ notesIndex }) {\n  const [graphData, setGraphData] = useState({ nodes: [], links: [] });\n  const graphRef = useRef();\n\n  useEffect(() => {\n    const data = processNotesForGraph(notesIndex);\n    setGraphData(data);\n    console.log(\"Processed graph data:\", data);\n  }, [notesIndex]);\n\n  // Handle node click - navigate to the note page\n  const handleNodeClick = useCallback(node => {\n    // Assuming notes are accessible via /slug or /_notes/slug.md\n    // Adjust the URL structure based on your Jekyll setup\n    window.open(`/${node.id}`, '_blank'); // Open in new tab\n    // Optional: Center graph on clicked node\n    // graphRef.current.centerAt(node.x, node.y, 1000);\n    // graphRef.current.zoom(2, 1000);\n  }, []);\n\n  // Optional: Customize node appearance\n  const nodeCanvasObject = (node, ctx, globalScale) => {\n    const label = node.name || node.id;\n    const fontSize = 12 / globalScale;\n    ctx.font = `${fontSize}px Sans-Serif`;\n    const textWidth = ctx.measureText(label).width;\n    const bgDimensions = [textWidth, fontSize].map(n => n + fontSize * 0.4); // Box padding\n\n    // Background rectangle\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\n    ctx.fillRect(node.x - bgDimensions[0] / 2, node.y - bgDimensions[1] / 2, ...bgDimensions);\n\n    // Text\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = 'rgb(50, 50, 50)';\n    ctx.fillText(label, node.x, node.y);\n\n    node.__bckgDimensions = bgDimensions; // Store for interaction\n  };\n\n  // Optional: Customize link appearance\n  const linkCanvasObject = (link, ctx, globalScale) => {\n    const start = link.source;\n    const end = link.target;\n\n    // Ignore unbound links\n    if (typeof start !== 'object' || typeof end !== 'object') return;\n\n    // Line style\n    ctx.beginPath();\n    ctx.moveTo(start.x, start.y);\n    ctx.lineTo(end.x, end.y);\n    ctx.lineWidth = 0.5 / globalScale;\n    ctx.strokeStyle = link.type === 'parent' ? 'rgba(0, 255, 0, 0.5)' : 'rgba(0, 0, 255, 0.2)'; // Green for parent, blue for tag\n    ctx.stroke();\n\n    // Optional: Add arrow for parent links\n    if (link.type === 'parent') {\n        const arrowLength = 5 / globalScale;\n        const arrowAngle = Math.PI / 6;\n        const angle = Math.atan2(end.y - start.y, end.x - start.x);\n        ctx.beginPath();\n        ctx.moveTo(end.x, end.y);\n        ctx.lineTo(end.x - arrowLength * Math.cos(angle - arrowAngle), end.y - arrowLength * Math.sin(angle - arrowAngle));\n        ctx.moveTo(end.x, end.y);\n        ctx.lineTo(end.x - arrowLength * Math.cos(angle + arrowAngle), end.y - arrowLength * Math.sin(angle + arrowAngle));\n        ctx.strokeStyle = 'rgba(0, 255, 0, 0.5)';\n        ctx.lineWidth = 0.5 / globalScale;\n        ctx.stroke();\n    }\n  };\n\n  return (\n    <div className=\"w-full h-full bg-gray-100 rounded-lg overflow-hidden shadow-inner\">\n      {graphData.nodes.length > 0 ? (\n        <ForceGraph2D\n          ref={graphRef}\n          graphData={graphData}\n          nodeLabel=\"name\" // Show title on hover\n          // Node appearance\n          nodeVal=\"val\"\n          nodeCanvasObject={nodeCanvasObject}\n          nodePointerAreaPaint={(node, color, ctx) => {\n            ctx.fillStyle = color;\n            const bckgDimensions = node.__bckgDimensions;\n            bckgDimensions && ctx.fillRect(node.x - bckgDimensions[0] / 2, node.y - bckgDimensions[1] / 2, ...bckgDimensions);\n          }}\n          // Link appearance\n          // linkDirectionalParticles={1}\n          // linkDirectionalParticleWidth={1}\n          linkCanvasObjectMode={() => 'after'}\n          linkCanvasObject={linkCanvasObject}\n          // Interaction\n          onNodeClick={handleNodeClick}\n          // Performance\n          cooldownTicks={100}\n          onEngineStop={() => graphRef.current.zoomToFit(400, 100)} // Zoom to fit after stabilization\n          // Styling\n          backgroundColor=\"#f7fafc\" // Tailwind gray-100\n          width={undefined} // Use container width\n          height={undefined} // Use container height\n        />\n      ) : (\n        <div className=\"flex items-center justify-center h-full text-gray-500\">\n          {notesIndex === null ? 'Loading graph data...' : 'No notes found to display graph.'}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default KnowledgeGraph;\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\MikiEditor.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'convertMarkdownToHTML' is assigned a value but never used.","line":47,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":131,"column":27,"nodeType":"Identifier","endLine":131,"endColumn":38},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":141,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":141,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4783,4820],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":158,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":158,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5241,5274],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":162,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":162,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5399,5433],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":199,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":199,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6603,6632],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":246,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":246,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7865,7926],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":251,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":251,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8100,8148],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":254,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":254,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8191,8225],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":269,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":269,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8749,8794],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":271,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":271,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8839,8885],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":284,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":284,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9306,9344],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":602,"column":20,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":1538,"endColumn":3},{"ruleId":"no-unused-vars","severity":1,"message":"'savedSelection' is assigned a value but never used.","line":617,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":617,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":620,"column":34,"nodeType":"Identifier","endLine":620,"endColumn":45},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":630,"column":34,"nodeType":"Identifier","endLine":630,"endColumn":45},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":642,"column":32,"nodeType":"Identifier","endLine":642,"endColumn":43},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":666,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":666,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[22493,22579],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'editorRect' is assigned a value but never used.","line":694,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":694,"endColumn":25},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":784,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":784,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[26838,26877],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":790,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":790,"endColumn":29,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[27062,27126],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":860,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":860,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[30179,30264],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":898,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":898,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[31437,31489],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":902,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":902,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[31548,31578],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":911,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":911,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[31859,31939],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'suggestionId' is defined but never used. Allowed unused args must match /^_/u.","line":945,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":945,"endColumn":47},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":953,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":953,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33497,33542],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":974,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":974,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[34545,34600],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":977,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":977,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[34644,34690],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":982,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":982,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[34766,34794],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":984,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":984,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[34827,34868],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1031,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1031,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[36627,36687],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1050,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1050,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[37327,37362],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1080,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1080,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[38648,38712],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1083,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1083,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[38907,39021],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1091,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1091,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[39466,39554],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1105,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1105,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[39910,39959],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1118,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1118,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[40355,40403],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1131,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1131,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[40739,40803],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1133,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1133,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[40847,40902],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1138,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1138,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[41114,41151],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1144,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1144,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[41328,41376],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1147,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1147,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[41413,41447],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1155,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1155,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[41755,41798],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'editorStyle' is assigned a value but never used.","line":1169,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1169,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'toastUIEditorStyle' is assigned a value but never used.","line":1177,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1177,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'loadDocumentByPath' is assigned a value but never used.","line":1195,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1195,"endColumn":27},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1196,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1196,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[42642,42700],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1216,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1216,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[43282,43321],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1219,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1219,"endColumn":25,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[43386,43433],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1226,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1226,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[43535,43574],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'foundKey' is assigned a value but never used.","line":1238,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":1238,"endColumn":23},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1239,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1239,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[44126,44170],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1250,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1250,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[44357,44398],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1263,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1263,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[44902,44950],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1268,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1268,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[45175,45217],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1272,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1272,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[45286,45330],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1280,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1280,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[45486,45525],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1292,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1292,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[45828,45864],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'createNewDocument' and 'loadDocumentToEditor'. Either include them or remove the dependency array.","line":1304,"column":6,"nodeType":"ArrayExpression","endLine":1304,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [createNewDocument, loadDocumentToEditor, onContextUpdate]","fix":{"range":[46122,46139],"text":"[createNewDocument, loadDocumentToEditor, onContextUpdate]"}}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1308,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1308,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[46242,46298],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1331,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1331,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[46976,47025],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1349,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1349,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[47540,47594],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1351,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1351,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[47623,47661],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1358,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1358,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[47819,47852],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1383,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1383,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[48501,48537],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1385,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1385,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[48566,48602],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":67,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useCallback, useState, useEffect, forwardRef, useImperativeHandle } from 'react';\nimport { Editor } from '@toast-ui/react-editor';\nimport '@toast-ui/editor/dist/toastui-editor.css';\nimport '@toast-ui/editor/dist/theme/toastui-editor-dark.css'; // Optional: Dark theme\nimport DocumentSearchManager from './utils/DocumentSearchManager'; // 추가된 임포트\n\n// debounce 함수 정의\nconst debounce = (func, wait) => {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\n// Helper to slugify strings for internal links\nconst slugify = (str) => {\n  if (!str || str.trim() === '') {\n    // 빈 문자열이나 공백만 있는 경우 타임스탬프 기반 ID 생성\n    return `doc-${Date.now()}`;\n  }\n  \n  // 1단계: 기본 변환 (소문자로 변환, 양쪽 공백 제거)\n  let result = str.toLowerCase().trim();\n  \n  // 2단계: URL에 안전하지 않은 문자 처리\n  result = result\n    // 연속된 공백, 특수문자를 하이픈으로 변환 (한글은 보존)\n    .replace(/[\\s\\t\\r\\n]+/g, '-')  // 공백류 문자 변환\n    .replace(/[^\\w\\u3131-\\uD79D-]+/g, '-') // 한글(유니코드 범위)과 영숫자, 언더스코어를 제외한 문자를 하이픈으로 변환\n    .replace(/-+/g, '-')  // 중복된 하이픈 제거\n    .replace(/^-+|-+$/g, ''); // 시작/끝 하이픈 제거\n  \n  // 3단계: 결과가 빈 문자열이면 타임스탬프 사용\n  if (!result || result === '') {\n    return `doc-${Date.now()}`;\n  }\n  \n  return result;\n};\n\n// 마크다운을 WYSIWYG 호환 형식으로 변환하는 함수\nconst convertMarkdownToHTML = (markdownText) => {\n  if (!markdownText || typeof markdownText !== 'string') return markdownText;\n  \n  // 헤딩 변환 (# 제목 -> <h1>제목</h1>)\n  const headingProcessed = markdownText\n    .replace(/^# (.+)$/gm, '<h1>$1</h1>')\n    .replace(/^## (.+)$/gm, '<h2>$1</h2>')\n    .replace(/^### (.+)$/gm, '<h3>$1</h3>')\n    .replace(/^#### (.+)$/gm, '<h4>$1</h4>')\n    .replace(/^##### (.+)$/gm, '<h5>$1</h5>')\n    .replace(/^###### (.+)$/gm, '<h6>$1</h6>');\n    \n  // 굵게, 기울임, 취소선 변환\n  const styleProcessed = headingProcessed\n    .replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>')\n    .replace(/\\*(.+?)\\*/g, '<em>$1</em>')\n    .replace(/~~(.+?)~~/g, '<del>$1</del>');\n  \n  // 목록 변환\n  const listProcessed = styleProcessed\n    .replace(/^- (.+)$/gm, '<ul><li>$1</li></ul>')\n    .replace(/^\\* (.+)$/gm, '<ul><li>$1</li></ul>')\n    .replace(/^[0-9]+\\. (.+)$/gm, '<ol><li>$1</li></ol>');\n  \n  // 코드 블록 및 인라인 코드\n  const codeProcessed = listProcessed\n    .replace(/`(.+?)`/g, '<code>$1</code>')\n    .replace(/```(.+?)```/gs, '<pre><code>$1</code></pre>');\n  \n  // 링크 및 이미지 변환\n  const linkProcessed = codeProcessed\n    .replace(/\\[(.+?)\\]\\((.+?)\\)/g, '<a href=\"$2\">$1</a>')\n    .replace(/!\\[(.+?)\\]\\((.+?)\\)/g, '<img src=\"$2\" alt=\"$1\">');\n  \n  // 인용문 변환\n  const quoteProcessed = linkProcessed\n    .replace(/^> (.+)$/gm, '<blockquote>$1</blockquote>');\n  \n  return quoteProcessed;\n};\n\n// --- AI Suggestion Popover Component ---\nconst AiSuggestionPopover = ({ suggestion, onAccept, onCancel, position }) => {\n  if (!suggestion || !suggestion.visible || suggestion.suggestionType === 'clarification_needed') return null;\n\n  const positionStyle = {\n    top: `${position?.top || 0}px`,\n    left: `${position?.left || 0}px`,\n  };\n\n  return (\n    <div \n      style={positionStyle} \n      className=\"fixed z-50 bg-white border border-gray-200 rounded-lg p-3 shadow-lg max-w-sm\"\n    >\n      <p className=\"mb-3 text-sm text-gray-700\">{suggestion.displayText}</p>\n      <div className=\"flex justify-end space-x-2\">\n        <button \n          onClick={() => onAccept(suggestion)}\n          className=\"px-4 py-1.5 bg-blue-500 text-white text-xs font-semibold rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300 transition-colors\"\n        >\n          Run\n        </button>\n        <button \n          onClick={() => onCancel(suggestion.suggestionId)}\n          className=\"px-4 py-1.5 bg-gray-200 text-gray-700 text-xs font-semibold rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300 transition-colors\"\n        >\n          Cancel\n        </button>\n      </div>\n    </div>\n  );\n};\n\n// --- Link Suggestion Popover Component ---\nconst LinkCreationPopover = ({ position, onCreateLink, onCancel, selectedText }) => {\n  const [inputValue, setInputValue] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [useAiSearch, setUseAiSearch] = useState(true); // AI 검색 사용 여부 (기본값: true)\n  const docSearchManager = useRef(new DocumentSearchManager());\n  \n  // debounced 검색 함수\n  const debouncedSearch = useCallback(\n    debounce(async (searchTerm) => {\n      if (!searchTerm || searchTerm.trim().length === 0) {\n        setSearchResults([]);\n        setLoading(false);\n        return;\n      }\n      \n      try {\n        setLoading(true);\n        console.log(\"링크 검색 시작:\", searchTerm);\n        \n        // URL 형식인지 확인\n        if (/^https?:\\/\\//i.test(searchTerm.trim())) {\n          setSearchResults([{\n            id: 'url',\n            title: `URL: ${searchTerm.trim()}`,\n            path: searchTerm.trim(),\n            isUrl: true\n          }]);\n          setLoading(false);\n          return;\n        }\n        \n        // 검색 방식 선택 (AI 또는 키워드)\n        let results;\n        if (useAiSearch) {\n          console.log(\"AI 검색 모드로 실행 중...\");\n          // AI 검색 사용\n          results = await docSearchManager.current.searchByAi(searchTerm);\n        } else {\n          console.log(\"키워드 검색 모드로 실행 중...\");\n          // 키워드 검색만 사용\n          results = await docSearchManager.current.searchByKeyword(searchTerm);\n        }\n        \n        // 검색 결과가 없으면 새 문서 만들기 옵션 제공\n        if (results.length === 0) {\n          const searchQuery = searchTerm.trim();\n          \n          // 개선된 slugify 함수 정의 (내부용)\n          const slugifyText = (text) => {\n            if (!text || text.trim() === '') {\n              return `doc-${Date.now()}`;\n            }\n            \n            const result = text.toLowerCase().trim()\n              .replace(/[\\s\\t\\r\\n]+/g, '-')\n              .replace(/[^\\w\\u3131-\\uD79D-]+/g, '-')\n              .replace(/-+/g, '-')\n              .replace(/^-+|-+$/g, '');\n              \n            return result || `doc-${Date.now()}`;\n          };\n          \n          setSearchResults([{ \n            id: 'new_' + searchQuery, \n            title: `\"${searchQuery}\" 새 문서 생성`, \n            path: `/doc/${slugifyText(searchQuery)}`,\n            preview: `\"${searchQuery}\" 문서를 새로 생성합니다.`, \n            isCreateNew: true \n          }]);\n        } else {\n          setSearchResults(results);\n        }\n        \n        setLoading(false);\n      } catch (err) {\n        console.error(\"검색 오류:\", err);\n        setError(\"검색 중 오류가 발생했습니다.\");\n        setSearchResults([]);\n        setLoading(false);\n      }\n    }, 300),\n    [useAiSearch] // useAiSearch 값이 변경될 때마다 함수 재생성\n  );\n  \n  // 컴포넌트 마운트 시 선택 텍스트로 자동 검색\n  useEffect(() => {\n    if (selectedText && selectedText.trim().length > 0) {\n      setInputValue(selectedText);\n      debouncedSearch(selectedText);\n    }\n  }, [selectedText, debouncedSearch]);\n  \n  // 입력값 변경 핸들러\n  const handleInputChange = (e) => {\n    const value = e.target.value;\n    setInputValue(value);\n    setError(null);\n    \n    if (value.trim().length > 0) {\n      setLoading(true);\n      debouncedSearch(value);\n    } else {\n      setSearchResults([]);\n    }\n  };\n\n  // 검색 결과 선택 핸들러\n  const handleResultClick = (result) => {\n    const editorInstance = window.editorRef?.current?.getInstance();\n    \n    if (editorInstance) {\n      const linkText = selectedText || result.title || result.path;\n      const linkUrl = result.path;\n      \n      try {\n        // WYSIWYG 모드에서 실제 하이퍼링크로 삽입\n        if (editorInstance.isWysiwygMode()) {\n          // WYSIWYG 모드: Toast UI Editor의 addLink 명령 사용\n          editorInstance.exec('addLink', {\n            linkText: linkText,\n            linkUrl: linkUrl\n          });\n          console.log(`WYSIWYG 모드에서 링크 삽입: ${linkText} -> ${linkUrl}`);\n        } else {\n          // 마크다운 모드: 마크다운 문법으로 삽입\n          const markdownLink = `[${linkText}](${linkUrl})`;\n          editorInstance.insertText(markdownLink);\n          console.log(`마크다운 모드에서 링크 삽입: ${markdownLink}`);\n        }\n      } catch (error) {\n        console.error('링크 삽입 오류:', error);\n        \n        // 오류 발생 시 대체 방법: 직접 HTML 삽입 시도\n        try {\n          const linkHtml = `<a href=\"${linkUrl}\" target=\"_blank\" rel=\"noopener noreferrer\">${linkText}</a>`;\n          \n          if (editorInstance.isWysiwygMode()) {\n            // WYSIWYG 모드에서 HTML 직접 삽입\n            editorInstance.insertHTML(linkHtml);\n          } else {\n            // 마크다운 모드에서는 마크다운 문법 사용\n            const markdownLink = `[${linkText}](${linkUrl})`;\n            editorInstance.insertText(markdownLink);\n          }\n          \n          console.log(`대체 방법으로 링크 삽입 성공: ${linkText}`);\n        } catch (fallbackError) {\n          console.error('대체 링크 삽입도 실패:', fallbackError);\n          \n          // 최후의 방법: 클립보드에 복사\n          try {\n            const linkText = `[${result.title}](${result.path})`;\n            navigator.clipboard.writeText(linkText);\n            alert(`링크 생성에 실패했습니다. 마크다운 링크가 클립보드에 복사되었습니다:\\n${linkText}`);\n          } catch (clipboardError) {\n            alert(`링크 생성에 실패했습니다. 수동으로 추가해주세요: [${result.title}](${result.path})`);\n          }\n        }\n      }\n    } else {\n      console.error('에디터 인스턴스를 찾을 수 없습니다.');\n    }\n    \n    onCancel();\n  };\n\n  return (\n    <div className=\"link-creation-popover\" style={{\n      position: 'absolute',\n      top: `${position.top}px`,\n      left: `${position.left}px`,\n      zIndex: 999,\n      backgroundColor: 'white',\n      border: '1px solid #ccc',\n      borderRadius: '4px',\n      boxShadow: '0 2px 5px rgba(0,0,0,0.2)',\n      padding: '10px',\n      width: '300px',\n    }}>\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'space-between', \n        alignItems: 'center',\n        marginBottom: '10px' \n      }}>\n        <div style={{ fontWeight: 'bold' }}>링크 생성</div>\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          fontSize: '12px',\n          color: '#666'\n        }}>\n          <span style={{ marginRight: '6px' }}>AI 검색</span>\n          <label style={{ \n            position: 'relative',\n            display: 'inline-block',\n            width: '34px',\n            height: '18px',\n            cursor: 'pointer'\n          }}>\n            <input\n              type=\"checkbox\"\n              checked={useAiSearch}\n              onChange={() => setUseAiSearch(!useAiSearch)}\n              style={{ opacity: 0, width: 0, height: 0 }}\n            />\n            <span style={{ \n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundColor: useAiSearch ? '#2196F3' : '#ccc',\n              borderRadius: '14px',\n              transition: '0.4s'\n            }}>\n              <span style={{ \n                position: 'absolute',\n                content: '\"\"',\n                height: '14px',\n                width: '14px',\n                left: useAiSearch ? '17px' : '3px',\n                bottom: '2px',\n                backgroundColor: 'white',\n                borderRadius: '50%',\n                transition: '0.4s'\n              }}></span>\n            </span>\n          </label>\n        </div>\n      </div>\n        \n      <div style={{ marginBottom: '10px' }}>\n        <input\n          type=\"text\"\n          placeholder=\"URL 또는 문서 검색어 입력...\"\n          value={inputValue}\n          onChange={handleInputChange}\n          style={{\n            width: '100%',\n            padding: '8px',\n            border: '1px solid #ddd',\n            borderRadius: '4px',\n            fontSize: '14px',\n          }}\n          autoFocus\n        />\n      </div>\n      \n      {loading ? (\n        <div style={{ \n          textAlign: 'center', \n          padding: '20px',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center'\n        }}>\n          <div style={{\n            border: '2px solid #f3f3f3',\n            borderTop: '2px solid #3498db',\n            borderRadius: '50%',\n            width: '20px',\n            height: '20px',\n            animation: 'spin 2s linear infinite',\n          }}></div>\n          <style>\n            {`\n            @keyframes spin {\n              0% { transform: rotate(0deg); }\n              100% { transform: rotate(360deg); }\n            }\n            `}\n          </style>\n          <span style={{ marginLeft: '8px' }}>검색 중...</span>\n        </div>\n      ) : error ? (\n        <div style={{ \n          color: 'red', \n          padding: '10px',\n          backgroundColor: '#fff8f8',\n          borderRadius: '4px',\n          marginBottom: '10px'\n        }}>\n          {error}\n        </div>\n      ) : (\n        <div style={{ maxHeight: '200px', overflowY: 'auto' }}>\n          {searchResults.length === 0 && inputValue.trim() !== '' ? (\n            <div style={{ \n              textAlign: 'center', \n              padding: '20px',\n              color: '#666'\n            }}>\n              <p>검색 결과가 없습니다.</p>\n              <p style={{ fontSize: '12px', marginTop: '6px' }}>\n                다른 검색어를 시도하거나 새 문서를 생성하세요.\n              </p>\n            </div>\n          ) : (\n            searchResults.map((result) => (\n              <div\n                key={result.id}\n                onClick={e => {\n                  e.stopPropagation();\n                  handleResultClick(result);\n                }}\n                style={{\n                  padding: '8px',\n                  borderBottom: '1px solid #eee',\n                  cursor: 'pointer',\n                  backgroundColor: result.isCreateNew ? '#f0f8ff' : (result.isSemanticMatch ? '#fff8e6' : 'white'),\n                  display: 'flex',\n                  flexDirection: 'column',\n                  transition: 'background-color 0.2s',\n                  borderRadius: '2px',\n                  ':hover': {\n                    backgroundColor: '#f5f5f5'\n                  }\n                }}\n                onMouseOver={(e) => e.currentTarget.style.backgroundColor = result.isCreateNew ? '#e6f0ff' : (result.isSemanticMatch ? '#fff0d0' : '#f5f5f5')}\n                onMouseOut={(e) => e.currentTarget.style.backgroundColor = result.isCreateNew ? '#f0f8ff' : (result.isSemanticMatch ? '#fff8e6' : 'white')}\n              >\n                <div style={{ fontWeight: 'bold' }}>\n                  {result.title}\n                  {result.isUrl && (\n                    <span style={{ \n                      marginLeft: '4px', \n                      fontSize: '10px', \n                      backgroundColor: '#e8f5e9', \n                      color: '#43a047',\n                      padding: '2px 4px',\n                      borderRadius: '4px',\n                      verticalAlign: 'middle'\n                    }}>URL</span>\n                  )}\n                </div>\n                \n                {result.preview && (\n                  <div style={{ \n                    fontSize: '12px', \n                    color: '#666', \n                    marginTop: '4px',\n                    whiteSpace: 'normal',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    display: '-webkit-box',\n                    WebkitLineClamp: 2,\n                    WebkitBoxOrient: 'vertical',\n                  }}>\n                    {result.preview}\n                  </div>\n                )}\n                \n                {result.isSemanticMatch && result.relevanceScore && (\n                  <div style={{ \n                    display: 'flex',\n                    alignItems: 'center',\n                    marginTop: '4px',\n                  }}>\n                    <span style={{ \n                      fontSize: '10px',\n                      color: '#ef6c00',\n                      backgroundColor: '#fff3e0',\n                      padding: '2px 4px',\n                      borderRadius: '4px',\n                      display: 'flex',\n                      alignItems: 'center',\n                      fontWeight: '500',\n                    }}>\n                      <span style={{ marginRight: '2px' }}>✨</span>\n                      관련도 {result.relevanceScore}%\n                    </span>\n                    \n                    {result.reason && (\n                      <span style={{ \n                        fontSize: '10px', \n                        color: '#757575',\n                        marginLeft: '6px',\n                        fontStyle: 'italic',\n                      }}>\n                        {result.reason.length > 40 ? result.reason.substring(0, 40) + '...' : result.reason}\n                      </span>\n                    )}\n                  </div>\n                )}\n                \n                {result.isCreateNew && (\n                  <div style={{ \n                    fontSize: '10px', \n                    color: '#1976d2', \n                    marginTop: '4px',\n                    display: 'flex',\n                    alignItems: 'center',\n                    fontWeight: '500',\n                  }}>\n                    <span style={{ marginRight: '2px' }}>➕</span>\n                    새 문서 생성\n                  </div>\n                )}\n              </div>\n            ))\n          )}\n        </div>\n      )}\n      \n      <div style={{ \n        marginTop: '10px', \n        display: 'flex', \n        justifyContent: 'space-between' \n      }}>\n        <button\n          onClick={onCancel}\n          style={{\n            padding: '6px 12px',\n            backgroundColor: '#f0f0f0',\n            border: 'none',\n            borderRadius: '4px',\n            cursor: 'pointer',\n          }}\n        >\n          취소\n        </button>\n        \n        <button\n          onClick={() => {\n            if (inputValue.trim()) {\n              // URL 형식이면 그대로 사용\n              if (/^https?:\\/\\//i.test(inputValue.trim())) {\n                onCreateLink(inputValue.trim(), selectedText || inputValue.trim());\n              } else {\n                // 아니면 새 문서 생성 링크로 사용\n                const slugify = (text) => text.toLowerCase().replace(/\\s+/g, '-').replace(/[^\\w-]+/g, '');\n                onCreateLink(`/doc/${slugify(inputValue.trim())}`, selectedText || inputValue.trim());\n              }\n            }\n          }}\n          style={{\n            padding: '6px 12px',\n            backgroundColor: '#4c9aff',\n            color: 'white',\n            border: 'none',\n            borderRadius: '4px',\n            cursor: 'pointer',\n            opacity: inputValue.trim() ? 1 : 0.6,\n          }}\n          disabled={!inputValue.trim()}\n        >\n          링크 생성\n        </button>\n      </div>\n    </div>\n  );\n};\n\n// --- Link Button Component ---\nconst LinkButton = ({ position, onClick, selectedText }) => {\n  return (\n    <button\n      style={{\n        position: 'fixed',\n        top: `${position?.top || 0}px`,\n        left: `${position?.left || 0}px`,\n        zIndex: 1000,\n        transform: 'translateX(-50%)',\n      }}\n      className=\"bg-blue-500 hover:bg-blue-600 text-white rounded-full p-3 shadow-lg flex items-center justify-center\"\n      onClick={() => onClick(selectedText)}\n      title=\"링크 생성\"\n    >\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\n        <path d=\"M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z\"/>\n        <path d=\"M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z\"/>\n      </svg>\n    </button>\n  );\n};\n\n// --- MikiEditor Component ---\nconst MikiEditor = forwardRef(({ onContentChange, onSendToAi, onContextUpdate, onNavigateRequest }, ref) => {\n  const editorRef = useRef(null);\n  const [currentContent, setCurrentContent] = useState('');\n  const [editorSelection, setEditorSelection] = useState(null); // Store { range, text, cursor }\n  const [commandHistory, setCommandHistory] = useState([]);\n  const [historyPointer, setHistoryPointer] = useState(-1);\n  const [activeSuggestion, setActiveSuggestion] = useState(null); // Stores the AI suggestion object\n  const [pendingCommand, setPendingCommand] = useState(null);\n  const [showLinkButton, setShowLinkButton] = useState(false);\n  const [linkButtonPosition, setLinkButtonPosition] = useState({ top: 0, left: 0 });\n  const [showLinkPopover, setShowLinkPopover] = useState(false);\n  const [linkPopoverPosition, setLinkPopoverPosition] = useState({ top: 0, left: 0 });\n  const lastContentRef = useRef(''); // 마지막 내용을 저장하기 위한 ref\n  const updateCountRef = useRef(0); // 디버깅용 업데이트 카운터\n  const [selectedTextForLink, setSelectedTextForLink] = useState(''); // 링크용 선택 텍스트 상태 추가\n  const [savedSelection, setSavedSelection] = useState(null); // WYSIWYG용 선택 영역 저장\n\n  // 에디터 컨텍스트 업데이트를 위한 디바운스 함수\n  const debouncedContextUpdate = useCallback(\n    debounce((markdownContent, selectionInfo) => {\n      if (onContextUpdate) {\n        onContextUpdate({ fullContent: markdownContent, selection: selectionInfo });\n      }\n    }, 300),\n    [onContextUpdate]\n  );\n\n  // 에디터 내용 변경 콜백을 위한 디바운스 함수 (더 짧은 시간)\n  const debouncedContentChange = useCallback(\n    debounce((content) => {\n      if (onContentChange && lastContentRef.current !== content) {\n        // 실제 내용이 변경되었을 때만 호출\n        lastContentRef.current = content;\n        onContentChange(content);\n      }\n    }, 150), // 타이핑 응답성을 위해 짧게 설정\n    [onContentChange]\n  );\n\n  // Handles editor content and selection changes - 디바운스 처리\n  const handleEditorActivity = useCallback(\n    debounce(() => {\n    if (!editorRef.current) return;\n    const instance = editorRef.current.getInstance();\n    const markdownContent = instance.getMarkdown();\n    const selection = instance.getSelection(); // [[line, char], [line, char]]\n    const selectedText = instance.getSelectedText();\n    let cursorPositionInfo = null;\n    if (selection && selection.length === 2 && selection[0] && selection[0].length === 2) {\n      cursorPositionInfo = selection[0]; // [line, char] for the start of the selection or cursor\n    }\n\n    const selectionInfo = {\n      range: selection,\n      text: selectedText,\n      cursor: cursorPositionInfo,\n    };\n\n      // 내용이 변경된 경우에만 상태 업데이트 및 콜백 호출\n      if (currentContent !== markdownContent) {\n        updateCountRef.current++;\n        \n        // 개발 로그는 10회마다 출력 (로그 수 감소)\n        if (updateCountRef.current % 10 === 0) {\n          console.log(`에디터 내용 업데이트 (${updateCountRef.current}회): 길이=${markdownContent.length}`);\n        }\n        \n    setCurrentContent(markdownContent);\n        debouncedContentChange(markdownContent);\n      }\n\n      setEditorSelection(selectionInfo);\n    debouncedContextUpdate(markdownContent, selectionInfo);\n    }, 50), // 50ms 디바운스로 업데이트 빈도 제한\n    [debouncedContextUpdate, debouncedContentChange, currentContent]\n  );\n\n  // 텍스트 선택 시 링크 버튼 표시 처리\n  const handleSelectionChange = useCallback(() => {\n    if (!editorRef.current) return;\n    const instance = editorRef.current.getInstance();\n    const selectedText = instance.getSelectedText();\n    \n    if (selectedText && selectedText.trim().length > 0) {\n      // 선택 영역 위치 계산\n      const selection = window.getSelection();\n      if (selection && selection.rangeCount > 0) {\n        const range = selection.getRangeAt(0);\n        const rect = range.getBoundingClientRect();\n        \n        // 에디터 요소의 경계 가져오기\n        const editorEl = instance.wwEditor?.el || instance.mdEditor?.el;\n        const editorRect = editorEl ? editorEl.getBoundingClientRect() : { left: 0, right: window.innerWidth };\n        \n        // 선택된 텍스트의 중간 지점 계산\n        const leftPos = rect.left + (rect.width / 2);\n        \n        // 선택된 텍스트 저장\n        setSelectedTextForLink(selectedText);\n        \n        // 링크 버튼 위치 설정 (선택 텍스트 중간 지점 기준)\n        setLinkButtonPosition({\n          top: rect.bottom + window.scrollY + 5, // 텍스트 아래에 약간의 여백 추가\n          left: leftPos // 텍스트의 중간 위치\n        });\n        setShowLinkButton(true);\n      }\n    } else {\n      setShowLinkButton(false);\n    }\n  }, []);\n\n  // 에디터 이벤트 리스너 수정 - 최적화\n  useEffect(() => {\n    const instance = editorRef.current?.getInstance();\n    if (instance) {\n      // 이전 리스너 모두 제거\n      instance.off('change');\n      instance.off('caretChange');\n      \n      // 필수 이벤트만 등록\n      instance.on('change', handleEditorActivity);\n      \n      // 캐럿 변경은 선택 변경에만 영향을 줌\n      instance.on('caretChange', () => {\n        handleSelectionChange();\n      });\n      \n      const editorRoot = instance.wwEditor?.el || instance.mdEditor?.el;\n      if (editorRoot) {\n        // 키보드 관련 이벤트는 키다운만 사용 (중복 방지)\n        const handleEditorKeyDown = (event) => {\n          // Undo/Redo shortcuts\n          if ((event.ctrlKey || event.metaKey) && event.key === 'z') {\n            event.preventDefault();\n            ref.current?.undo();\n            return;\n          }\n          if ((event.ctrlKey || event.metaKey) && event.key === 'y') {\n            event.preventDefault();\n            ref.current?.redo();\n            return;\n          }\n          \n          // Enter 키 처리를 위한 로직 - AI 연동\n          if (event.key === 'Enter' && !event.shiftKey) {\n            const currentSelection = instance.getSelection();\n            if (currentSelection && currentSelection.length > 0 && currentSelection[0] && currentSelection[0].length > 0) {\n              const lineIndex = currentSelection[0][0]; // 0-based line index\n              const currentLineText = instance.getMarkdown().split('\\n')[lineIndex];\n              \n              if (currentLineText && currentLineText.trim().length > 0 && onSendToAi) {\n                // 콘솔 로그 최소화\n                // console.log(`Enter pressed on line ${lineIndex + 1}`);\n                \n                onSendToAi({\n                  text: currentLineText.trim(),\n                  type: 'user_command_editor_enter',\n                  commandContext: {\n                    lineNumber: lineIndex + 1, // 1-based for AI\n                    fullLineText: currentLineText,\n                    currentSelection: editorSelection, // Send full editor selection context\n                    fullContent: instance.getMarkdown()\n                  }\n                });\n              }\n            }\n          }\n        };\n        \n        // 링크 클릭 이벤트 핸들러 추가\n        const handleLinkClick = (event) => {\n          const link = event.target.closest('a');\n          if (link && link.getAttribute('href')) { // .href 대신 getAttribute 사용\n            const href = link.getAttribute('href');\n            // 내부 문서 링크인지 확인 (/doc/ 접두사)\n            if (href.startsWith('/doc/')) {\n              event.preventDefault();\n              event.stopPropagation();\n              \n              // 문서 경로 추출\n              const docPath = href.split('/doc/')[1].replace('/', '');\n              console.log(`내부 문서 링크 클릭: ${docPath}`);\n              \n              // 부모 컴포넌트(App.jsx)의 네비게이션 함수 호출\n              if (onNavigateRequest) {\n                onNavigateRequest(docPath);\n              } else {\n                console.warn('onNavigateRequest prop이 MikiEditor에 전달되지 않았습니다.');\n              }\n            } else if (href.startsWith('http')) {\n              // 외부 링크는 새 탭에서 열기\n              event.preventDefault();\n              window.open(href, '_blank', 'noopener,noreferrer');\n            }\n            // 그 외 (mailto: 등)는 기본 동작 허용\n          }\n        };\n        \n        // 붙여넣기 이벤트 (주요 이벤트이므로 유지)\n        const handlePaste = () => {\n          // 붙여넣기 후 약간의 지연을 주어 내용이 반영된 후 호출\n          setTimeout(handleEditorActivity, 10);\n        };\n        \n        // 이벤트 리스너 정리 - 필수 이벤트만 등록\n        editorRoot.addEventListener('keydown', handleEditorKeyDown);\n        editorRoot.addEventListener('paste', handlePaste);\n        editorRoot.addEventListener('mouseup', handleSelectionChange);\n        editorRoot.addEventListener('click', handleLinkClick); // 링크 클릭 이벤트 추가\n        \n        return () => {\n          editorRoot.removeEventListener('keydown', handleEditorKeyDown);\n          editorRoot.removeEventListener('paste', handlePaste);\n          editorRoot.removeEventListener('mouseup', handleSelectionChange);\n          editorRoot.removeEventListener('click', handleLinkClick);\n        };\n      }\n    }\n  }, [handleEditorActivity, onSendToAi, editorSelection, commandHistory, historyPointer, ref, handleSelectionChange, onNavigateRequest]);\n\n  // Calculates position for the suggestion popover\n  const calculateSuggestionPosition = (actionRange) => {\n    if (!editorRef.current) return { top: 100, left: 100 }; // Default fallback\n    const editorInstance = editorRef.current.getInstance();\n    const editorDomElement = editorInstance.wwEditor?.el || editorInstance.mdEditor?.el;\n    if (!editorDomElement) return { top: 100, left: 100 };\n    const editorRect = editorDomElement.getBoundingClientRect();\n\n    let targetRangeForPos = actionRange;\n    if (typeof actionRange === 'string') {\n        if (actionRange === 'cursor' || actionRange === 'selection') {\n            targetRangeForPos = editorSelection?.range;\n        }\n        // 'document_start', 'document_end', 'line_number' might need more specific handling\n    }\n\n    if (targetRangeForPos && targetRangeForPos.from && Array.isArray(targetRangeForPos.from)) {\n      try {\n        const winSel = window.getSelection();\n        if (winSel && winSel.rangeCount > 0) {\n          const range = winSel.getRangeAt(0);\n          const rect = range.getBoundingClientRect();\n          if (editorDomElement.contains(range.commonAncestorContainer) && (rect.width > 0 || rect.height > 0)) {\n            return {\n              top: rect.bottom + window.scrollY + 5,\n              left: rect.left + window.scrollX,\n            };\n          }\n        }\n        // Fallback if window selection is not useful or not in editor\n        const approxLineHeight = 20;\n        const targetLine = targetRangeForPos.from[0]; // 0-based line\n        return {\n          top: editorRect.top + window.scrollY + (targetLine * approxLineHeight) + approxLineHeight + 10,\n          left: editorRect.left + window.scrollX + editorRect.width * 0.1, // Indent a bit\n        };\n      } catch (e) {\n        console.warn(\"Error calculating suggestion position from range, using fallback.\", e);\n      }\n    }\n    // General fallback if no specific range info\n    return { top: editorRect.top + window.scrollY + 50, left: editorRect.left + window.scrollX + 50 };\n  };\n\n  /**\n   * AI 액션을 에디터에 적용하는 함수\n   * @param {Object} action - 적용할 액션 객체\n   * @param {Object} editorInstance - 에디터 인스턴스\n   * @returns {boolean} - 액션 적용 성공 여부\n   */\n  const _applySingleActionToEditor = (action, editorInstance) => {\n    if (!action || !editorInstance) return false;\n    try {\n      switch (action.actionType) {\n        // 일반 텍스트 삽입 (대화/글 확장)\n      case 'insert_content':\n          editorInstance.insertText(action.content);\n          return true;\n        // 마크다운 링크 삽입\n        case 'insert_markdown_link':\n          editorInstance.insertText(action.content);\n          return true;\n        // 기존 문서 복원 (전체 문서 교체)\n        case 'restore_document':\n          if (action.range === 'full_document') {\n            editorInstance.setMarkdown(action.content || '');\n            return true;\n          }\n          return false;\n        // 기타 마크다운 서식 액션들 (예시)\n        case 'format_bold':\n        case 'format_italic':\n          // 필요시 서식 처리 추가\n          return true;\n          default:\n          console.warn(`지원되지 않는 액션 타입: ${action.actionType}`);\n          return false;\n        }\n    } catch (e) {\n      console.error('액션 적용 오류:', e);\n      return false;\n    }\n  };\n\n  // Handles accepting an AI suggestion\n  const handleAcceptSuggestion = (suggestion) => {\n    if (!editorRef.current || !suggestion || !Array.isArray(suggestion.actions) || suggestion.actions.length === 0) {\n      setActiveSuggestion(null);\n      console.warn('Attempted to accept an invalid or empty suggestion:', suggestion);\n      return;\n    }\n    const editorInstance = editorRef.current.getInstance();\n    const beforeStateAllActions = editorInstance.getMarkdown();\n    let anyActionApplied = false;\n\n    suggestion.actions.forEach(action => {\n      // Validate action structure here if needed, or assume valid from AI\n      const commandApplied = _applySingleActionToEditor(action, editorInstance);\n      if (commandApplied) {\n        anyActionApplied = true;\n      }\n    });\n\n    if (anyActionApplied) {\n      const afterStateAllActions = editorInstance.getMarkdown();\n      if (beforeStateAllActions !== afterStateAllActions) {\n        const newHistory = commandHistory.slice(0, historyPointer + 1);\n        newHistory.push({\n          before: beforeStateAllActions,\n          after: afterStateAllActions,\n          // Store the whole suggestion for context, or just the applied actions\n          command: { type: \"ai_suggestion\", suggestionId: suggestion.suggestionId, actions: suggestion.actions }\n        });\n        setCommandHistory(newHistory);\n        setHistoryPointer(newHistory.length - 1);\n      }\n      handleEditorActivity(); // Update context after applying actions\n    }\n    setActiveSuggestion(null); // Hide popover\n  };\n\n  // Handles cancelling an AI suggestion\n  const handleCancelSuggestion = (suggestionId) => {\n    setActiveSuggestion(null);\n    // Optionally, send feedback to AI that suggestion was cancelled\n  };\n\n  // 4단계: AI 구조화 명령 적용 함수\n  const handleApplySuggestion = useCallback(() => {\n    if (!pendingCommand || !editorRef.current) return;\n    console.log(\"구조화 명령 적용 시도:\", pendingCommand); // 디버깅 로그 추가\n    const editorInstance = editorRef.current.getInstance();\n    let anyActionApplied = false;\n\n    // 다양한 명령 형식 처리\n    if (pendingCommand.actions && Array.isArray(pendingCommand.actions)) {\n      // v7 actions 배열 형식\n      pendingCommand.actions.forEach(action => {\n        const commandApplied = _applySingleActionToEditor(action, editorInstance);\n        if (commandApplied) anyActionApplied = true;\n      });\n    } else if (pendingCommand.action && typeof pendingCommand.action === 'object') {\n      // action 객체가 직접 있는 경우\n      const commandApplied = _applySingleActionToEditor(pendingCommand.action, editorInstance);\n      if (commandApplied) anyActionApplied = true;\n    } else if (pendingCommand.actionType) {\n      // 자체가 액션 객체인 경우\n      const commandApplied = _applySingleActionToEditor(pendingCommand, editorInstance);\n      if (commandApplied) anyActionApplied = true;\n    } else if (pendingCommand.displayText && !pendingCommand.isSuggestion) {\n      // 단순 표시용 텍스트만 있는 경우\n      console.log(\"표시용 텍스트 응답:\", pendingCommand.displayText);\n      // 아무 액션도 수행하지 않음\n    } else {\n      console.warn(\"알 수 없는 명령 형식:\", pendingCommand);\n    }\n    \n    if (anyActionApplied) {\n      handleEditorActivity();\n      console.log(\"구조화 명령 적용 성공\"); // 디버깅 로그 추가\n    } else {\n      console.warn(\"구조화 명령 적용 실패 또는 표시 전용 명령\"); // 디버깅 로그 추가\n    }\n    setPendingCommand(null);\n  }, [pendingCommand, editorRef, handleEditorActivity]);\n\n  // AiPanel에서 구조화 명령을 받는 콜백\n  const handleStructuredCommand = useCallback((cmd) => {\n    setPendingCommand(cmd);\n  }, []);\n\n  // pendingCommand가 변경될 때 handleApplySuggestion 호출\n  useEffect(() => {\n    if (pendingCommand) {\n      handleApplySuggestion();\n    }\n  }, [pendingCommand, handleApplySuggestion]);\n\n  // Expose methods to parent component (App.js)\n  useImperativeHandle(ref, () => ({\n    insertText(textToInsert, atRange) { // Simple text insertion, can be part of AI action too\n      if (editorRef.current) {\n        const instance = editorRef.current.getInstance();\n        if (instance.getMode && instance.getMode() !== 'wysiwyg') instance.changeMode('wysiwyg');\n        const beforeState = instance.getMarkdown();\n        \n        let insertFrom = atRange?.from;\n        let insertTo = atRange?.to;\n        if (!insertFrom || !insertTo){\n            const currentSel = instance.getSelection();\n            insertFrom = currentSel[0];\n            insertTo = currentSel[0]; // insert at cursor start\n        }\n\n        instance.replaceSelection(textToInsert, insertFrom, insertTo);\n        \n        const afterState = instance.getMarkdown();\n        if (beforeState !== afterState) {\n          const newHistory = commandHistory.slice(0, historyPointer + 1);\n          newHistory.push({ before: beforeState, after: afterState, command: { type: 'insertText', content: textToInsert } });\n          setCommandHistory(newHistory);\n          setHistoryPointer(newHistory.length - 1);\n        }\n        handleEditorActivity();\n      }\n    },\n    // App.jsx에서 호출하는 applyStructuredAiCommand 메서드 구현\n    applyStructuredAiCommand(commandAction) {\n      console.log(\"applyStructuredAiCommand 호출됨:\", commandAction);\n      \n      // 사용자 확인이 필요한 명령인지 확인\n      const requiresConfirmation = true; // 모든 명령에 대해 사용자 확인 필요\n\n      if (requiresConfirmation) {\n        // 명령 내용 설명 준비\n        let actionDesc = \"에디터 내용을 수정하려고 합니다.\";\n        if (commandAction.displayText) {\n          actionDesc = commandAction.displayText;\n        } else if (commandAction.actionType) {\n          actionDesc = `${commandAction.actionType} 작업을 수행하려고 합니다.`;\n        }\n\n        // 사용자 확인 요청\n        if (window.confirm(`AI가 다음 작업을 수행하려고 합니다:\\n\\n${actionDesc}\\n\\n허용하시겠습니까?`)) {\n          // 사용자가 확인한 경우에만 명령 실행\n          handleStructuredCommand(commandAction);\n        } else {\n          console.log(\"사용자가 명령 실행을 취소했습니다.\");\n        }\n      } else {\n        // 즉시 실행이 필요한 특수한 경우가 있다면 여기에 추가\n        handleStructuredCommand(commandAction);\n      }\n    },\n    undo() {\n      if (historyPointer < 0) return;\n      const lastEdit = commandHistory[historyPointer];\n      editorRef.current.getInstance().setMarkdown(lastEdit.before);\n      setHistoryPointer(historyPointer - 1);\n      handleEditorActivity();\n    },\n    redo() {\n      if (historyPointer + 1 >= commandHistory.length) return;\n      const nextEdit = commandHistory[historyPointer + 1];\n      editorRef.current.getInstance().setMarkdown(nextEdit.after);\n      setHistoryPointer(historyPointer + 1);\n      handleEditorActivity();\n    },\n    displayAiSuggestion(suggestionObject) {\n      // Expect suggestionObject to be the parsed JSON from AI according to v7 schema\n      if (suggestionObject && suggestionObject.isSuggestion && suggestionObject.actions && suggestionObject.actions.length > 0) {\n        // Determine position based on the first action's range, or a general position\n        const firstActionRange = suggestionObject.actions[0].range;\n        const pos = calculateSuggestionPosition(firstActionRange);\n        setActiveSuggestion({ ...suggestionObject, visible: true, position: pos });\n        \n        // 사용자에게 제안 내용 알림을 위한 로그\n        console.log(\"에디터에 AI 제안이 표시됩니다:\", suggestionObject.displayText);\n      } else if (suggestionObject && suggestionObject.suggestionType === 'clarification_needed'){\n        // Handle clarification requests (e.g., show a different UI or send to AiPanel)\n        console.log(\"Clarification needed from AI:\", suggestionObject.displayText, suggestionObject.clarificationDetails);\n        // For now, just log it. AiPanel could handle this.\n        if(onSendToAi && suggestionObject.clarificationDetails && suggestionObject.clarificationDetails.query){\n            // Example: Forward clarification to AiPanel to display options\n            // This part needs AiPanel to be able to handle such interactions\n        }\n        setActiveSuggestion(null); // Don't show standard popover for clarifications\n      } else {\n        console.warn('Received invalid or non-actionable suggestion object:', suggestionObject);\n        setActiveSuggestion(null); // Hide popover if any\n      }\n    },\n    getEditorInstance() {\n      return editorRef.current?.getInstance();\n    },\n    getCurrentContext() {\n        return { fullContent: currentContent, selection: editorSelection };\n    }\n  }));\n\n  // 링크 버튼 클릭 핸들러\n  const handleLinkButtonClick = useCallback((selectedText) => {\n    console.log(\"링크 버튼 클릭됨, 선택된 텍스트:\", selectedText);\n    // 선택 영역 저장 (WYSIWYG 모드에서 필요)\n    if (editorRef.current) {\n      const instance = editorRef.current.getInstance();\n      setSavedSelection(instance.getSelection());\n    }\n    setLinkPopoverPosition(linkButtonPosition);\n    setShowLinkButton(false);\n    setShowLinkPopover(true);\n  }, [linkButtonPosition]);\n\n  // 링크 생성 핸들러\n  const handleLinkCreate = useCallback((linkUrl, linkText) => {\n    console.log(`링크 생성: ${linkText} -> ${linkUrl}`);\n    if (!editorRef.current) return;\n\n    const editor = editorRef.current.getInstance();\n\n    try {\n      if (editor.isWysiwygMode()) {\n        // WYSIWYG 모드: Toast UI Editor의 addLink 명령 사용\n        try {\n          editor.exec('addLink', {\n            linkText: linkText || linkUrl,\n            linkUrl: linkUrl\n          });\n          console.log(`WYSIWYG 모드에서 링크 삽입 성공: ${linkText} -> ${linkUrl}`);\n        } catch (addLinkError) {\n          console.warn('addLink 명령 실패, 대체 방법 시도:', addLinkError);\n          \n          // 대체 방법: HTML 직접 삽입\n          const linkHtml = `<a href=\"${linkUrl}\" target=\"_blank\" rel=\"noopener noreferrer\">${linkText || linkUrl}</a>`;\n          editor.insertHTML(linkHtml);\n          console.log(`HTML 직접 삽입으로 링크 생성 성공`);\n        }\n      } else {\n        // 마크다운 모드: 마크다운 문법으로 삽입\n        const markdownLink = `[${linkText || linkUrl}](${linkUrl})`;\n        editor.insertText(markdownLink);\n        console.log(`마크다운 모드에서 링크 삽입: ${markdownLink}`);\n      }\n    } catch (error) {\n      console.error(\"링크 생성 오류:\", error);\n      \n      // 최후의 방법: 클립보드에 복사 후 알림\n      try {\n        const fallbackText = `[${linkText || linkUrl}](${linkUrl})`;\n        navigator.clipboard.writeText(fallbackText);\n        alert(`링크 생성에 실패했습니다. 마크다운 링크가 클립보드에 복사되었습니다:\\n${fallbackText}\\n\\nCtrl+V로 붙여넣기 해주세요.`);\n      } catch (clipboardErr) {\n        console.error(\"클립보드 복사 실패:\", clipboardErr);\n        alert(`링크 생성에 실패했습니다. 수동으로 링크를 추가해주세요:\\n[${linkText || linkUrl}](${linkUrl})`);\n      }\n    }\n\n    setShowLinkPopover(false);\n  }, []);\n\n  // 링크 생성 취소 핸들러\n  const handleCancelLinkCreation = useCallback(() => {\n    setShowLinkPopover(false);\n  }, []);\n\n  // EditorUI 스타일 참조\n  const editorStyle = {\n    height: '100%',\n    overflow: 'auto',\n    display: 'flex',\n    flexDirection: 'column',\n  };\n\n  // 에디터 인스턴스 관련 스타일\n  const toastUIEditorStyle = {\n    flex: 1,\n    overflow: 'auto',\n    minHeight: '200px',\n    maxHeight: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  };\n\n  // 전역 접근을 위해 window 객체에 설정\n  useEffect(() => {\n    window.editorRef = editorRef;\n    return () => {\n      delete window.editorRef;\n    };\n  }, []);\n\n  // 문서 경로로 문서 로드하는 함수\n  const loadDocumentByPath = useCallback(async (docPath, linkText) => {\n    console.log(`문서 로드 시도: ${docPath} (링크 텍스트: ${linkText})`);\n    \n    try {\n      // 1. 로컬 스토리지에서 문서 찾기 (여러 패턴 시도)\n      const possibleKeys = [\n        `miki_document_${docPath}`,\n        `miki_document_${docPath.toLowerCase()}`,\n        `miki_document_${docPath.replace(/-/g, ' ')}`,\n        `miki_document_${linkText ? slugify(linkText) : docPath}`\n      ];\n      \n      let foundDoc = null;\n      let foundKey = null;\n      \n      for (const key of possibleKeys) {\n        const docData = localStorage.getItem(key);\n        if (docData) {\n          try {\n            foundDoc = JSON.parse(docData);\n            foundKey = key;\n            console.log(`로컬 스토리지에서 문서 발견: ${key}`);\n            break;\n          } catch (parseError) {\n            console.warn(`문서 파싱 오류 (${key}):`, parseError);\n          }\n        }\n      }\n      \n      // 2. 로컬 스토리지에 없으면 제목으로 검색\n      if (!foundDoc) {\n        console.log('키로 찾지 못함, 제목으로 검색 시도...');\n        const allKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\n        \n        for (const key of allKeys) {\n          try {\n            const docData = JSON.parse(localStorage.getItem(key));\n            if (docData.title && (\n              docData.title.toLowerCase() === linkText?.toLowerCase() ||\n              docData.title.toLowerCase() === docPath.toLowerCase() ||\n              slugify(docData.title) === docPath\n            )) {\n              foundDoc = docData;\n              foundKey = key;\n              console.log(`제목으로 문서 발견: ${docData.title}`);\n              break;\n            }\n          } catch (e) {\n            // 파싱 오류 무시\n          }\n        }\n      }\n      \n      // 3. 서버에서 문서 찾기 (로컬에 없는 경우)\n      if (!foundDoc) {\n        console.log('로컬에서 찾지 못함, 서버에서 검색 시도...');\n        try {\n          const response = await fetch(`http://localhost:3003/api/posts`);\n          if (response.ok) {\n            const serverPosts = await response.json();\n            const matchedPost = serverPosts.find(post => \n              post.id === docPath || \n              post.title?.toLowerCase() === linkText?.toLowerCase() ||\n              slugify(post.title || '') === docPath\n            );\n            \n            if (matchedPost) {\n              foundDoc = matchedPost;\n              console.log(`서버에서 문서 발견: ${matchedPost.title}`);\n              \n              // 서버에서 가져온 문서를 로컬 스토리지에도 저장\n              const localKey = `miki_document_${matchedPost.id || docPath}`;\n              localStorage.setItem(localKey, JSON.stringify(matchedPost));\n              console.log(`서버 문서를 로컬에 캐시: ${localKey}`);\n            }\n          }\n        } catch (serverError) {\n          console.warn('서버에서 문서 검색 실패:', serverError);\n        }\n      }\n      \n      // 4. 문서를 찾았으면 에디터에 로드\n      if (foundDoc) {\n        await loadDocumentToEditor(foundDoc, linkText);\n      } else {\n        console.log(`문서를 찾을 수 없음: ${docPath}`);\n        \n        // 문서가 없으면 새 문서 생성 옵션 제공\n        const shouldCreate = window.confirm(\n          `\"${linkText || docPath}\" 문서를 찾을 수 없습니다.\\n\\n새 문서를 생성하시겠습니까?`\n        );\n        \n        if (shouldCreate) {\n          createNewDocument(linkText || docPath);\n        }\n      }\n    } catch (error) {\n      console.error('문서 로드 중 오류:', error);\n      \n      // 사용자에게 오류 알림\n      if (onContextUpdate) {\n        onContextUpdate({ \n          message: { \n            type: 'error', \n            text: `문서 로드 실패: ${error.message}` \n                  }\n                });\n              }\n            }\n  }, [onContextUpdate]);\n\n  // 에디터에 문서 로드하는 함수\n  const loadDocumentToEditor = useCallback(async (docData, linkText) => {\n    console.log(`에디터에 문서 로드: ${docData.title || linkText}`);\n    \n    try {\n      // 현재 문서가 변경되었으면 저장 여부 확인\n      if (currentContent && currentContent.trim() !== '' && onContentChange) {\n        const shouldSave = window.confirm(\n          '현재 문서에 저장되지 않은 변경사항이 있습니다.\\n\\n저장하고 새 문서를 여시겠습니까?'\n        );\n        \n        if (shouldSave) {\n          // 현재 문서 저장 로직 호출 (App.jsx의 saveCurrentDocument)\n          if (window.saveCurrentDocument) {\n            await window.saveCurrentDocument();\n          }\n        }\n      }\n      \n      // 에디터에 새 문서 내용 로드\n      if (editorRef.current) {\n        const editor = editorRef.current.getInstance();\n        const content = docData.content || '';\n        \n        editor.setMarkdown(content);\n        console.log(`에디터에 내용 로드 완료: ${content.length}자`);\n      }\n      \n      // 상태 업데이트 (App.jsx의 상태 업데이트 함수들 호출)\n      if (window.setCurrentDocument) window.setCurrentDocument(docData);\n      if (window.setTitle) window.setTitle(docData.title || linkText || '');\n      if (window.setSaveStatus) window.setSaveStatus('저장됨');\n      \n      // 사용자에게 성공 알림\n      if (onContextUpdate) {\n        onContextUpdate({ \n          message: { \n            type: 'success', \n            text: `\"${docData.title || linkText}\" 문서를 열었습니다.` \n          } \n        });\n      }\n      \n      console.log(`문서 로드 완료: ${docData.title || linkText}`);\n    } catch (error) {\n      console.error('에디터 문서 로드 오류:', error);\n      throw error;\n    }\n  }, [currentContent, onContentChange, onContextUpdate]);\n\n  // 새 문서 생성 함수\n  const createNewDocument = useCallback((title) => {\n    console.log(`새 문서 생성: ${title}`);\n    \n    try {\n      // 에디터 초기화\n      if (editorRef.current) {\n        const editor = editorRef.current.getInstance();\n        const initialContent = `# ${title}\\n\\n`;\n        editor.setMarkdown(initialContent);\n      }\n      \n      // 상태 업데이트\n      if (window.setCurrentDocument) window.setCurrentDocument(null);\n      if (window.setTitle) window.setTitle(title);\n      if (window.setSaveStatus) window.setSaveStatus('변경됨');\n      \n      // 사용자에게 알림\n      if (onContextUpdate) {\n        onContextUpdate({ \n          message: { \n            type: 'info', \n            text: `\"${title}\" 새 문서를 생성했습니다.` \n          } \n        });\n      }\n      \n      console.log(`새 문서 생성 완료: ${title}`);\n    } catch (error) {\n      console.error('새 문서 생성 오류:', error);\n    }\n  }, [onContextUpdate]);\n\n  return (\n    <div style={{ \n      position: 'relative', \n      height: '100%', \n      overflow: 'auto',\n      display: 'flex',\n      flexDirection: 'column'\n    }} className=\"miki-editor-container flex-grow\">\n      <Editor\n        ref={editorRef}\n        initialValue=\"\"\n        previewStyle={window.innerWidth > 1000 ? 'vertical' : 'tab'}\n        height=\"100%\"\n        initialEditType=\"wysiwyg\"\n        useCommandShortcut={true} // Enables default shortcuts, but we override some\n        theme={localStorage.getItem('theme') === 'dark' ? 'dark' : 'default'}\n        usageStatistics={false}\n        // 링크 클릭 활성화 설정\n        linkAttributes={{\n          target: '_self', // 같은 탭에서 열기\n          rel: null // rel 속성 제거\n        }}\n        // 서식 도구모음 추가\n        toolbarItems={[\n          ['heading', 'bold', 'italic', 'strike'],\n          ['hr', 'quote', 'ul', 'ol', 'task'],\n          ['table', 'image', 'link'],\n          ['code', 'codeblock']\n        ]}\n        // 에디터 확장 옵션 추가\n        extendedAutolinks={true}\n        // WYSIWYG 모드에서 링크 클릭 허용\n        viewer={false}\n        customHTMLRenderer={{\n          // 마크다운 문법이 WYSIWYG에서 제대로 표시되도록 사용자 정의 렌더러 추가\n          heading: (node) => {\n            const { level } = node;\n            const tagName = `h${level}`;\n            \n            return {\n              type: 'element', \n              tagName,\n              attributes: {},\n              children: node.children\n            };\n          },\n          // 링크 렌더러 개선 - 클릭 가능하도록 설정\n          link: (node) => {\n            return {\n              type: 'element',\n              tagName: 'a',\n              attributes: { \n                href: node.destination,\n                title: node.title || '',\n                // 내부 링크와 외부 링크 구분\n                target: node.destination.startsWith('http') ? '_blank' : '_self',\n                rel: node.destination.startsWith('http') ? 'noopener noreferrer' : null,\n                // 클릭 가능하도록 스타일 추가\n                style: 'color: #2563eb; text-decoration: underline; cursor: pointer;'\n              },\n              children: node.children\n            };\n          },\n          // 이미지 렌더러 추가\n          image: (node) => {\n            return {\n              type: 'element',\n              tagName: 'img',\n              attributes: {\n                src: node.destination,\n                alt: node.title || '',\n                title: node.title || ''\n              },\n              children: []\n            };\n          },\n          // 코드 블록 렌더러 추가\n          codeBlock: (node) => {\n            return {\n              type: 'element',\n              tagName: 'pre',\n              attributes: {},\n              children: [{\n                type: 'element',\n                tagName: 'code',\n                attributes: {\n                  'data-language': node.info || ''\n                },\n                children: [{\n                  type: 'text',\n                  content: node.literal || ''\n                }]\n              }]\n            };\n          },\n          // 인라인 코드 렌더러 추가\n          code: (node) => {\n            return {\n              type: 'element',\n              tagName: 'code',\n              attributes: {},\n              children: [{\n                type: 'text',\n                content: node.literal || ''\n              }]\n            };\n          },\n          // 인용구 렌더러 추가\n          blockQuote: (node) => {\n            return {\n              type: 'element',\n              tagName: 'blockquote',\n              attributes: {},\n              children: node.children\n            };\n          }\n        }}\n      />\n      \n      {/* 링크 생성 버튼 */}\n      {showLinkButton && (\n        <LinkButton \n          position={linkButtonPosition}\n          onClick={handleLinkButtonClick}\n          selectedText={selectedTextForLink}\n        />\n      )}\n      \n      {/* 링크 생성 팝오버 */}\n      {showLinkPopover && (\n        <LinkCreationPopover \n          position={linkPopoverPosition}\n          selectedText={selectedTextForLink}\n          onCreateLink={handleLinkCreate}\n          onCancel={handleCancelLinkCreation}\n        />\n      )}\n      \n      {/* AI 제안 표시용 팝오버 */}\n      {activeSuggestion && (\n        <AiSuggestionPopover\n          suggestion={activeSuggestion}\n          position={calculateSuggestionPosition(activeSuggestion.actionRange || 'cursor')}\n          onAccept={handleAcceptSuggestion}\n          onCancel={handleCancelSuggestion}\n        />\n      )}\n    </div>\n  );\n});\n\nexport default MikiEditor;\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__mocks__\\@testing-library\\react.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__mocks__\\fileMock.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\App.snapshot.test.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { render } from '@testing-library/react';\r\nimport '@testing-library/jest-dom';\r\nimport App from '../App';\r\n\r\n// Mock TanStack Query\r\njest.mock('@tanstack/react-query', () => ({\r\n  QueryClient: jest.fn().mockImplementation(() => ({\r\n    invalidateQueries: jest.fn(),\r\n    setQueryData: jest.fn(),\r\n    getQueryData: jest.fn(),\r\n    removeQueries: jest.fn(),\r\n    cancelQueries: jest.fn(),\r\n    resumePausedMutations: jest.fn(),\r\n  })),\r\n  QueryClientProvider: ({ children }) => children,\r\n  useQuery: () => ({\r\n    data: [],\r\n    isLoading: false,\r\n    error: null,\r\n    refetch: jest.fn(),\r\n  }),\r\n  useMutation: () => ({\r\n    mutate: jest.fn(),\r\n    mutateAsync: jest.fn(),\r\n    isLoading: false,\r\n    error: null,\r\n  }),\r\n  useQueryClient: () => ({\r\n    invalidateQueries: jest.fn(),\r\n    setQueryData: jest.fn(),\r\n    getQueryData: jest.fn(),\r\n  }),\r\n}));\r\n\r\njest.mock('@tanstack/react-query-devtools', () => ({\r\n  ReactQueryDevtools: () => null,\r\n}));\r\n\r\n// Mock config modules\r\njest.mock('../config/queryClient', () => ({\r\n  queryClient: {\r\n    invalidateQueries: jest.fn(),\r\n    setQueryData: jest.fn(),\r\n    getQueryData: jest.fn(),\r\n  },\r\n  setupNetworkListeners: jest.fn(),\r\n  queryKeys: {\r\n    documents: {\r\n      all: ['documents'],\r\n      lists: () => ['documents', 'list'],\r\n      detail: (id) => ['documents', 'detail', id],\r\n    },\r\n  },\r\n  handleQueryError: jest.fn(),\r\n  isOnline: () => true,\r\n}));\r\n\r\njest.mock('../config/featureFlags', () => ({\r\n  FEATURE_FLAGS: {},\r\n  isFeatureEnabled: () => true,\r\n}));\r\n\r\n// Mock hooks\r\njest.mock('../hooks/useDocuments', () => ({\r\n  useDocuments: () => ({\r\n    data: [],\r\n    isLoading: false,\r\n    error: null,\r\n  }),\r\n  useDocument: () => ({\r\n    data: null,\r\n    isLoading: false,\r\n    error: null,\r\n  }),\r\n  useSaveDocument: () => ({\r\n    mutate: jest.fn(),\r\n    mutateAsync: jest.fn(),\r\n    isLoading: false,\r\n  }),\r\n  useDeleteDocument: () => ({\r\n    mutate: jest.fn(),\r\n    mutateAsync: jest.fn(),\r\n    isLoading: false,\r\n  }),\r\n  useSyncStatus: () => ({\r\n    data: { hasPendingSync: false, pendingCount: 0, isOnline: true },\r\n  }),\r\n}));\r\n\r\n// Mock dependencies that might cause issues in test environment\r\njest.mock('../utils/database', () => ({\r\n  MikiDatabase: {\r\n    getInstance: () => ({\r\n      documents: {\r\n        toArray: () => Promise.resolve([]),\r\n        add: () => Promise.resolve(),\r\n        update: () => Promise.resolve(),\r\n        delete: () => Promise.resolve()\r\n      }\r\n    })\r\n  }\r\n}));\r\n\r\njest.mock('../stores', () => ({\r\n  useDocumentStore: () => ({\r\n    documents: [],\r\n    currentDocument: null,\r\n    setCurrentDocument: jest.fn(),\r\n    updateDocument: jest.fn(),\r\n    addDocument: jest.fn(),\r\n    deleteDocument: jest.fn(),\r\n    loadDocuments: jest.fn(),\r\n  }),\r\n  useUIStore: () => ({\r\n    sidebarOpen: false,\r\n    theme: 'light',\r\n    isFullscreen: false,\r\n    toggleSidebar: jest.fn(),\r\n    setTheme: jest.fn(),\r\n    toggleFullscreen: jest.fn(),\r\n  }),\r\n  useEditorStore: () => ({\r\n    content: '',\r\n    title: '',\r\n    isEditing: false,\r\n    saveStatus: '저장됨',\r\n    setContent: jest.fn(),\r\n    setTitle: jest.fn(),\r\n    setEditing: jest.fn(),\r\n    setSaveStatus: jest.fn(),\r\n  })\r\n}));\r\n\r\n// Mock window.matchMedia for responsive tests\r\nObject.defineProperty(window, 'matchMedia', {\r\n  writable: true,\r\n  value: jest.fn().mockImplementation(query => ({\r\n    matches: false,\r\n    media: query,\r\n    onchange: null,\r\n    addListener: jest.fn(),\r\n    removeListener: jest.fn(),\r\n    addEventListener: jest.fn(),\r\n    removeEventListener: jest.fn(),\r\n    dispatchEvent: jest.fn(),\r\n  })),\r\n});\r\n\r\ndescribe('App Component Snapshots', () => {\r\n  beforeEach(() => {\r\n    // Reset any mocks before each test\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  test('App 컴포넌트 기본 렌더링 스냅샷', () => {\r\n    const { asFragment } = render(<App />);\r\n    expect(asFragment()).toMatchSnapshot();\r\n  });\r\n\r\n  test('App 컴포넌트 DOM 구조 검증', () => {\r\n    const { container } = render(<App />);\r\n    \r\n    // 실제 App.jsx 구조에 맞는 핵심 UI 요소들이 존재하는지 확인\r\n    expect(container.querySelector('header')).toBeInTheDocument();\r\n    expect(container.querySelector('.flex-grow')).toBeInTheDocument();\r\n    \r\n    // 스냅샷으로 전체 구조 보존\r\n    expect(container.firstChild).toMatchSnapshot('app-dom-structure');\r\n  });\r\n\r\n  test('반응형 레이아웃 스냅샷 (모바일)', () => {\r\n    // 모바일 뷰포트 시뮬레이션\r\n    Object.defineProperty(window, 'innerWidth', {\r\n      writable: true,\r\n      configurable: true,\r\n      value: 375,\r\n    });\r\n    \r\n    window.matchMedia = jest.fn().mockImplementation(query => ({\r\n      matches: query.includes('max-width: 768px'),\r\n      media: query,\r\n      onchange: null,\r\n      addListener: jest.fn(),\r\n      removeListener: jest.fn(),\r\n      addEventListener: jest.fn(),\r\n      removeEventListener: jest.fn(),\r\n      dispatchEvent: jest.fn(),\r\n    }));\r\n\r\n    const { asFragment } = render(<App />);\r\n    expect(asFragment()).toMatchSnapshot('app-mobile-layout');\r\n  });\r\n\r\n  test('반응형 레이아웃 스냅샷 (데스크톱)', () => {\r\n    // 데스크톱 뷰포트 시뮬레이션\r\n    Object.defineProperty(window, 'innerWidth', {\r\n      writable: true,\r\n      configurable: true,\r\n      value: 1920,\r\n    });\r\n    \r\n    window.matchMedia = jest.fn().mockImplementation(query => ({\r\n      matches: query.includes('min-width: 1024px'),\r\n      media: query,\r\n      onchange: null,\r\n      addListener: jest.fn(),\r\n      removeListener: jest.fn(),\r\n      addEventListener: jest.fn(),\r\n      removeEventListener: jest.fn(),\r\n      dispatchEvent: jest.fn(),\r\n    }));\r\n\r\n    const { asFragment } = render(<App />);\r\n    expect(asFragment()).toMatchSnapshot('app-desktop-layout');\r\n  });\r\n});\r\n\r\ndescribe('Critical UI Components Snapshots', () => {\r\n  test('MikiEditor 컴포넌트 스냅샷', async () => {\r\n    // MikiEditor가 별도로 테스트 가능한 경우\r\n    const MikiEditor = (await import('../MikiEditor')).default;\r\n    const { asFragment } = render(<MikiEditor />);\r\n    expect(asFragment()).toMatchSnapshot('miki-editor-component');\r\n  });\r\n\r\n  test('AiPanel 컴포넌트 스냅샷', async () => {\r\n    // AiPanel이 별도로 테스트 가능한 경우\r\n    const AiPanel = (await import('../AiPanel')).default;\r\n    const { asFragment } = render(<AiPanel />);\r\n    expect(asFragment()).toMatchSnapshot('ai-panel-component');\r\n  });\r\n}); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\components\\ErrorDisplay.test.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'ErrorTypes' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { render, screen, fireEvent } from '@testing-library/react';\r\nimport ErrorDisplay from '../../components/common/ErrorDisplay';\r\nimport { ErrorTypes } from '../../utils/errorHandler';\r\n\r\ndescribe('ErrorDisplay', () => {\r\n  const mockOnRetry = jest.fn();\r\n  const mockOnDismiss = jest.fn();\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('렌더링', () => {\r\n    test('에러가 없으면 아무것도 렌더링하지 않아야 함', () => {\r\n      const { container } = render(<ErrorDisplay error={null} />);\r\n      expect(container.firstChild).toBeNull();\r\n    });\r\n\r\n    test('네트워크 에러를 올바르게 렌더링해야 함', () => {\r\n      const networkError = new TypeError('Failed to fetch');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={networkError} \r\n          onRetry={mockOnRetry}\r\n          onDismiss={mockOnDismiss}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText('네트워크 연결 오류')).toBeInTheDocument();\r\n      expect(screen.getByText('인터넷 연결을 확인하고 다시 시도해주세요.')).toBeInTheDocument();\r\n      expect(screen.getByText('다시 시도')).toBeInTheDocument();\r\n      expect(screen.getByText('닫기')).toBeInTheDocument();\r\n    });\r\n\r\n    test('서버 에러를 올바르게 렌더링해야 함', () => {\r\n      const serverError = new Error('HTTP 500: Internal Server Error');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={serverError} \r\n          onRetry={mockOnRetry}\r\n          onDismiss={mockOnDismiss}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText('서버 오류')).toBeInTheDocument();\r\n      expect(screen.getByText('서버에 일시적인 문제가 발생했습니다. 잠시 후 다시 시도해주세요.')).toBeInTheDocument();\r\n    });\r\n\r\n    test('NOT_FOUND 에러를 올바르게 렌더링해야 함', () => {\r\n      const notFoundError = new Error('HTTP 404: Not Found');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={notFoundError} \r\n          onRetry={mockOnRetry}\r\n          onDismiss={mockOnDismiss}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText('문서를 찾을 수 없음')).toBeInTheDocument();\r\n      expect(screen.getByText('요청한 문서가 존재하지 않거나 삭제되었습니다.')).toBeInTheDocument();\r\n      expect(screen.queryByText('목록으로 돌아가기')).not.toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('컨텍스트별 메시지', () => {\r\n    test('save 컨텍스트에서 메시지가 커스터마이징되어야 함', () => {\r\n      const error = new Error('HTTP 500: Internal Server Error');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          context=\"save\"\r\n          onRetry={mockOnRetry}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText(/문서 저장 중/)).toBeInTheDocument();\r\n    });\r\n\r\n    test('load 컨텍스트에서 메시지가 커스터마이징되어야 함', () => {\r\n      const error = new Error('HTTP 500: Internal Server Error');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          context=\"load\"\r\n          onRetry={mockOnRetry}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText(/문서 불러오기 중/)).toBeInTheDocument();\r\n    });\r\n\r\n    test('delete 컨텍스트에서 메시지가 커스터마이징되어야 함', () => {\r\n      const error = new Error('HTTP 500: Internal Server Error');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          context=\"delete\"\r\n          onRetry={mockOnRetry}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText(/문서 삭제 중/)).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('크기 옵션', () => {\r\n    test('small 크기로 렌더링되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          size=\"small\"\r\n        />\r\n      );\r\n\r\n      const errorContainer = container.querySelector('.p-3');\r\n      expect(errorContainer).toBeInTheDocument();\r\n    });\r\n\r\n    test('large 크기로 렌더링되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          size=\"large\"\r\n        />\r\n      );\r\n\r\n      const errorContainer = container.querySelector('.p-6');\r\n      expect(errorContainer).toBeInTheDocument();\r\n    });\r\n\r\n    test('기본 크기로 렌더링되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          size=\"normal\"\r\n        />\r\n      );\r\n\r\n      const errorContainer = container.querySelector('.p-4');\r\n      expect(errorContainer).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('아이콘 표시', () => {\r\n    test('네트워크 에러에 대해 네트워크 아이콘을 표시해야 함', () => {\r\n      const networkError = new TypeError('Failed to fetch');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay error={networkError} />\r\n      );\r\n\r\n      const networkIcon = container.querySelector('svg.text-orange-500');\r\n      expect(networkIcon).toBeInTheDocument();\r\n    });\r\n\r\n    test('일반 에러에 대해 에러 아이콘을 표시해야 함', () => {\r\n      const generalError = new Error('General error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay error={generalError} />\r\n      );\r\n\r\n      const errorIcon = container.querySelector('svg.text-red-500');\r\n      expect(errorIcon).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('버튼 동작', () => {\r\n    test('재시도 버튼 클릭 시 onRetry가 호출되어야 함', () => {\r\n      const retryableError = new TypeError('Failed to fetch');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={retryableError} \r\n          onRetry={mockOnRetry}\r\n        />\r\n      );\r\n\r\n      const retryButton = screen.getByText('다시 시도');\r\n      fireEvent.click(retryButton);\r\n\r\n      expect(mockOnRetry).toHaveBeenCalledTimes(1);\r\n    });\r\n\r\n    test('닫기 버튼 클릭 시 onDismiss가 호출되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          onDismiss={mockOnDismiss}\r\n        />\r\n      );\r\n\r\n      const dismissButton = screen.getByText('닫기');\r\n      fireEvent.click(dismissButton);\r\n\r\n      expect(mockOnDismiss).toHaveBeenCalledTimes(1);\r\n    });\r\n\r\n    test('우상단 X 버튼 클릭 시 onDismiss가 호출되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          onDismiss={mockOnDismiss}\r\n        />\r\n      );\r\n\r\n      // X 버튼을 찾기 (SVG가 포함된 버튼)\r\n      const buttons = container.querySelectorAll('button');\r\n      const xButton = Array.from(buttons).find(button => \r\n        button.querySelector('svg') && !button.textContent.trim()\r\n      );\r\n      \r\n      expect(xButton).toBeTruthy();\r\n      fireEvent.click(xButton);\r\n      expect(mockOnDismiss).toHaveBeenCalledTimes(1);\r\n    });\r\n\r\n    test('재시도 불가능한 에러에서는 재시도 버튼이 표시되지 않아야 함', () => {\r\n      const notFoundError = new Error('HTTP 404: Not Found');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={notFoundError} \r\n          onRetry={mockOnRetry}\r\n        />\r\n      );\r\n\r\n      expect(screen.queryByText('다시 시도')).not.toBeInTheDocument();\r\n      expect(screen.queryByText('목록으로 돌아가기')).not.toBeInTheDocument();\r\n    });\r\n\r\n    test('onRetry가 없으면 재시도 버튼이 표시되지 않아야 함', () => {\r\n      const retryableError = new TypeError('Failed to fetch');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={retryableError} \r\n          // onRetry 없음\r\n        />\r\n      );\r\n\r\n      expect(screen.queryByText('다시 시도')).not.toBeInTheDocument();\r\n    });\r\n\r\n    test('onDismiss가 없으면 닫기 버튼들이 표시되지 않아야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          // onDismiss 없음\r\n        />\r\n      );\r\n\r\n      expect(screen.queryByText('닫기')).not.toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('개발자 정보', () => {\r\n    const originalEnv = process.env.NODE_ENV;\r\n\r\n    afterEach(() => {\r\n      process.env.NODE_ENV = originalEnv;\r\n    });\r\n\r\n    test('개발 환경에서 개발자 정보가 표시되어야 함', () => {\r\n      process.env.NODE_ENV = 'development';\r\n      \r\n      const error = new Error('Test error');\r\n      error.stack = 'Error: Test error\\n    at test.js:1:1';\r\n      \r\n      render(<ErrorDisplay error={error} />);\r\n\r\n      expect(screen.getByText('개발자 정보 (클릭하여 펼치기)')).toBeInTheDocument();\r\n    });\r\n\r\n    test('프로덕션 환경에서 개발자 정보가 표시되지 않아야 함', () => {\r\n      process.env.NODE_ENV = 'production';\r\n      \r\n      const error = new Error('Test error');\r\n      error.stack = 'Error: Test error\\n    at test.js:1:1';\r\n      \r\n      render(<ErrorDisplay error={error} />);\r\n\r\n      expect(screen.queryByText('개발자 정보 (클릭하여 펼치기)')).not.toBeInTheDocument();\r\n    });\r\n\r\n    test('개발자 정보 details 요소를 클릭하여 펼칠 수 있어야 함', () => {\r\n      process.env.NODE_ENV = 'development';\r\n      \r\n      const error = new Error('Test error');\r\n      error.stack = 'Error: Test error\\n    at test.js:1:1';\r\n      \r\n      render(<ErrorDisplay error={error} />);\r\n\r\n      const details = screen.getByText('개발자 정보 (클릭하여 펼치기)');\r\n      fireEvent.click(details);\r\n\r\n      // 정규식을 사용하여 줄바꿈과 공백을 무시하고 텍스트 매칭\r\n      expect(screen.getByText(/Test error/)).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('CSS 클래스', () => {\r\n    test('커스텀 className이 적용되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay \r\n          error={error} \r\n          className=\"custom-error-class\"\r\n        />\r\n      );\r\n\r\n      const errorContainer = container.querySelector('.custom-error-class');\r\n      expect(errorContainer).toBeInTheDocument();\r\n    });\r\n\r\n    test('기본 스타일 클래스들이 적용되어야 함', () => {\r\n      const error = new Error('Test error');\r\n      \r\n      const { container } = render(\r\n        <ErrorDisplay error={error} />\r\n      );\r\n\r\n      const errorContainer = container.querySelector('.bg-red-50.border.border-red-200.rounded-lg');\r\n      expect(errorContainer).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('접근성', () => {\r\n    test('버튼들이 적절한 포커스를 받을 수 있어야 함', () => {\r\n      const retryableError = new TypeError('Failed to fetch');\r\n      \r\n      render(\r\n        <ErrorDisplay \r\n          error={retryableError} \r\n          onRetry={mockOnRetry}\r\n          onDismiss={mockOnDismiss}\r\n        />\r\n      );\r\n\r\n      const retryButton = screen.getByText('다시 시도');\r\n      const dismissButton = screen.getByText('닫기');\r\n\r\n      expect(retryButton).toHaveClass('focus:outline-none', 'focus:ring-2');\r\n      expect(dismissButton).toHaveClass('focus:outline-none', 'focus:ring-2');\r\n    });\r\n  });\r\n}); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\hooks\\useAutoSave.test.js","messages":[{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":26,"column":10,"nodeType":"ArrowFunctionExpression","messageId":"noDisplayName","endLine":30,"endColumn":4},{"ruleId":"no-unused-vars","severity":1,"message":"'mockOnSaveStart' is assigned a value but never used.","line":34,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'mockOnSaveSuccess' is assigned a value but never used.","line":35,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'mockOnSaveError' is assigned a value but never used.","line":36,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { renderHook, act } from '@testing-library/react';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport useAutoSave from '../../hooks/useAutoSave';\r\n\r\n// useSaveDocument 훅 모킹\r\nconst mockMutateAsync = jest.fn();\r\n\r\njest.mock('../../hooks/useDocuments', () => ({\r\n  useSaveDocument: () => ({\r\n    mutateAsync: mockMutateAsync\r\n  })\r\n}));\r\n\r\n// 타이머 모킹\r\njest.useFakeTimers();\r\n\r\n// QueryClient 래퍼 생성\r\nconst createWrapper = () => {\r\n  const queryClient = new QueryClient({\r\n    defaultOptions: {\r\n      queries: { retry: false },\r\n      mutations: { retry: false }\r\n    }\r\n  });\r\n  \r\n  return ({ children }) => (\r\n    <QueryClientProvider client={queryClient}>\r\n      {children}\r\n    </QueryClientProvider>\r\n  );\r\n};\r\n\r\ndescribe('useAutoSave', () => {\r\n  let mockOnSaveStart;\r\n  let mockOnSaveSuccess;\r\n  let mockOnSaveError;\r\n\r\n  beforeEach(() => {\r\n    // 모킹된 함수들 초기화\r\n    mockMutateAsync.mockClear();\r\n    \r\n    mockOnSaveStart = jest.fn();\r\n    mockOnSaveSuccess = jest.fn();\r\n    mockOnSaveError = jest.fn();\r\n    \r\n    jest.clearAllTimers();\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('초기 상태', () => {\r\n    test('초기 상태가 올바르게 설정되어야 함', () => {\r\n      const { result } = renderHook(\r\n        () => useAutoSave({\r\n          document: null,\r\n          content: '',\r\n          title: '',\r\n          enabled: true\r\n        }),\r\n        { wrapper: createWrapper() }\r\n      );\r\n\r\n      expect(result.current.saveStatus).toBe('saved');\r\n      expect(result.current.hasUnsavedChanges).toBe(false);\r\n      expect(result.current.lastSaved).toBeNull();\r\n      expect(result.current.isAutoSaving).toBe(false);\r\n      expect(result.current.isManualSaving).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('변경사항 감지', () => {\r\n    test('내용 변경 시 unsaved 상태가 되어야 함', () => {\r\n      const testDocument = {\r\n        id: 'test-1',\r\n        title: '테스트 문서',\r\n        content: '초기 내용'\r\n      };\r\n\r\n      const { result, rerender } = renderHook(\r\n        ({ content }) => useAutoSave({\r\n          document: testDocument,\r\n          content,\r\n          title: '테스트 문서',\r\n          enabled: true\r\n        }),\r\n        { \r\n          wrapper: createWrapper(),\r\n          initialProps: { content: '초기 내용' }\r\n        }\r\n      );\r\n\r\n      expect(result.current.hasUnsavedChanges).toBe(false);\r\n\r\n      // 내용 변경\r\n      rerender({ content: '변경된 내용' });\r\n\r\n      expect(result.current.hasUnsavedChanges).toBe(true);\r\n      expect(result.current.saveStatus).toBe('pending');\r\n    });\r\n\r\n    test('제목 변경 시 unsaved 상태가 되어야 함', () => {\r\n      const testDocument = {\r\n        id: 'test-1',\r\n        title: '초기 제목',\r\n        content: '내용'\r\n      };\r\n\r\n      const { result, rerender } = renderHook(\r\n        ({ title }) => useAutoSave({\r\n          document: testDocument,\r\n          content: '내용',\r\n          title,\r\n          enabled: true\r\n        }),\r\n        { \r\n          wrapper: createWrapper(),\r\n          initialProps: { title: '초기 제목' }\r\n        }\r\n      );\r\n\r\n      expect(result.current.hasUnsavedChanges).toBe(false);\r\n\r\n      // 제목 변경\r\n      rerender({ title: '변경된 제목' });\r\n\r\n      expect(result.current.hasUnsavedChanges).toBe(true);\r\n      expect(result.current.saveStatus).toBe('pending');\r\n    });\r\n  });\r\n\r\n  describe('자동 저장', () => {\r\n    test('변경사항 감지가 정상 작동해야 함', () => {\r\n      const testDocument = {\r\n        id: 'test-1',\r\n        title: '테스트 문서',\r\n        content: '초기 내용'\r\n      };\r\n\r\n      const { result, rerender } = renderHook(\r\n        ({ content }) => useAutoSave({\r\n          document: testDocument,\r\n          content,\r\n          title: '테스트 문서',\r\n          enabled: true,\r\n          interval: 3000\r\n        }),\r\n        { \r\n          wrapper: createWrapper(),\r\n          initialProps: { content: '초기 내용' }\r\n        }\r\n      );\r\n\r\n      // 내용 변경\r\n      rerender({ content: '변경된 내용' });\r\n      expect(result.current.hasUnsavedChanges).toBe(true);\r\n      expect(result.current.saveStatus).toBe('pending');\r\n    });\r\n\r\n    test('자동 저장이 비활성화되면 저장되지 않아야 함', () => {\r\n      const testDocument = {\r\n        id: 'test-1',\r\n        title: '테스트 문서',\r\n        content: '초기 내용'\r\n      };\r\n\r\n      const { result, rerender } = renderHook(\r\n        ({ content }) => useAutoSave({\r\n          document: testDocument,\r\n          content,\r\n          title: '테스트 문서',\r\n          enabled: false, // 비활성화\r\n          interval: 3000\r\n        }),\r\n        { \r\n          wrapper: createWrapper(),\r\n          initialProps: { content: '초기 내용' }\r\n        }\r\n      );\r\n\r\n      // 내용 변경\r\n      rerender({ content: '변경된 내용' });\r\n      // enabled가 false이므로 hasUnsavedChanges는 여전히 true가 되지만 자동저장은 안됨\r\n      expect(result.current.hasUnsavedChanges).toBe(true);\r\n\r\n      // 3초 경과\r\n      act(() => {\r\n        jest.advanceTimersByTime(3000);\r\n      });\r\n\r\n      expect(mockMutateAsync).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('수동 저장', () => {\r\n    test('수동 저장 함수가 존재해야 함', () => {\r\n      const testDocument = {\r\n        id: 'test-1',\r\n        title: '테스트 문서',\r\n        content: '내용'\r\n      };\r\n\r\n      const { result } = renderHook(\r\n        () => useAutoSave({\r\n          document: testDocument,\r\n          content: '변경된 내용',\r\n          title: '테스트 문서',\r\n          enabled: true\r\n        }),\r\n        { wrapper: createWrapper() }\r\n      );\r\n\r\n      expect(typeof result.current.manualSave).toBe('function');\r\n    });\r\n  });\r\n\r\n  describe('저장 상태 메시지', () => {\r\n    test('저장 상태 메시지 함수가 존재해야 함', () => {\r\n      const { result } = renderHook(\r\n        () => useAutoSave({\r\n          document: { id: 'test' },\r\n          content: '내용',\r\n          title: '제목',\r\n          enabled: true\r\n        }),\r\n        { wrapper: createWrapper() }\r\n      );\r\n\r\n      expect(typeof result.current.getSaveStatusMessage).toBe('function');\r\n      expect(result.current.getSaveStatusMessage()).toBe('저장됨');\r\n    });\r\n  });\r\n\r\n  describe('페이지 이탈 경고', () => {\r\n    test('beforeunload 이벤트 리스너 관련 기능이 작동해야 함', () => {\r\n      const { unmount } = renderHook(\r\n        () => useAutoSave({\r\n          document: { id: 'test' },\r\n          content: '내용',\r\n          title: '제목',\r\n          enabled: true\r\n        }),\r\n        { wrapper: createWrapper() }\r\n      );\r\n\r\n      // 컴포넌트가 정상적으로 마운트되고 언마운트되는지 확인\r\n      expect(() => unmount()).not.toThrow();\r\n    });\r\n  });\r\n}); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\hooks\\useKeyboardShortcuts.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\integration\\documentFlow.test.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'waitFor' is defined but never used.","line":2,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'userEvent' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":17},{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":10,"column":10,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":21,"endColumn":5},{"ruleId":"no-unused-vars","severity":1,"message":"'queryClient' is assigned a value but never used.","line":67,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { render, screen, waitFor, act } from '@testing-library/react';\r\nimport userEvent from '@testing-library/user-event';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport App from '../../App';\r\n\r\n// Toast UI Editor 관련 DOM 에러를 방지하기 위한 모킹\r\njest.mock('../../MikiEditor', () => {\r\n  const React = require('react');\r\n  return React.forwardRef((props, ref) => {\r\n    React.useImperativeHandle(ref, () => ({\r\n      getEditorInstance: () => ({\r\n        setMarkdown: jest.fn(),\r\n        getMarkdown: () => 'Test content'\r\n      })\r\n    }));\r\n\r\n    return React.createElement('div', {\r\n      'data-testid': 'miki-editor'\r\n    }, React.createElement('div', null, 'Mocked Editor'));\r\n  });\r\n});\r\n\r\n// Mock modules - 실제 존재하는 모듈들만 모킹\r\njest.mock('../../hooks/useAutoSave', () => ({\r\n  __esModule: true,\r\n  default: jest.fn(() => ({\r\n    saveStatus: 'saved',\r\n    hasUnsavedChanges: false,\r\n    lastSaved: null,\r\n    manualSave: jest.fn(),\r\n    getSaveStatusMessage: jest.fn(() => '저장됨'),\r\n    isAutoSaving: false,\r\n    isManualSaving: false,\r\n  })),\r\n}));\r\n\r\njest.mock('../../hooks/useKeyboardShortcuts', () => ({\r\n  __esModule: true,\r\n  default: jest.fn(() => ({})),\r\n}));\r\n\r\n// 테스트용 QueryClient 생성\r\nconst createTestQueryClient = () => new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      retry: false,\r\n      cacheTime: 0,\r\n    },\r\n    mutations: {\r\n      retry: false,\r\n    },\r\n  },\r\n});\r\n\r\n// 테스트 래퍼 컴포넌트\r\nconst TestWrapper = ({ children }) => {\r\n  const queryClient = createTestQueryClient();\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      {children}\r\n    </QueryClientProvider>\r\n  );\r\n};\r\n\r\ndescribe('문서 플로우 통합 테스트', () => {\r\n  let queryClient;\r\n\r\n  beforeEach(() => {\r\n    queryClient = createTestQueryClient();\r\n    jest.clearAllMocks();\r\n    jest.useFakeTimers();\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.runOnlyPendingTimers();\r\n    jest.useRealTimers();\r\n  });\r\n\r\n  describe('기본 앱 렌더링', () => {\r\n    test('앱이 정상적으로 렌더링되어야 함', async () => {\r\n      render(\r\n        <TestWrapper>\r\n          <App />\r\n        </TestWrapper>\r\n      );\r\n\r\n      // 헤더 확인\r\n      expect(screen.getByText('Miki Editor v7 AI 연동')).toBeInTheDocument();\r\n      \r\n      // 로딩이 완료될 때까지 대기\r\n      await act(async () => {\r\n        jest.advanceTimersByTime(1000);\r\n      });\r\n    });\r\n\r\n    test('기본 UI 요소들이 렌더링되어야 함', async () => {\r\n      render(\r\n        <TestWrapper>\r\n          <App />\r\n        </TestWrapper>\r\n      );\r\n\r\n      // 기본 레이아웃 요소들 확인\r\n      expect(screen.getByText('Miki Editor v7 AI 연동')).toBeInTheDocument();\r\n      \r\n      await act(async () => {\r\n        jest.advanceTimersByTime(1000);\r\n      });\r\n\r\n      // 앱이 크래시하지 않고 정상적으로 렌더링되는지 확인\r\n      expect(document.body).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('훅 통합 테스트', () => {\r\n    test('모든 훅이 정상적으로 작동해야 함', async () => {\r\n      const useAutoSave = require('../../hooks/useAutoSave').default;\r\n      const useKeyboardShortcuts = require('../../hooks/useKeyboardShortcuts').default;\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <App />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await act(async () => {\r\n        jest.advanceTimersByTime(1000);\r\n      });\r\n\r\n      // 훅들이 호출되었는지 확인\r\n      expect(useAutoSave).toHaveBeenCalled();\r\n      expect(useKeyboardShortcuts).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('에러 처리', () => {\r\n    test('앱이 에러 없이 렌더링되어야 함', async () => {\r\n      // 콘솔 에러를 캐치하여 예상치 못한 에러가 없는지 확인\r\n      const consoleSpy = jest.spyOn(console, 'error').mockImplementation(() => {});\r\n      \r\n      render(\r\n        <TestWrapper>\r\n          <App />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await act(async () => {\r\n        jest.advanceTimersByTime(2000);\r\n      });\r\n\r\n      // 기본 렌더링이 성공했는지 확인\r\n      expect(screen.getByText('Miki Editor v7 AI 연동')).toBeInTheDocument();\r\n      \r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n\r\n  describe('반응형 레이아웃', () => {\r\n    test('기본 레이아웃이 표시되어야 함', async () => {\r\n      render(\r\n        <TestWrapper>\r\n          <App />\r\n        </TestWrapper>\r\n      );\r\n\r\n      await act(async () => {\r\n        jest.advanceTimersByTime(1000);\r\n      });\r\n\r\n      // 기본 레이아웃 확인\r\n      expect(screen.getByText('Miki Editor v7 AI 연동')).toBeInTheDocument();\r\n    });\r\n  });\r\n}); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\stores\\documentStore.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\__tests__\\utils\\errorHandler.test.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":11,"column":30,"nodeType":"MemberExpression","messageId":"unexpected","endLine":11,"endColumn":43},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":13,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":13,"endColumn":16},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":17,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":17,"endColumn":16},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":127,"column":14,"nodeType":"MemberExpression","messageId":"unexpected","endLine":127,"endColumn":27},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":150,"column":14,"nodeType":"MemberExpression","messageId":"unexpected","endLine":150,"endColumn":27},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":211,"column":14,"nodeType":"MemberExpression","messageId":"unexpected","endLine":211,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  ErrorTypes,\r\n  classifyError,\r\n  getErrorMessage,\r\n  logError,\r\n  isRetryableError,\r\n  isOfflineError\r\n} from '../../utils/errorHandler';\r\n\r\n// 콘솔 에러 모킹\r\nconst originalConsoleError = console.error;\r\nbeforeEach(() => {\r\n  console.error = jest.fn();\r\n});\r\n\r\nafterEach(() => {\r\n  console.error = originalConsoleError;\r\n});\r\n\r\ndescribe('ErrorHandler', () => {\r\n  describe('ErrorTypes', () => {\r\n    test('모든 에러 타입이 정의되어 있어야 함', () => {\r\n      expect(ErrorTypes.NETWORK_ERROR).toBe('NETWORK_ERROR');\r\n      expect(ErrorTypes.SERVER_ERROR).toBe('SERVER_ERROR');\r\n      expect(ErrorTypes.NOT_FOUND).toBe('NOT_FOUND');\r\n      expect(ErrorTypes.VALIDATION_ERROR).toBe('VALIDATION_ERROR');\r\n      expect(ErrorTypes.UNKNOWN_ERROR).toBe('UNKNOWN_ERROR');\r\n    });\r\n  });\r\n\r\n  describe('classifyError', () => {\r\n    test('null/undefined 에러는 UNKNOWN_ERROR로 분류되어야 함', () => {\r\n      expect(classifyError(null)).toBe(ErrorTypes.UNKNOWN_ERROR);\r\n      expect(classifyError(undefined)).toBe(ErrorTypes.UNKNOWN_ERROR);\r\n    });\r\n\r\n    test('네트워크 에러를 올바르게 분류해야 함', () => {\r\n      const networkError = new TypeError('Failed to fetch');\r\n      expect(classifyError(networkError)).toBe(ErrorTypes.NETWORK_ERROR);\r\n    });\r\n\r\n    test('HTTP 404 에러를 NOT_FOUND로 분류해야 함', () => {\r\n      const notFoundError = new Error('HTTP 404: Not Found');\r\n      expect(classifyError(notFoundError)).toBe(ErrorTypes.NOT_FOUND);\r\n    });\r\n\r\n    test('HTTP 4xx 에러를 VALIDATION_ERROR로 분류해야 함', () => {\r\n      const validationError = new Error('HTTP 400: Bad Request');\r\n      expect(classifyError(validationError)).toBe(ErrorTypes.VALIDATION_ERROR);\r\n      \r\n      const unauthorizedError = new Error('HTTP 401: Unauthorized');\r\n      expect(classifyError(unauthorizedError)).toBe(ErrorTypes.VALIDATION_ERROR);\r\n    });\r\n\r\n    test('HTTP 5xx 에러를 SERVER_ERROR로 분류해야 함', () => {\r\n      const serverError = new Error('HTTP 500: Internal Server Error');\r\n      expect(classifyError(serverError)).toBe(ErrorTypes.SERVER_ERROR);\r\n      \r\n      const badGatewayError = new Error('HTTP 502: Bad Gateway');\r\n      expect(classifyError(badGatewayError)).toBe(ErrorTypes.SERVER_ERROR);\r\n    });\r\n\r\n    test('특정 메시지 패턴을 올바르게 분류해야 함', () => {\r\n      const notFoundError = new Error('문서를 찾을 수 없습니다');\r\n      expect(classifyError(notFoundError)).toBe(ErrorTypes.NOT_FOUND);\r\n    });\r\n\r\n    test('알 수 없는 에러는 UNKNOWN_ERROR로 분류되어야 함', () => {\r\n      const unknownError = new Error('Something went wrong');\r\n      expect(classifyError(unknownError)).toBe(ErrorTypes.UNKNOWN_ERROR);\r\n    });\r\n  });\r\n\r\n  describe('getErrorMessage', () => {\r\n    test('네트워크 에러에 대한 메시지를 반환해야 함', () => {\r\n      const networkError = new TypeError('Failed to fetch');\r\n      const errorMessage = getErrorMessage(networkError);\r\n\r\n      expect(errorMessage.title).toBe('네트워크 연결 오류');\r\n      expect(errorMessage.message).toBe('인터넷 연결을 확인하고 다시 시도해주세요.');\r\n      expect(errorMessage.action).toBe('다시 시도');\r\n      expect(errorMessage.canRetry).toBe(true);\r\n      expect(errorMessage.originalError).toBe(networkError);\r\n      expect(errorMessage.timestamp).toBeDefined();\r\n    });\r\n\r\n    test('서버 에러에 대한 메시지를 반환해야 함', () => {\r\n      const serverError = new Error('HTTP 500: Internal Server Error');\r\n      const errorMessage = getErrorMessage(serverError);\r\n\r\n      expect(errorMessage.title).toBe('서버 오류');\r\n      expect(errorMessage.message).toBe('서버에 일시적인 문제가 발생했습니다. 잠시 후 다시 시도해주세요.');\r\n      expect(errorMessage.canRetry).toBe(true);\r\n    });\r\n\r\n    test('NOT_FOUND 에러에 대한 메시지를 반환해야 함', () => {\r\n      const notFoundError = new Error('HTTP 404: Not Found');\r\n      const errorMessage = getErrorMessage(notFoundError);\r\n\r\n      expect(errorMessage.title).toBe('문서를 찾을 수 없음');\r\n      expect(errorMessage.message).toBe('요청한 문서가 존재하지 않거나 삭제되었습니다.');\r\n      expect(errorMessage.canRetry).toBe(false);\r\n    });\r\n\r\n    test('컨텍스트별 메시지 커스터마이징이 작동해야 함', () => {\r\n      const error = new Error('HTTP 500: Internal Server Error');\r\n      \r\n      const saveErrorMessage = getErrorMessage(error, 'save');\r\n      expect(saveErrorMessage.message).toContain('문서 저장 중');\r\n      \r\n      const loadErrorMessage = getErrorMessage(error, 'load');\r\n      expect(loadErrorMessage.message).toContain('문서 불러오기 중');\r\n      \r\n      const deleteErrorMessage = getErrorMessage(error, 'delete');\r\n      expect(deleteErrorMessage.message).toContain('문서 삭제 중');\r\n    });\r\n  });\r\n\r\n  describe('logError', () => {\r\n    test('개발 환경에서 콘솔에 에러를 로깅해야 함', () => {\r\n      const originalEnv = process.env.NODE_ENV;\r\n      process.env.NODE_ENV = 'development';\r\n\r\n      const testError = new Error('테스트 에러');\r\n      const logData = logError(testError, 'test', { extra: 'info' });\r\n\r\n      expect(console.error).toHaveBeenCalledWith('🚨 Error logged:', expect.objectContaining({\r\n        title: expect.any(String),\r\n        message: expect.any(String),\r\n        context: 'test',\r\n        additionalInfo: { extra: 'info' },\r\n        userAgent: expect.any(String),\r\n        url: expect.any(String),\r\n        timestamp: expect.any(String)\r\n      }));\r\n\r\n      expect(logData.context).toBe('test');\r\n      expect(logData.additionalInfo).toEqual({ extra: 'info' });\r\n\r\n      process.env.NODE_ENV = originalEnv;\r\n    });\r\n\r\n    test('프로덕션 환경에서는 콘솔 로깅을 하지 않아야 함', () => {\r\n      const originalEnv = process.env.NODE_ENV;\r\n      process.env.NODE_ENV = 'production';\r\n\r\n      const testError = new Error('테스트 에러');\r\n      logError(testError);\r\n\r\n      expect(console.error).not.toHaveBeenCalled();\r\n\r\n      process.env.NODE_ENV = originalEnv;\r\n    });\r\n  });\r\n\r\n  describe('isRetryableError', () => {\r\n    test('재시도 가능한 에러를 올바르게 판단해야 함', () => {\r\n      const networkError = new TypeError('Failed to fetch');\r\n      expect(isRetryableError(networkError)).toBe(true);\r\n\r\n      const serverError = new Error('HTTP 500: Internal Server Error');\r\n      expect(isRetryableError(serverError)).toBe(true);\r\n\r\n      const unknownError = new Error('Something went wrong');\r\n      expect(isRetryableError(unknownError)).toBe(true);\r\n    });\r\n\r\n    test('재시도 불가능한 에러를 올바르게 판단해야 함', () => {\r\n      const notFoundError = new Error('HTTP 404: Not Found');\r\n      expect(isRetryableError(notFoundError)).toBe(false);\r\n\r\n      const validationError = new Error('HTTP 400: Bad Request');\r\n      expect(isRetryableError(validationError)).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('isOfflineError', () => {\r\n    test('오프라인 에러를 올바르게 판단해야 함', () => {\r\n      const networkError = new TypeError('Failed to fetch');\r\n      expect(isOfflineError(networkError)).toBe(true);\r\n\r\n      const serverError = new Error('HTTP 500: Internal Server Error');\r\n      expect(isOfflineError(serverError)).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('통합 시나리오', () => {\r\n    test('전체 에러 처리 플로우가 정상 작동해야 함', () => {\r\n      const originalEnv = process.env.NODE_ENV;\r\n      process.env.NODE_ENV = 'development';\r\n\r\n      // 1. 네트워크 에러 발생\r\n      const networkError = new TypeError('Failed to fetch');\r\n      \r\n      // 2. 에러 분류\r\n      const errorType = classifyError(networkError);\r\n      expect(errorType).toBe(ErrorTypes.NETWORK_ERROR);\r\n      \r\n      // 3. 사용자 친화적 메시지 생성\r\n      const errorMessage = getErrorMessage(networkError, 'save');\r\n      expect(errorMessage.title).toBe('네트워크 연결 오류');\r\n      expect(errorMessage.message).toContain('문서 저장 중');\r\n      expect(errorMessage.canRetry).toBe(true);\r\n      \r\n      // 4. 재시도 가능 여부 확인\r\n      expect(isRetryableError(networkError)).toBe(true);\r\n      expect(isOfflineError(networkError)).toBe(true);\r\n      \r\n      // 5. 에러 로깅\r\n      const logData = logError(networkError, 'save', { documentId: 'test-123' });\r\n      expect(console.error).toHaveBeenCalled();\r\n      expect(logData.context).toBe('save');\r\n      expect(logData.additionalInfo.documentId).toBe('test-123');\r\n\r\n      process.env.NODE_ENV = originalEnv;\r\n    });\r\n  });\r\n}); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\aiUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\api\\aiService.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":48,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":48,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1243,1290],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":96,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":96,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2617,2664],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":201,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":201,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5212,5248],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// aiService.js - Claude API 연동 서비스\n\n// API 키 환경 변수 또는 기본값 사용 (실제 배포 시에는 환경 변수 사용 권장)\n// !!! 실제 API 키를 코드에 하드코딩하지 마세요. 이것은 테스트용입니다. !!!\nconst API_KEY = process.env.CLAUDE_API_KEY || '';\n\n// 미키 에디터를 위한 Claude 프롬프트 템플릿\nconst SYSTEM_PROMPT = `당신은 미키 에디터(Miki Editor)의 AI 어시스턴트입니다.\n사용자의 마크다운 문서 편집을 도와주는 역할을 합니다.\n사용자의 명령을 이해하고 문서 편집 작업을 수행하거나 제안해야 합니다.\n\n명령이 문서 편집 관련이면(예: \"이 텍스트를 굵게 해줘\", \"표 만들어줘\" 등), JSON 형식으로 응답하여 에디터가 처리할 수 있도록 합니다.\n문서 내용에 대한 질문이면 일반 텍스트로 응답합니다.\n\n응답 형식:\n1. 편집 명령인 경우: \n\\`\\`\\`json\n{\n  \"isSuggestion\": true,\n  \"suggestionId\": \"고유ID\",\n  \"suggestionType\": \"user_command_transform\",\n  \"displayText\": \"사용자에게 표시할 제안 메시지\",\n  \"actions\": [\n    {\n      \"actionType\": \"작업유형(replace_content, apply_style 등)\",\n      \"commandType\": \"명령유형(bold, list_ul 등)\",\n      \"range\": \"selection\",\n      \"content\": \"내용\"\n    }\n  ]\n}\n\\`\\`\\`\n\n2. 일반 질문인 경우: 일반 텍스트로 응답`;\n\n/**\n * Claude API에 메시지를 전송하고 응답을 받는 함수\n * @param {string} userPrompt - 사용자 입력 메시지\n * @param {Object} context - 에디터 컨텍스트 (현재 문서 내용, 선택 영역 등)\n * @returns {Promise<string>} - AI 응답\n */\nexport const sendMessageToClaude = async (userPrompt, context = {}) => {\n  const { fullContent = '', selection = null } = context;\n  \n  try {\n    // API 키가 설정되지 않은 경우 시뮬레이션 모드 사용\n    if (!API_KEY) {\n      console.log('API 키가 설정되지 않아 시뮬레이션 모드로 응답합니다.');\n      return simulateClaudeResponse(userPrompt, context);\n    }\n    \n    // 컨텍스트 정보 포함한 프롬프트 구성\n    let contextInfo = `현재 문서 내용:\\n\\`\\`\\`markdown\\n${fullContent}\\n\\`\\`\\`\\n\\n`;\n    \n    if (selection && selection.text) {\n      contextInfo += `선택된 텍스트: \"${selection.text}\"\\n`;\n      if (selection.range) {\n        contextInfo += `선택 범위: ${JSON.stringify(selection.range)}\\n`;\n      }\n    }\n    \n    // Claude API 요청 설정\n    const response = await fetch('https://api.anthropic.com/v1/messages', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'x-api-key': API_KEY,\n        'anthropic-version': '2023-06-01'\n      },\n      body: JSON.stringify({\n        model: 'claude-3-5-haiku-20241022',  // Claude 3.5 Haiku 모델로 변경\n        max_tokens: 4000,\n        messages: [\n          {\n            role: 'system',\n            content: SYSTEM_PROMPT\n          },\n          {\n            role: 'user',\n            content: `${contextInfo}\\n\\n사용자 명령/질문: ${userPrompt}`\n          }\n        ]\n      })\n    });\n\n    // 응답 처리\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(`API 오류: ${response.status} - ${errorData.error?.message || '알 수 없는 오류'}`);\n    }\n\n    const data = await response.json();\n    return data.content[0].text;\n    \n  } catch (error) {\n    console.error('Claude API 호출 중 오류 발생:', error);\n    return `오류가 발생했습니다: ${error.message}. 잠시 후 다시 시도해주세요.`;\n  }\n};\n\n/**\n * API 키가 없을 때 사용할 시뮬레이션 응답 생성기\n * @param {string} userPrompt - 사용자 입력 메시지\n * @param {Object} context - 에디터 컨텍스트\n * @returns {string} - 시뮬레이션된 AI 응답\n */\nfunction simulateClaudeResponse(userPrompt, context) {\n  const { selection } = context;\n  const prompt = userPrompt.toLowerCase();\n  \n  // 굵게 만들기 명령 시뮬레이션\n  if (prompt.includes('굵게') && selection && selection.text) {\n    return `\\`\\`\\`json\n{\n  \"isSuggestion\": true,\n  \"suggestionId\": \"sim-bold-${Date.now()}\",\n  \"suggestionType\": \"user_command_transform\",\n  \"displayText\": \"선택한 텍스트를 굵게 만들까요?\",\n  \"actions\": [\n    {\n      \"actionType\": \"apply_style\",\n      \"commandType\": \"bold\",\n      \"range\": \"selection\",\n      \"targetText\": \"${selection.text}\"\n    }\n  ]\n}\n\\`\\`\\``;\n  }\n  \n  // 목록 만들기 명령 시뮬레이션\n  if (prompt.includes('목록') || prompt.includes('리스트')) {\n    return `\\`\\`\\`json\n{\n  \"isSuggestion\": true,\n  \"suggestionId\": \"sim-list-${Date.now()}\",\n  \"suggestionType\": \"user_command_transform\",\n  \"displayText\": \"순서 없는 목록을 생성할까요?\",\n  \"actions\": [\n    {\n      \"actionType\": \"create_element\",\n      \"commandType\": \"list_ul\",\n      \"range\": \"cursor\",\n      \"content\": {\n        \"items\": [\"첫 번째 항목\", \"두 번째 항목\", \"세 번째 항목\"]\n      }\n    }\n  ]\n}\n\\`\\`\\``;\n  }\n  \n  // 표 만들기 명령 시뮬레이션\n  if (prompt.includes('표')) {\n    return `\\`\\`\\`json\n{\n  \"isSuggestion\": true,\n  \"suggestionId\": \"sim-table-${Date.now()}\",\n  \"suggestionType\": \"clarification_needed\",\n  \"displayText\": \"표를 만들려면 크기를 지정해 주세요.\",\n  \"clarificationDetails\": {\n    \"query\": \"몇 행 몇 열의 표를 만들까요?\",\n    \"options\": [\n      { \"label\": \"2x2 표\", \"value\": \"2x2\" },\n      { \"label\": \"3x3 표\", \"value\": \"3x3\" },\n      { \"label\": \"2x3 표\", \"value\": \"2x3\" }\n    ]\n  }\n}\n\\`\\`\\``;\n  }\n  \n  // 일반 질문에 대한 응답\n  return `안녕하세요! \"${userPrompt}\"에 대한 응답입니다. 현재 시뮬레이션 모드로 작동 중입니다. API 키를 설정하면 실제 Claude AI로 더 정확한 응답을 얻을 수 있습니다.`;\n}\n\n/**\n * AI 응답에서 JSON 부분을 추출하는 함수\n * @param {string} aiResponse - AI의 응답 텍스트\n * @returns {Object|null} - 파싱된 JSON 객체 또는 null\n */\nexport const extractJsonFromResponse = (aiResponse) => {\n  try {\n    // JSON 코드 블록 찾기\n    const jsonRegex = /```json\\s*([\\s\\S]*?)\\s*```/;\n    const match = aiResponse.match(jsonRegex);\n    \n    if (match && match[1]) {\n      // JSON 문자열에서 실제 JSON 객체 파싱\n      return JSON.parse(match[1]);\n    }\n    \n    // 전체 텍스트가 JSON인지 확인\n    const trimmedResponse = aiResponse.trim();\n    if (trimmedResponse.startsWith('{') && trimmedResponse.endsWith('}')) {\n      return JSON.parse(trimmedResponse);\n    }\n    \n    return null;\n  } catch (error) {\n    console.error('JSON 파싱 오류:', error);\n    return null;\n  }\n}; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\ai\\AiPanelContainer.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport AiPanel from '../../AiPanel';\r\n\r\nconst AiPanelContainer = ({\r\n  isMobile,\r\n  activeMobilePanel,\r\n  setActiveMobilePanel,\r\n  aiPanelRef,\r\n  editorContext,\r\n  onStructuredCommand,\r\n  onDisplaySuggestion\r\n}) => {\r\n  return (\r\n    <div \r\n      className={`bg-white rounded shadow overflow-hidden flex flex-col ${\r\n        isMobile ? (activeMobilePanel === 'ai' ? 'block' : 'hidden') + ' flex-grow' : 'w-1/4 ml-2'\r\n      }`}\r\n      style={{ \r\n        display: isMobile && activeMobilePanel !== 'ai' ? 'none' : 'flex',\r\n        flexDirection: 'column', \r\n        height: '100%',\r\n        position: 'relative'\r\n      }}\r\n    >\r\n      {/* AI 패널 헤더 */}\r\n      <div className=\"p-3 border-b flex justify-between items-center\" style={{ flexShrink: 0 }}>\r\n        <h2 className=\"text-lg font-bold\">AI 패널</h2>\r\n        {isMobile && (\r\n          <button \r\n            onClick={() => setActiveMobilePanel('editor')}\r\n            className=\"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 rounded flex items-center\"\r\n            title=\"에디터로 이동\"\r\n          >\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n            </svg>\r\n            에디터\r\n          </button>\r\n        )}\r\n      </div>\r\n      \r\n      {/* AI 패널 내용 */}\r\n      <div className=\"flex-grow relative\">\r\n        <AiPanel\r\n          ref={aiPanelRef}\r\n          key=\"ai-panel-fixed-key\" // 고정 키 값을 사용하여 컴포넌트 재생성 방지\r\n          editorContext={editorContext}\r\n          onStructuredCommand={onStructuredCommand}\r\n          onDisplaySuggestion={onDisplaySuggestion}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AiPanelContainer; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\common\\ErrorBoundary.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":9,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":40},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":16,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":16,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[380,446],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n\r\nclass ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hasError: false, error: null, errorInfo: null };\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    // 다음 렌더링에서 폴백 UI가 보이도록 상태를 업데이트합니다.\r\n    return { hasError: true };\r\n  }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    // 에러 로깅\r\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\r\n    \r\n    this.setState({\r\n      error: error,\r\n      errorInfo: errorInfo\r\n    });\r\n\r\n    // 프로덕션에서는 에러 리포팅 서비스로 전송\r\n    if ((typeof process !== 'undefined' && process.env?.NODE_ENV === 'production') || false) {\r\n      // TODO: Sentry.captureException(error, { extra: errorInfo });\r\n    }\r\n  }\r\n\r\n  handleReload = () => {\r\n    // 앱 상태 초기화 및 새로고침\r\n    window.location.reload();\r\n  };\r\n\r\n  handleReset = () => {\r\n    // 에러 상태만 리셋하여 앱 복구 시도\r\n    this.setState({ hasError: false, error: null, errorInfo: null });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\r\n          <div className=\"max-w-md w-full bg-white rounded-lg shadow-lg p-6\">\r\n            <div className=\"flex items-center mb-4\">\r\n              <svg className=\"w-8 h-8 text-red-500 mr-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 15.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n              </svg>\r\n              <h1 className=\"text-xl font-bold text-gray-900\">앱 오류 발생</h1>\r\n            </div>\r\n            \r\n            <p className=\"text-gray-600 mb-6\">\r\n              예상치 못한 오류가 발생했습니다. 아래 버튼을 클릭하여 앱을 복구해보세요.\r\n            </p>\r\n\r\n            <div className=\"space-y-3\">\r\n              <button\r\n                onClick={this.handleReset}\r\n                className=\"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\r\n              >\r\n                앱 복구 시도\r\n              </button>\r\n              \r\n              <button\r\n                onClick={this.handleReload}\r\n                className=\"w-full px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors\"\r\n              >\r\n                페이지 새로고침\r\n              </button>\r\n            </div>\r\n\r\n            {/* 개발 환경에서만 상세 에러 정보 표시 */}\r\n            {((typeof process !== 'undefined' && process.env?.NODE_ENV === 'development') || false) && this.state.error && (\r\n              <details className=\"mt-6 p-4 bg-gray-100 rounded\">\r\n                <summary className=\"cursor-pointer font-medium text-gray-700 mb-2\">\r\n                  개발자 정보 (클릭하여 펼치기)\r\n                </summary>\r\n                <div className=\"text-sm text-gray-600 space-y-2\">\r\n                  <div>\r\n                    <strong>에러:</strong>\r\n                    <pre className=\"mt-1 p-2 bg-red-50 text-red-700 rounded text-xs overflow-auto\">\r\n                      {this.state.error.toString()}\r\n                    </pre>\r\n                  </div>\r\n                  <div>\r\n                    <strong>스택 트레이스:</strong>\r\n                    <pre className=\"mt-1 p-2 bg-red-50 text-red-700 rounded text-xs overflow-auto\">\r\n                      {this.state.errorInfo.componentStack}\r\n                    </pre>\r\n                  </div>\r\n                </div>\r\n              </details>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default ErrorBoundary; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\common\\ErrorDisplay.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { getErrorMessage, isRetryableError } from '../../utils/errorHandler';\r\n\r\nconst ErrorDisplay = ({ \r\n  error, \r\n  context = '', \r\n  onRetry, \r\n  onDismiss,\r\n  className = '',\r\n  size = 'normal' // 'small', 'normal', 'large'\r\n}) => {\r\n  if (!error) return null;\r\n\r\n  const errorInfo = getErrorMessage(error, context);\r\n  const canRetry = isRetryableError(error);\r\n\r\n  const getSizeClasses = () => {\r\n    switch (size) {\r\n      case 'small':\r\n        return {\r\n          container: 'p-3',\r\n          icon: 'w-5 h-5',\r\n          title: 'text-sm font-medium',\r\n          message: 'text-xs',\r\n          button: 'px-2 py-1 text-xs',\r\n        };\r\n      case 'large':\r\n        return {\r\n          container: 'p-6',\r\n          icon: 'w-8 h-8',\r\n          title: 'text-xl font-bold',\r\n          message: 'text-base',\r\n          button: 'px-4 py-2 text-base',\r\n        };\r\n      default:\r\n        return {\r\n          container: 'p-4',\r\n          icon: 'w-6 h-6',\r\n          title: 'text-lg font-semibold',\r\n          message: 'text-sm',\r\n          button: 'px-3 py-2 text-sm',\r\n        };\r\n    }\r\n  };\r\n\r\n  const sizeClasses = getSizeClasses();\r\n\r\n  const getErrorIcon = () => {\r\n    return (\r\n      <svg \r\n        className={`${sizeClasses.icon} text-red-500 flex-shrink-0`} \r\n        fill=\"none\" \r\n        viewBox=\"0 0 24 24\" \r\n        stroke=\"currentColor\"\r\n      >\r\n        <path \r\n          strokeLinecap=\"round\" \r\n          strokeLinejoin=\"round\" \r\n          strokeWidth={2} \r\n          d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 15.5c-.77.833.192 2.5 1.732 2.5z\" \r\n        />\r\n      </svg>\r\n    );\r\n  };\r\n\r\n  const getNetworkIcon = () => {\r\n    return (\r\n      <svg \r\n        className={`${sizeClasses.icon} text-orange-500 flex-shrink-0`} \r\n        fill=\"none\" \r\n        viewBox=\"0 0 24 24\" \r\n        stroke=\"currentColor\"\r\n      >\r\n        <path \r\n          strokeLinecap=\"round\" \r\n          strokeLinejoin=\"round\" \r\n          strokeWidth={2} \r\n          d=\"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0\" \r\n        />\r\n      </svg>\r\n    );\r\n  };\r\n\r\n  const isNetworkError = error.name === 'TypeError' && error.message.includes('fetch');\r\n\r\n  return (\r\n    <div className={`bg-red-50 border border-red-200 rounded-lg ${sizeClasses.container} ${className}`}>\r\n      <div className=\"flex items-start\">\r\n        <div className=\"mr-3\">\r\n          {isNetworkError ? getNetworkIcon() : getErrorIcon()}\r\n        </div>\r\n        \r\n        <div className=\"flex-1 min-w-0\">\r\n          <h3 className={`${sizeClasses.title} text-red-800 mb-1`}>\r\n            {errorInfo.title}\r\n          </h3>\r\n          \r\n          <p className={`${sizeClasses.message} text-red-700 mb-3`}>\r\n            {errorInfo.message}\r\n          </p>\r\n\r\n          {/* 개발 환경에서만 상세 에러 정보 표시 */}\r\n          {process.env.NODE_ENV === 'development' && (\r\n            <details className=\"mb-3\">\r\n              <summary className=\"cursor-pointer text-xs text-red-600 hover:text-red-800\">\r\n                개발자 정보 (클릭하여 펼치기)\r\n              </summary>\r\n              <pre className=\"mt-2 p-2 bg-red-100 text-red-800 text-xs rounded overflow-auto\">\r\n                {error.stack || error.message}\r\n              </pre>\r\n            </details>\r\n          )}\r\n\r\n          <div className=\"flex items-center space-x-2\">\r\n            {/* 재시도 버튼 */}\r\n            {canRetry && onRetry && (\r\n              <button\r\n                onClick={onRetry}\r\n                className={`${sizeClasses.button} bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors`}\r\n              >\r\n                {errorInfo.action}\r\n              </button>\r\n            )}\r\n\r\n            {/* 닫기 버튼 */}\r\n            {onDismiss && (\r\n              <button\r\n                onClick={onDismiss}\r\n                className={`${sizeClasses.button} bg-gray-200 text-gray-800 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors`}\r\n              >\r\n                닫기\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* 우상단 닫기 X 버튼 */}\r\n        {onDismiss && (\r\n          <button\r\n            onClick={onDismiss}\r\n            className=\"ml-2 text-red-400 hover:text-red-600 focus:outline-none\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ErrorDisplay; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\common\\LoadingSpinner.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n\r\n// 기본 스피너 컴포넌트\r\nexport const LoadingSpinner = ({ \r\n  size = 'normal', \r\n  color = 'blue',\r\n  className = '',\r\n  text = ''\r\n}) => {\r\n  const getSizeClass = () => {\r\n    switch (size) {\r\n      case 'small': return 'w-4 h-4';\r\n      case 'large': return 'w-8 h-8';\r\n      default: return 'w-6 h-6';\r\n    }\r\n  };\r\n\r\n  const getColorClass = () => {\r\n    switch (color) {\r\n      case 'white': return 'text-white';\r\n      case 'gray': return 'text-gray-500';\r\n      case 'green': return 'text-green-500';\r\n      case 'red': return 'text-red-500';\r\n      default: return 'text-blue-500';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`flex items-center justify-center ${className}`}>\r\n      <svg \r\n        className={`animate-spin ${getSizeClass()} ${getColorClass()}`}\r\n        fill=\"none\" \r\n        viewBox=\"0 0 24 24\"\r\n      >\r\n        <circle \r\n          className=\"opacity-25\" \r\n          cx=\"12\" \r\n          cy=\"12\" \r\n          r=\"10\" \r\n          stroke=\"currentColor\" \r\n          strokeWidth=\"4\"\r\n        />\r\n        <path \r\n          className=\"opacity-75\" \r\n          fill=\"currentColor\" \r\n          d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\r\n        />\r\n      </svg>\r\n      {text && <span className=\"ml-2 text-sm text-gray-600\">{text}</span>}\r\n    </div>\r\n  );\r\n};\r\n\r\n// 문서 목록 스켈레톤\r\nexport const DocumentListSkeleton = ({ count = 5 }) => {\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {Array.from({ length: count }).map((_, index) => (\r\n        <div key={index} className=\"animate-pulse\">\r\n          <div className=\"p-3 bg-gray-50 rounded\">\r\n            {/* 제목 스켈레톤 */}\r\n            <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\r\n            \r\n            {/* 내용 미리보기 스켈레톤 */}\r\n            <div className=\"space-y-1\">\r\n              <div className=\"h-3 bg-gray-200 rounded w-full\"></div>\r\n              <div className=\"h-3 bg-gray-200 rounded w-5/6\"></div>\r\n            </div>\r\n            \r\n            {/* 메타 정보 스켈레톤 */}\r\n            <div className=\"flex justify-between items-center mt-2\">\r\n              <div className=\"h-3 bg-gray-200 rounded w-24\"></div>\r\n              <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\n// 에디터 스켈레톤\r\nexport const EditorSkeleton = () => {\r\n  return (\r\n    <div className=\"animate-pulse h-full\">\r\n      {/* 헤더 스켈레톤 */}\r\n      <div className=\"mb-4 p-4 border-b\">\r\n        <div className=\"flex justify-between items-center mb-2\">\r\n          <div className=\"h-6 bg-gray-200 rounded w-20\"></div>\r\n          <div className=\"flex space-x-2\">\r\n            <div className=\"h-8 bg-gray-200 rounded w-16\"></div>\r\n            <div className=\"h-8 bg-gray-200 rounded w-16\"></div>\r\n            <div className=\"h-8 bg-gray-200 rounded w-8\"></div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* 제목 입력 스켈레톤 */}\r\n        <div className=\"h-10 bg-gray-200 rounded w-full\"></div>\r\n      </div>\r\n      \r\n      {/* 에디터 영역 스켈레톤 */}\r\n      <div className=\"flex-grow space-y-3 p-4\">\r\n        <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\r\n        <div className=\"h-4 bg-gray-200 rounded w-5/6\"></div>\r\n        <div className=\"h-4 bg-gray-200 rounded w-4/5\"></div>\r\n        <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\r\n        <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\r\n        <div className=\"h-4 bg-gray-200 rounded w-5/6\"></div>\r\n        <div className=\"h-4 bg-gray-200 rounded w-2/3\"></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// AI 패널 스켈레톤\r\nexport const AiPanelSkeleton = () => {\r\n  return (\r\n    <div className=\"animate-pulse h-full\">\r\n      {/* 헤더 스켈레톤 */}\r\n      <div className=\"p-3 border-b\">\r\n        <div className=\"h-6 bg-gray-200 rounded w-20\"></div>\r\n      </div>\r\n      \r\n      {/* 대화 내용 스켈레톤 */}\r\n      <div className=\"p-4 space-y-4\">\r\n        {/* 사용자 메시지 */}\r\n        <div className=\"flex justify-end\">\r\n          <div className=\"bg-gray-200 rounded-lg p-3 max-w-xs\">\r\n            <div className=\"h-3 bg-gray-300 rounded w-full mb-1\"></div>\r\n            <div className=\"h-3 bg-gray-300 rounded w-3/4\"></div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* AI 응답 */}\r\n        <div className=\"flex justify-start\">\r\n          <div className=\"bg-gray-100 rounded-lg p-3 max-w-xs\">\r\n            <div className=\"h-3 bg-gray-200 rounded w-full mb-1\"></div>\r\n            <div className=\"h-3 bg-gray-200 rounded w-5/6 mb-1\"></div>\r\n            <div className=\"h-3 bg-gray-200 rounded w-2/3\"></div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* 사용자 메시지 */}\r\n        <div className=\"flex justify-end\">\r\n          <div className=\"bg-gray-200 rounded-lg p-3 max-w-xs\">\r\n            <div className=\"h-3 bg-gray-300 rounded w-4/5\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 입력 영역 스켈레톤 */}\r\n      <div className=\"absolute bottom-0 left-0 right-0 p-4 border-t bg-white\">\r\n        <div className=\"h-10 bg-gray-200 rounded w-full\"></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// 전체 페이지 로딩\r\nexport const PageLoadingSpinner = ({ text = '로딩 중...' }) => {\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n      <div className=\"text-center\">\r\n        <LoadingSpinner size=\"large\" className=\"mb-4\" />\r\n        <p className=\"text-gray-600 text-lg\">{text}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// 인라인 로딩 (버튼 내부 등)\r\nexport const InlineLoadingSpinner = ({ text = '' }) => {\r\n  return (\r\n    <div className=\"flex items-center\">\r\n      <LoadingSpinner size=\"small\" />\r\n      {text && <span className=\"ml-2\">{text}</span>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoadingSpinner; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\common\\MessageToast.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\r\n\r\nconst MessageToast = ({ message, onClose }) => {\r\n  useEffect(() => {\r\n    if (message) {\r\n      const timer = setTimeout(() => {\r\n        onClose();\r\n      }, 3000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [message, onClose]);\r\n\r\n  if (!message) return null;\r\n\r\n  const getMessageStyles = () => {\r\n    switch (message.type) {\r\n      case 'success':\r\n        return 'bg-green-100 border-green-400 text-green-700';\r\n      case 'error':\r\n        return 'bg-red-100 border-red-400 text-red-700';\r\n      case 'warning':\r\n        return 'bg-yellow-100 border-yellow-400 text-yellow-700';\r\n      case 'info':\r\n      default:\r\n        return 'bg-blue-100 border-blue-400 text-blue-700';\r\n    }\r\n  };\r\n\r\n  const getIcon = () => {\r\n    switch (message.type) {\r\n      case 'success':\r\n        return (\r\n          <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n          </svg>\r\n        );\r\n      case 'error':\r\n        return (\r\n          <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n          </svg>\r\n        );\r\n      case 'warning':\r\n        return (\r\n          <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 15.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n          </svg>\r\n        );\r\n      case 'info':\r\n      default:\r\n        return (\r\n          <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n          </svg>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed top-4 right-4 z-50 animate-fade-in\">\r\n      <div className={`border px-4 py-3 rounded-lg shadow-lg max-w-sm ${getMessageStyles()}`}>\r\n        <div className=\"flex items-center\">\r\n          <div className=\"flex-shrink-0 mr-3\">\r\n            {getIcon()}\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <p className=\"text-sm font-medium\">{message.text}</p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"flex-shrink-0 ml-3 hover:opacity-70 transition-opacity\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageToast;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\editor\\EditorPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport MikiEditor from '../../MikiEditor';\r\nimport { InlineLoadingSpinner } from '../common/LoadingSpinner';\r\n\r\nconst EditorPanel = ({\r\n  title,\r\n  saveStatus,\r\n  isFullscreen,\r\n  isMobile,\r\n  activeMobilePanel,\r\n  setActiveMobilePanel,\r\n  isLoadingDocuments,\r\n  editorRef,\r\n  onTitleChange,\r\n  onNewPost,\r\n  onSavePost,\r\n  onToggleFullscreen,\r\n  onEditorContextUpdate,\r\n  onEditorChange,\r\n  onSendToAi,\r\n  onNavigateRequest,\r\n  hasUnsavedChanges,\r\n  isAutoSaving,\r\n  isManualSaving\r\n}) => {\r\n  const getSaveStatusStyle = () => {\r\n    if (isAutoSaving || isManualSaving) {\r\n      return 'bg-blue-100 text-blue-700';\r\n    }\r\n    if (hasUnsavedChanges) {\r\n      return 'bg-yellow-100 text-yellow-700';\r\n    }\r\n    return 'bg-green-100 text-green-700';\r\n  };\r\n\r\n  const getSaveStatusContent = () => {\r\n    if (isAutoSaving) {\r\n      return (\r\n        <div className=\"flex items-center\">\r\n          <InlineLoadingSpinner />\r\n          <span className=\"ml-1\">자동 저장 중...</span>\r\n        </div>\r\n      );\r\n    }\r\n    if (isManualSaving) {\r\n      return (\r\n        <div className=\"flex items-center\">\r\n          <InlineLoadingSpinner />\r\n          <span className=\"ml-1\">저장 중...</span>\r\n        </div>\r\n      );\r\n    }\r\n    return saveStatus;\r\n  };\r\n\r\n  const getEditorKey = () => {\r\n    return isFullscreen ? \"editor-fixed-key-fullscreen\" : \"editor-fixed-key-normal\";\r\n  };\r\n\r\n  const getContainerClass = () => {\r\n    if (isFullscreen) {\r\n      return \"bg-white rounded shadow flex flex-col h-full\";\r\n    }\r\n    return `bg-white rounded shadow flex flex-col ${\r\n      isMobile ? (activeMobilePanel === 'editor' ? 'block' : 'hidden') + ' flex-grow' : 'flex-1 mx-2'\r\n    }`;\r\n  };\r\n\r\n  const getContainerStyle = () => {\r\n    if (isFullscreen) {\r\n      return {};\r\n    }\r\n    return { display: isMobile && activeMobilePanel !== 'editor' ? 'none' : 'flex' };\r\n  };\r\n\r\n  return (\r\n    <div \r\n      className={getContainerClass()}\r\n      style={getContainerStyle()}\r\n    >\r\n      {/* 에디터 헤더 */}\r\n      <div className=\"mb-4 flex flex-col p-4 border-b\">\r\n        <div className=\"flex justify-between items-center mb-2\">\r\n          <div className=\"flex items-center\">\r\n            <h2 className=\"text-lg font-bold\">에디터</h2>\r\n            <span className={`ml-4 text-xs px-2 py-1 rounded ${getSaveStatusStyle()}`}>\r\n              {getSaveStatusContent()}\r\n            </span>\r\n            {/* 변경사항 인디케이터 */}\r\n            {hasUnsavedChanges && !isAutoSaving && !isManualSaving && (\r\n              <span className=\"ml-2 w-2 h-2 bg-orange-400 rounded-full\" title=\"저장되지 않은 변경사항\"></span>\r\n            )}\r\n          </div>\r\n          \r\n          <div className=\"flex items-center space-x-2\">\r\n            {/* 새 글 버튼 */}\r\n            <button \r\n              onClick={onNewPost}\r\n              className=\"px-3 py-1 text-sm rounded flex items-center bg-green-500 text-white hover:bg-green-600\"\r\n              title=\"새 글 작성 (Ctrl+N)\"\r\n            >\r\n              <svg className=\"w-4 h-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\r\n              </svg>\r\n              새 글\r\n            </button>\r\n            \r\n            {/* 저장 버튼 */}\r\n            <button \r\n              onClick={onSavePost}\r\n              disabled={isLoadingDocuments || (!hasUnsavedChanges && !isManualSaving)} \r\n              className={`px-3 py-1 text-sm rounded flex items-center ${\r\n                isLoadingDocuments || (!hasUnsavedChanges && !isManualSaving)\r\n                  ? 'bg-gray-200 text-gray-500 cursor-not-allowed' \r\n                  : 'bg-blue-500 text-white hover:bg-blue-600'\r\n              }`}\r\n              title=\"저장 (Ctrl+S)\"\r\n            >\r\n              {isManualSaving ? (\r\n                <InlineLoadingSpinner />\r\n              ) : (\r\n                <svg className=\"w-4 h-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4\" />\r\n                </svg>\r\n              )}\r\n              <span className=\"ml-1\">저장</span>\r\n            </button>\r\n            \r\n            {/* 전체화면 토글 버튼 */}\r\n            <button \r\n              onClick={onToggleFullscreen}\r\n              className=\"p-1 text-gray-600 hover:text-gray-900 rounded\"\r\n              title=\"전체화면 토글 (Ctrl+Enter)\"\r\n            >\r\n              <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            {/* 모바일 AI 패널 이동 버튼 */}\r\n            {isMobile && (\r\n              <button \r\n                onClick={() => setActiveMobilePanel('ai')}\r\n                className=\"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 rounded flex items-center ml-1\"\r\n                title=\"AI 패널로 이동\"\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\r\n                </svg>\r\n                AI 패널\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n        \r\n        {/* 제목 입력 */}\r\n        <input\r\n          type=\"text\"\r\n          value={title}\r\n          onChange={onTitleChange}\r\n          placeholder=\"문서 제목을 입력하세요 (편집기 첫 줄 텍스트가 자동으로 제목이 됩니다)\"\r\n          className=\"w-full px-3 py-2 text-xl font-medium border-b border-gray-200 focus:outline-none focus:border-blue-500 mb-2 bg-transparent\"\r\n        />\r\n      </div>\r\n      \r\n      {/* 에디터 영역 */}\r\n      <div className=\"flex-grow border rounded relative\">\r\n        <MikiEditor\r\n          ref={editorRef}\r\n          key={getEditorKey()}\r\n          onContextUpdate={onEditorContextUpdate}\r\n          onContentChange={onEditorChange}\r\n          onSendToAi={onSendToAi}\r\n          onNavigateRequest={onNavigateRequest}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditorPanel; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\layout\\AppLayout.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport DocumentSidebar from '../sidebar/DocumentSidebar';\r\nimport EditorPanel from '../editor/EditorPanel';\r\nimport AiPanelContainer from '../ai/AiPanelContainer';\r\n\r\nconst AppLayout = ({\r\n  isFullscreen,\r\n  isMobile,\r\n  activeMobilePanel,\r\n  setActiveMobilePanel,\r\n  editorPanelClass,\r\n  \r\n  // DocumentSidebar props\r\n  documentsData,\r\n  currentDocument,\r\n  searchQuery,\r\n  setSearchQuery,\r\n  onLoadPost,\r\n  onNewPost,\r\n  onDeletePost,\r\n  setMessage,\r\n  \r\n  // EditorPanel props\r\n  title,\r\n  saveStatus,\r\n  isLoadingDocuments,\r\n  editorRef,\r\n  onTitleChange,\r\n  onSavePost,\r\n  onToggleFullscreen,\r\n  onEditorContextUpdate,\r\n  onEditorChange,\r\n  onSendToAi,\r\n  onNavigateRequest,\r\n  \r\n  // AiPanelContainer props\r\n  aiPanelRef,\r\n  editorContext,\r\n  onStructuredCommand,\r\n  onDisplaySuggestion\r\n}) => {\r\n  if (isFullscreen) {\r\n    // 전체화면 모드\r\n    return (\r\n      <div className={editorPanelClass}>\r\n        <EditorPanel\r\n          title={title}\r\n          saveStatus={saveStatus}\r\n          isFullscreen={isFullscreen}\r\n          isMobile={isMobile}\r\n          activeMobilePanel={activeMobilePanel}\r\n          setActiveMobilePanel={setActiveMobilePanel}\r\n          isLoadingDocuments={isLoadingDocuments}\r\n          editorRef={editorRef}\r\n          onTitleChange={onTitleChange}\r\n          onNewPost={onNewPost}\r\n          onSavePost={onSavePost}\r\n          onToggleFullscreen={onToggleFullscreen}\r\n          onEditorContextUpdate={onEditorContextUpdate}\r\n          onEditorChange={onEditorChange}\r\n          onSendToAi={onSendToAi}\r\n          onNavigateRequest={onNavigateRequest}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 일반 모드 (3패널 레이아웃)\r\n  return (\r\n    <div className=\"flex h-full\" style={{ flexDirection: isMobile ? 'column' : 'row' }}>\r\n      {/* 문서 목록 사이드바 */}\r\n      <DocumentSidebar\r\n        documentsData={documentsData}\r\n        currentDocument={currentDocument}\r\n        searchQuery={searchQuery}\r\n        setSearchQuery={setSearchQuery}\r\n        onLoadPost={onLoadPost}\r\n        onNewPost={onNewPost}\r\n        onDeletePost={onDeletePost}\r\n        isMobile={isMobile}\r\n        activeMobilePanel={activeMobilePanel}\r\n        setActiveMobilePanel={setActiveMobilePanel}\r\n        setMessage={setMessage}\r\n      />\r\n      \r\n      {/* 에디터 패널 */}\r\n      <EditorPanel\r\n        title={title}\r\n        saveStatus={saveStatus}\r\n        isFullscreen={isFullscreen}\r\n        isMobile={isMobile}\r\n        activeMobilePanel={activeMobilePanel}\r\n        setActiveMobilePanel={setActiveMobilePanel}\r\n        isLoadingDocuments={isLoadingDocuments}\r\n        editorRef={editorRef}\r\n        onTitleChange={onTitleChange}\r\n        onNewPost={onNewPost}\r\n        onSavePost={onSavePost}\r\n        onToggleFullscreen={onToggleFullscreen}\r\n        onEditorContextUpdate={onEditorContextUpdate}\r\n        onEditorChange={onEditorChange}\r\n        onSendToAi={onSendToAi}\r\n        onNavigateRequest={onNavigateRequest}\r\n      />\r\n      \r\n      {/* AI 패널 */}\r\n      <AiPanelContainer\r\n        isMobile={isMobile}\r\n        activeMobilePanel={activeMobilePanel}\r\n        setActiveMobilePanel={setActiveMobilePanel}\r\n        aiPanelRef={aiPanelRef}\r\n        editorContext={editorContext}\r\n        onStructuredCommand={onStructuredCommand}\r\n        onDisplaySuggestion={onDisplaySuggestion}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AppLayout; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\components\\sidebar\\DocumentSidebar.jsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'currentDocument' is defined but never used. Allowed unused args must match /^_/u.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":18},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":65,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":65,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2064,2098],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":92,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":92,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2866,2904],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":103,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":103,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3137,3195],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":109,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":109,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3398,3475],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":117,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":117,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3890,3935],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":120,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":120,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3978,4035],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":122,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":122,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4083,4127],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":132,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":132,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4396,4434],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\n\r\nconst removeMarkdownFormatting = (text) => {\r\n  if (!text) return '';\r\n  return text\r\n    .replace(/#{1,6}\\s+/g, '') // 헤더 제거\r\n    .replace(/\\*\\*(.*?)\\*\\*/g, '$1') // 볼드 제거\r\n    .replace(/\\*(.*?)\\*/g, '$1') // 이탤릭 제거\r\n    .replace(/`(.*?)`/g, '$1') // 인라인 코드 제거\r\n    .replace(/\\[(.*?)\\]\\(.*?\\)/g, '$1') // 링크 제거\r\n    .replace(/!\\[.*?\\]\\(.*?\\)/g, '') // 이미지 제거\r\n    .replace(/^\\s*[-*+]\\s+/gm, '') // 리스트 마커 제거\r\n    .replace(/^\\s*\\d+\\.\\s+/gm, '') // 번호 리스트 마커 제거\r\n    .replace(/^\\s*>\\s+/gm, '') // 인용문 제거\r\n    .replace(/```[\\s\\S]*?```/g, '') // 코드 블록 제거\r\n    .replace(/\\n{2,}/g, '\\n') // 연속된 줄바꿈 정리\r\n    .trim();\r\n};\r\n\r\nconst DocumentSidebar = ({ \r\n  documentsData, \r\n  currentDocument, \r\n  searchQuery, \r\n  setSearchQuery,\r\n  searchInputRef,\r\n  onLoadPost, \r\n  onNewPost,\r\n  onDeletePost,\r\n  isMobile, \r\n  activeMobilePanel, \r\n  setActiveMobilePanel,\r\n  setMessage \r\n}) => {\r\n  const queryClient = useQueryClient();\r\n\r\n  // 검색 필터링된 문서 목록\r\n  const filteredPosts = useMemo(() => {\r\n    if (!documentsData) return [];\r\n    if (!searchQuery.trim()) return documentsData;\r\n    \r\n    const query = searchQuery.toLowerCase();\r\n    return documentsData.filter(post => \r\n      post.title.toLowerCase().includes(query) ||\r\n      (post.content && post.content.toLowerCase().includes(query)) ||\r\n      (post.preview && post.preview.toLowerCase().includes(query))\r\n    );\r\n  }, [documentsData, searchQuery]);\r\n\r\n  const handleRefresh = () => {\r\n    queryClient.invalidateQueries(['documents']);\r\n  };\r\n\r\n  const handleCleanup = async () => {\r\n    try {\r\n      const { default: DataSyncManager } = await import('../../utils/DataSyncManager.js');\r\n      const syncManager = new DataSyncManager();\r\n      const result = syncManager.immediateLocalCleanup(['제니', '로제', '먐시리', '블랙핑크']);\r\n      \r\n      setMessage({\r\n        type: 'success',\r\n        text: `로컬 정리 완료: ${result.preservedDocuments}개 보존, ${result.deletedDocuments}개 삭제`\r\n      });\r\n    } catch (error) {\r\n      console.error('수동 정리 오류:', error);\r\n      setMessage({\r\n        type: 'error',\r\n        text: '정리 중 오류가 발생했습니다.'\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDocumentClick = (post) => {\r\n    onLoadPost(post.id);\r\n    if (isMobile) setActiveMobilePanel('editor');\r\n  };\r\n\r\n  const handleNewPostClick = () => {\r\n    onNewPost();\r\n    if (isMobile) setActiveMobilePanel('editor');\r\n  };\r\n\r\n  const handleDeleteDocument = async (post) => {\r\n    if (window.confirm(`'${post.title}'을(를) 삭제하시겠습니까?`)) {\r\n      try {\r\n        const abortController = new AbortController();\r\n        const response = await fetch(`http://localhost:3003/api/posts/${post.id}`, {\r\n          method: 'DELETE',\r\n          signal: abortController.signal\r\n        }).catch(err => {\r\n          if (err.name === 'AbortError') {\r\n            console.log('Delete request aborted');\r\n            return null;\r\n          }\r\n          throw err;\r\n        });\r\n        \r\n        if (!response) return; // 요청이 취소된 경우\r\n        \r\n        if (response.ok) {\r\n          // 로컬 스토리지에서도 해당 문서 삭제\r\n          try {\r\n            console.log(`삭제 대상: ID \"${post.id}\", 제목 \"${post.title}\"`);\r\n            \r\n            // 1. 메인 문서 데이터 삭제\r\n            localStorage.removeItem(`miki_document_${post.id}`);\r\n            localStorage.removeItem(`miki_title_${post.id}`);\r\n            \r\n            console.log(`로컬 스토리지에서 삭제: miki_document_${post.id}, miki_title_${post.id}`);\r\n            \r\n            // 2. 최근 문서 목록에서 정확한 ID만 제거\r\n            const recentDocsJson = localStorage.getItem('miki_recent_docs');\r\n            if (recentDocsJson) {\r\n              const recentDocs = JSON.parse(recentDocsJson);\r\n              const filteredDocs = recentDocs.filter(doc => doc.id !== post.id);\r\n              localStorage.setItem('miki_recent_docs', JSON.stringify(filteredDocs));\r\n              console.log(`최근 문서 목록에서 ID \"${post.id}\" 제거`);\r\n            }\r\n            \r\n            console.log(`\"${post.title}\" 문서 (ID: ${post.id}) 삭제 완료`);\r\n          } catch (localError) {\r\n            console.error('로컬 스토리지 삭제 오류:', localError);\r\n          }\r\n          \r\n          // 삭제한 글이 현재 열려있는 글인지 확인하고 콜백 호출\r\n          onDeletePost(post);\r\n          \r\n          setMessage({ type: 'success', text: '글이 삭제되었습니다.' });\r\n        }\r\n      } catch (error) {\r\n        if (error.name === 'AbortError') {\r\n          console.log('Delete request aborted');\r\n          return;\r\n        }\r\n        setMessage({ type: 'error', text: '삭제 실패: ' + error.message });\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div \r\n      className={`bg-white rounded shadow flex flex-col ${\r\n        isMobile ? (activeMobilePanel === 'list' ? 'block' : 'hidden') + ' flex-grow' : 'w-1/5 mr-2'\r\n      }`}\r\n      style={{ display: isMobile && activeMobilePanel !== 'list' ? 'none' : 'flex' }}\r\n    >\r\n      {/* 헤더 */}\r\n      <div className=\"flex justify-between items-center p-3 border-b\">\r\n        <h2 className=\"text-lg font-bold\">문서 목록</h2>\r\n        <div className=\"flex items-center\">\r\n          <span className=\"text-sm text-gray-500 mr-2\">{(documentsData || []).length}개의 문서</span>\r\n          \r\n          {/* 새로고침 버튼 */}\r\n          <button \r\n            onClick={handleRefresh}\r\n            className=\"p-1 text-gray-600 hover:text-gray-900 rounded mr-1\"\r\n            title=\"새로고침\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n            </svg>\r\n          </button>\r\n          \r\n          {/* 정리 버튼 */}\r\n          <button \r\n            onClick={handleCleanup}\r\n            className=\"p-1 text-gray-600 hover:text-red-600 rounded mr-1\"\r\n            title=\"로컬 스토리지 정리\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n            </svg>\r\n          </button>\r\n          \r\n          {/* 모바일 에디터 이동 버튼 */}\r\n          {isMobile && (\r\n            <button \r\n              onClick={() => setActiveMobilePanel('editor')}\r\n              className=\"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 rounded flex items-center ml-1\"\r\n              title=\"에디터로 이동\"\r\n            >\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14 5l7 7-7 7\" />\r\n              </svg>\r\n              에디터\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 검색 입력 */}\r\n      <div className=\"p-3 border-b\">\r\n        <div className=\"relative\">\r\n          <input \r\n            ref={searchInputRef}\r\n            type=\"text\" \r\n            placeholder=\"문서 검색...\" \r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            className=\"w-full px-3 py-2 border rounded-md pr-10 focus:outline-none focus:ring-2 focus:ring-blue-300\"\r\n          />\r\n          <svg className=\"absolute right-3 top-2.5 h-5 w-5 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n          </svg>\r\n          {searchQuery && (\r\n            <button \r\n              onClick={() => setSearchQuery('')}\r\n              className=\"absolute right-9 top-2.5 h-5 w-5 text-gray-400 hover:text-gray-600\"\r\n            >\r\n              <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 문서 목록 */}\r\n      <div className=\"flex-grow overflow-auto p-3\">\r\n        {(documentsData || []).length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center h-40 text-gray-500\">\r\n            <svg className=\"w-12 h-12 mb-2 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n            </svg>\r\n            <p>저장된 글이 없습니다</p>\r\n            <button \r\n              onClick={handleNewPostClick}\r\n              className=\"mt-2 px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n            >\r\n              새 글 작성하기\r\n            </button>\r\n          </div>\r\n        ) : filteredPosts.length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center h-40 text-gray-500\">\r\n            <svg className=\"w-12 h-12 mb-2 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n            </svg>\r\n            <p>검색 결과가 없습니다</p>\r\n            <button \r\n              onClick={() => setSearchQuery('')}\r\n              className=\"mt-2 px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n            >\r\n              검색어 지우기\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <ul className=\"divide-y\">\r\n            {filteredPosts.map(post => (\r\n              <li key={post.id} className=\"py-3 px-2 hover:bg-gray-50 transition-colors rounded\">\r\n                <button \r\n                  onClick={() => handleDocumentClick(post)}\r\n                  className=\"text-left w-full\"\r\n                >\r\n                  <div className=\"font-medium text-blue-600 line-clamp-1\">\r\n                    {/* 빈 메모 표시 아이콘 */}\r\n                    {post.isEmpty && (\r\n                      <span className=\"inline-flex items-center mr-2 text-gray-400\">\r\n                        <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\r\n                        </svg>\r\n                      </span>\r\n                    )}\r\n                    {post.title}\r\n                  </div>\r\n                  <p className=\"text-sm text-gray-700 mt-1 line-clamp-2\">\r\n                    {post.isEmpty ? (\r\n                      <span className=\"text-gray-400 italic\">새 메모를 작성하세요...</span>\r\n                    ) : (\r\n                      removeMarkdownFormatting(post.preview)\r\n                    )}\r\n                  </p>\r\n                  <div className=\"flex justify-between items-center mt-2 text-xs text-gray-500\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                      </svg>\r\n                      <span>{new Date(post.updatedAt).toLocaleDateString('ko-KR', {\r\n                        year: 'numeric',\r\n                        month: '2-digit',\r\n                        day: '2-digit',\r\n                        hour: '2-digit',\r\n                        minute: '2-digit'\r\n                      })}</span>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z\" />\r\n                      </svg>\r\n                      <span>{(post.size / 1024).toFixed(1)}KB</span>\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n                \r\n                {/* 삭제 버튼 */}\r\n                <div className=\"mt-2 flex justify-end\">\r\n                  <button \r\n                    onClick={() => handleDeleteDocument(post)}\r\n                    className=\"px-2 py-1 text-xs text-gray-500 hover:text-red-500 hover:bg-red-50 rounded\"\r\n                  >\r\n                    삭제\r\n                  </button>\r\n                </div>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DocumentSidebar; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\config\\featureFlags.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":70,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":70,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2186,2241],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":96,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":96,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2916,2986],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 기능 플래그 관리\r\n * 점진적 배포와 A/B 테스트를 위한 중앙화된 설정\r\n */\r\n\r\n// 환경 변수에서 기능 플래그 읽기\r\nconst getFeatureFlag = (flagName, defaultValue = false) => {\r\n  // Jest 호환성을 위해 기본값 사용\r\n  return defaultValue;\r\n};\r\n\r\n// 사용자별 기능 플래그 (localStorage 기반)\r\nconst getUserFeatureFlag = (flagName, defaultValue = false) => {\r\n  try {\r\n    const userFlags = JSON.parse(localStorage.getItem('userFeatureFlags') || '{}');\r\n    return userFlags[flagName] !== undefined ? userFlags[flagName] : defaultValue;\r\n  } catch {\r\n    return defaultValue;\r\n  }\r\n};\r\n\r\n// 기능 플래그 설정\r\nexport const FEATURE_FLAGS = {\r\n  // AI 기능 관련\r\n  AI_PANEL: getFeatureFlag('AI_PANEL', true),\r\n  AI_SEARCH: getFeatureFlag('AI_SEARCH', true),\r\n  AI_SUMMARY: getFeatureFlag('AI_SUMMARY', true),\r\n  \r\n  // 에디터 기능 관련\r\n  MARKDOWN_PREVIEW: getFeatureFlag('MARKDOWN_PREVIEW', true),\r\n  SYNTAX_HIGHLIGHTING: getFeatureFlag('SYNTAX_HIGHLIGHTING', true),\r\n  AUTO_SAVE: getFeatureFlag('AUTO_SAVE', true),\r\n  \r\n  // 동기화 기능 관련\r\n  SERVER_SYNC: getFeatureFlag('SERVER_SYNC', true),\r\n  REAL_TIME_SYNC: getFeatureFlag('REAL_TIME_SYNC', false),\r\n  \r\n  // 실험적 기능들\r\n  EXPERIMENTAL_FEATURES: getFeatureFlag('EXPERIMENTAL_FEATURES', false),\r\n  BETA_UI: getFeatureFlag('BETA_UI', false),\r\n  \r\n  // 디버그 및 개발 관련\r\n  DEBUG_MODE: getFeatureFlag('DEBUG_MODE', false),\r\n  PERFORMANCE_MONITORING: getFeatureFlag('PERFORMANCE_MONITORING', false),\r\n  \r\n  // 환경 정보\r\n  DEV_MODE: false, // Jest 환경에서는 false\r\n  \r\n  // 새로운 기능들\r\n  DOCUMENT_VERSIONING: getFeatureFlag('DOCUMENT_VERSIONING', false),\r\n  COLLABORATIVE_EDITING: getFeatureFlag('COLLABORATIVE_EDITING', false),\r\n  ADVANCED_SEARCH: getFeatureFlag('ADVANCED_SEARCH', true),\r\n  EXPORT_FEATURES: getFeatureFlag('EXPORT_FEATURES', true),\r\n};\r\n\r\n// 기능 플래그 업데이트 함수\r\nexport const updateUserFeatureFlag = (flagName, value) => {\r\n  try {\r\n    const userFlags = JSON.parse(localStorage.getItem('userFeatureFlags') || '{}');\r\n    userFlags[flagName] = value;\r\n    localStorage.setItem('userFeatureFlags', JSON.stringify(userFlags));\r\n    \r\n    // 페이지 새로고침 없이 즉시 적용하려면 이벤트 발생\r\n    window.dispatchEvent(new CustomEvent('featureFlagChanged', {\r\n      detail: { flagName, value }\r\n    }));\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error('Failed to update feature flag:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n// 기능 플래그 상태 확인 헬퍼\r\nexport const isFeatureEnabled = (flagName) => {\r\n  return FEATURE_FLAGS[flagName] === true;\r\n};\r\n\r\n// 개발자 도구용 기능 플래그 디버거\r\nif (FEATURE_FLAGS.DEV_MODE) {\r\n  window.mikiFeatureFlags = {\r\n    flags: FEATURE_FLAGS,\r\n    enable: (flagName) => updateUserFeatureFlag(flagName, true),\r\n    disable: (flagName) => updateUserFeatureFlag(flagName, false),\r\n    toggle: (flagName) => {\r\n      const current = getUserFeatureFlag(flagName, false);\r\n      return updateUserFeatureFlag(flagName, !current);\r\n    },\r\n    reset: () => {\r\n      localStorage.removeItem('userFeatureFlags');\r\n      window.location.reload();\r\n    }\r\n  };\r\n  \r\n  console.log('🚩 Feature Flags Debug Tools:', window.mikiFeatureFlags);\r\n}\r\n\r\n// 기능 플래그별 컴포넌트 래퍼\r\nexport const FeatureGate = ({ feature, children, fallback = null }) => {\r\n  return isFeatureEnabled(feature) ? children : fallback;\r\n};\r\n\r\n// 점진적 마이그레이션을 위한 컴포넌트 선택기\r\nexport const ComponentSelector = ({ \r\n  feature, \r\n  newComponent: NewComponent, \r\n  legacyComponent: LegacyComponent,\r\n  ...props \r\n}) => {\r\n  const Component = isFeatureEnabled(feature) ? NewComponent : LegacyComponent;\r\n  return <Component {...props} />;\r\n};\r\n\r\nexport default FEATURE_FLAGS; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\config\\queryClient.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":92,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":92,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2566,2610],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":98,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":98,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2739,2778],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":112,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":112,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3123,3171],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient } from '@tanstack/react-query';\r\n\r\n// QueryClient 설정 - Optimistic UI와 오프라인 지원\r\nexport const queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      // 캐시 시간 설정\r\n      staleTime: 5 * 60 * 1000, // 5분 - 데이터가 신선한 것으로 간주되는 시간\r\n      cacheTime: 10 * 60 * 1000, // 10분 - 캐시에 보관되는 시간\r\n      \r\n      // 네트워크 재연결 시 자동 리패치\r\n      refetchOnWindowFocus: true,\r\n      refetchOnReconnect: true,\r\n      \r\n      // 오프라인 지원\r\n      networkMode: 'offlineFirst',\r\n      \r\n      // 재시도 설정\r\n      retry: (failureCount, error) => {\r\n        // 네트워크 오류인 경우 3번까지 재시도\r\n        if (error?.name === 'NetworkError' || error?.code === 'NETWORK_ERROR') {\r\n          return failureCount < 3;\r\n        }\r\n        // 서버 오류(5xx)인 경우 2번까지 재시도\r\n        if (error?.status >= 500) {\r\n          return failureCount < 2;\r\n        }\r\n        // 클라이언트 오류(4xx)는 재시도하지 않음\r\n        return false;\r\n      },\r\n      \r\n      // 재시도 지연 (지수 백오프)\r\n      retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000),\r\n    },\r\n    \r\n    mutations: {\r\n      // 뮤테이션 네트워크 모드\r\n      networkMode: 'offlineFirst',\r\n      \r\n      // 뮤테이션 재시도 설정\r\n      retry: (failureCount, error) => {\r\n        // 네트워크 오류인 경우만 재시도\r\n        if (error?.name === 'NetworkError' || error?.code === 'NETWORK_ERROR') {\r\n          return failureCount < 2;\r\n        }\r\n        return false;\r\n      },\r\n      \r\n      // 뮤테이션 재시도 지연\r\n      retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 10000),\r\n    },\r\n  },\r\n});\r\n\r\n// 쿼리 키 팩토리 - 일관된 쿼리 키 관리\r\nexport const queryKeys = {\r\n  // 문서 관련 쿼리 키\r\n  documents: {\r\n    all: ['documents'],\r\n    lists: () => [...queryKeys.documents.all, 'list'],\r\n    list: (filters) => [...queryKeys.documents.lists(), { filters }],\r\n    details: () => [...queryKeys.documents.all, 'detail'],\r\n    detail: (id) => [...queryKeys.documents.details(), id],\r\n    search: (query) => [...queryKeys.documents.all, 'search', query],\r\n  },\r\n  \r\n  // 서버 상태 관련\r\n  server: {\r\n    all: ['server'],\r\n    status: () => [...queryKeys.server.all, 'status'],\r\n    health: () => [...queryKeys.server.all, 'health'],\r\n  },\r\n  \r\n  // 동기화 관련\r\n  sync: {\r\n    all: ['sync'],\r\n    queue: () => [...queryKeys.sync.all, 'queue'],\r\n    status: () => [...queryKeys.sync.all, 'status'],\r\n  },\r\n};\r\n\r\n// 오프라인 상태 감지\r\nexport const isOnline = () => {\r\n  return typeof navigator !== 'undefined' ? navigator.onLine : true;\r\n};\r\n\r\n// 네트워크 상태 변경 이벤트 리스너\r\nexport const setupNetworkListeners = (queryClient) => {\r\n  if (typeof window === 'undefined') return;\r\n  \r\n  const handleOnline = () => {\r\n    console.log('🌐 네트워크 연결됨 - 대기 중인 뮤테이션 재시도');\r\n    queryClient.resumePausedMutations();\r\n    queryClient.invalidateQueries();\r\n  };\r\n  \r\n  const handleOffline = () => {\r\n    console.log('📴 네트워크 연결 끊김 - 오프라인 모드');\r\n  };\r\n  \r\n  window.addEventListener('online', handleOnline);\r\n  window.addEventListener('offline', handleOffline);\r\n  \r\n  return () => {\r\n    window.removeEventListener('online', handleOnline);\r\n    window.removeEventListener('offline', handleOffline);\r\n  };\r\n};\r\n\r\n// 에러 처리 유틸리티\r\nexport const handleQueryError = (error, context = '') => {\r\n  console.error(`Query Error ${context}:`, error);\r\n  \r\n  // 네트워크 오류\r\n  if (error?.name === 'NetworkError' || !isOnline()) {\r\n    return {\r\n      type: 'network',\r\n      message: '네트워크 연결을 확인해주세요. 오프라인 상태에서도 편집은 계속 가능합니다.',\r\n      canRetry: true,\r\n    };\r\n  }\r\n  \r\n  // 서버 오류\r\n  if (error?.status >= 500) {\r\n    return {\r\n      type: 'server',\r\n      message: '서버에 일시적인 문제가 발생했습니다. 잠시 후 다시 시도해주세요.',\r\n      canRetry: true,\r\n    };\r\n  }\r\n  \r\n  // 클라이언트 오류\r\n  if (error?.status >= 400 && error?.status < 500) {\r\n    return {\r\n      type: 'client',\r\n      message: error?.message || '요청을 처리할 수 없습니다.',\r\n      canRetry: false,\r\n    };\r\n  }\r\n  \r\n  // 기타 오류\r\n  return {\r\n    type: 'unknown',\r\n    message: '알 수 없는 오류가 발생했습니다.',\r\n    canRetry: false,\r\n  };\r\n};\r\n\r\nexport default queryClient; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\hooks\\useAutoSave.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'performAutoSave'. Either include it or remove the dependency array.","line":49,"column":6,"nodeType":"ArrayExpression","endLine":49,"endColumn":41,"suggestions":[{"desc":"Update the dependencies array to be: [content, title, enabled, interval, performAutoSave]","fix":{"range":[1435,1470],"text":"[content, title, enabled, interval, performAutoSave]"}}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":74,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":74,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2052,2086],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":112,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":112,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3028,3062],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback, useState } from 'react';\r\nimport { useSaveDocument } from './useDocuments';\r\n\r\nconst useAutoSave = ({\r\n  document,\r\n  content,\r\n  title,\r\n  enabled = true,\r\n  interval = 3000, // 3초\r\n  onSaveStart,\r\n  onSaveSuccess,\r\n  onSaveError\r\n}) => {\r\n  const [lastSaved, setLastSaved] = useState(null);\r\n  const [saveStatus, setSaveStatus] = useState('saved'); // 'saved', 'saving', 'pending', 'error'\r\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\r\n  \r\n  const saveTimeoutRef = useRef(null);\r\n  const lastContentRef = useRef(content);\r\n  const lastTitleRef = useRef(title);\r\n  const isManualSaveRef = useRef(false);\r\n  \r\n  const saveMutation = useSaveDocument();\r\n\r\n  // 변경사항 감지\r\n  useEffect(() => {\r\n    const contentChanged = content !== lastContentRef.current;\r\n    const titleChanged = title !== lastTitleRef.current;\r\n    \r\n    if (contentChanged || titleChanged) {\r\n      setHasUnsavedChanges(true);\r\n      setSaveStatus('pending');\r\n      \r\n      // 이전 타이머 취소\r\n      if (saveTimeoutRef.current) {\r\n        clearTimeout(saveTimeoutRef.current);\r\n      }\r\n      \r\n      // 자동 저장이 활성화되어 있고 수동 저장 중이 아닐 때만 타이머 설정\r\n      if (enabled && !isManualSaveRef.current) {\r\n        saveTimeoutRef.current = setTimeout(() => {\r\n          performAutoSave();\r\n        }, interval);\r\n      }\r\n      \r\n      lastContentRef.current = content;\r\n      lastTitleRef.current = title;\r\n    }\r\n  }, [content, title, enabled, interval]);\r\n\r\n  // 자동 저장 실행\r\n  const performAutoSave = useCallback(async () => {\r\n    if (!document || !hasUnsavedChanges) return;\r\n    \r\n    try {\r\n      setSaveStatus('saving');\r\n      onSaveStart?.();\r\n      \r\n      const documentToSave = {\r\n        ...document,\r\n        content,\r\n        title,\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n      \r\n      await saveMutation.mutateAsync(documentToSave);\r\n      \r\n      setHasUnsavedChanges(false);\r\n      setSaveStatus('saved');\r\n      setLastSaved(new Date());\r\n      onSaveSuccess?.();\r\n      \r\n    } catch (error) {\r\n      console.error('자동 저장 실패:', error);\r\n      setSaveStatus('error');\r\n      onSaveError?.(error);\r\n    }\r\n  }, [document, content, title, hasUnsavedChanges, saveMutation, onSaveStart, onSaveSuccess, onSaveError]);\r\n\r\n  // 수동 저장\r\n  const manualSave = useCallback(async () => {\r\n    if (!document) return;\r\n    \r\n    // 수동 저장 플래그 설정\r\n    isManualSaveRef.current = true;\r\n    \r\n    // 자동 저장 타이머 취소\r\n    if (saveTimeoutRef.current) {\r\n      clearTimeout(saveTimeoutRef.current);\r\n      saveTimeoutRef.current = null;\r\n    }\r\n    \r\n    try {\r\n      setSaveStatus('saving');\r\n      onSaveStart?.();\r\n      \r\n      const documentToSave = {\r\n        ...document,\r\n        content,\r\n        title,\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n      \r\n      await saveMutation.mutateAsync(documentToSave);\r\n      \r\n      setHasUnsavedChanges(false);\r\n      setSaveStatus('saved');\r\n      setLastSaved(new Date());\r\n      onSaveSuccess?.();\r\n      \r\n    } catch (error) {\r\n      console.error('수동 저장 실패:', error);\r\n      setSaveStatus('error');\r\n      onSaveError?.(error);\r\n    } finally {\r\n      // 수동 저장 플래그 해제\r\n      isManualSaveRef.current = false;\r\n    }\r\n  }, [document, content, title, saveMutation, onSaveStart, onSaveSuccess, onSaveError]);\r\n\r\n  // 저장 상태 메시지 생성\r\n  const getSaveStatusMessage = useCallback(() => {\r\n    switch (saveStatus) {\r\n      case 'saving':\r\n        return '저장 중...';\r\n      case 'pending':\r\n        return '변경됨';\r\n      case 'error':\r\n        return '저장 실패';\r\n      case 'saved':\r\n        if (lastSaved) {\r\n          const now = new Date();\r\n          const diffMs = now - lastSaved;\r\n          const diffMinutes = Math.floor(diffMs / 60000);\r\n          \r\n          if (diffMinutes < 1) {\r\n            return '방금 저장됨';\r\n          } else if (diffMinutes < 60) {\r\n            return `${diffMinutes}분 전 저장됨`;\r\n          } else {\r\n            return lastSaved.toLocaleTimeString('ko-KR', {\r\n              hour: '2-digit',\r\n              minute: '2-digit'\r\n            }) + ' 저장됨';\r\n          }\r\n        }\r\n        return '저장됨';\r\n      default:\r\n        return '저장됨';\r\n    }\r\n  }, [saveStatus, lastSaved]);\r\n\r\n  // 컴포넌트 언마운트 시 정리\r\n  useEffect(() => {\r\n    return () => {\r\n      if (saveTimeoutRef.current) {\r\n        clearTimeout(saveTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // 페이지 이탈 시 저장되지 않은 변경사항 경고\r\n  useEffect(() => {\r\n    const handleBeforeUnload = (event) => {\r\n      if (hasUnsavedChanges) {\r\n        event.preventDefault();\r\n        event.returnValue = '저장되지 않은 변경사항이 있습니다. 정말 나가시겠습니까?';\r\n        return event.returnValue;\r\n      }\r\n    };\r\n\r\n    window.addEventListener('beforeunload', handleBeforeUnload);\r\n    \r\n    return () => {\r\n      window.removeEventListener('beforeunload', handleBeforeUnload);\r\n    };\r\n  }, [hasUnsavedChanges]);\r\n\r\n  return {\r\n    saveStatus,\r\n    hasUnsavedChanges,\r\n    lastSaved,\r\n    manualSave,\r\n    getSaveStatusMessage,\r\n    isAutoSaving: saveStatus === 'saving' && !isManualSaveRef.current,\r\n    isManualSaving: saveStatus === 'saving' && isManualSaveRef.current,\r\n  };\r\n};\r\n\r\nexport default useAutoSave; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\hooks\\useDocuments.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":17,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":17,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[586,630],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":34,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":34,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1062,1109],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":59,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":59,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1718,1756],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":77,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":77,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2130,2175],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'queryClient' is assigned a value but never used.","line":125,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":125,"endColumn":20},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":146,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":146,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3864,3914],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":179,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":179,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[4736,4793],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":215,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":215,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[5773,5816],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'variables' is defined but never used. Allowed unused args must match /^_/u.","line":282,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":282,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":282,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":282,"endColumn":41},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":286,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":286,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7886,7922],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":305,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":305,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8442,8490],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":334,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":334,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[9232,9275],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":378,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":378,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10561,10592],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":393,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":393,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[11023,11071],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { queryKeys, handleQueryError, isOnline } from '../config/queryClient';\r\nimport { useDocumentStore } from '../stores';\r\nimport { MikiDatabase } from '../utils/database';\r\n\r\n// API 함수들\r\nconst documentAPI = {\r\n  // 서버에서 문서 목록 가져오기\r\n  async fetchDocuments() {\r\n    try {\r\n      const response = await fetch('/api/posts');\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('서버에서 문서 목록 가져오기 실패:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // 서버에서 특정 문서 가져오기\r\n  async fetchDocument(id) {\r\n    try {\r\n      const response = await fetch(`/api/posts/${id}`);\r\n      if (!response.ok) {\r\n        if (response.status === 404) {\r\n          throw new Error('문서를 찾을 수 없습니다.');\r\n        }\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error(`서버에서 문서 ${id} 가져오기 실패:`, error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // 서버에 문서 저장\r\n  async saveDocument(document) {\r\n    try {\r\n      const method = document.id ? 'PUT' : 'POST';\r\n      const url = document.id ? `/api/posts/${document.id}` : '/api/posts';\r\n      \r\n      const response = await fetch(url, {\r\n        method,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(document),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('서버에 문서 저장 실패:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // 서버에서 문서 삭제\r\n  async deleteDocument(id) {\r\n    try {\r\n      const response = await fetch(`/api/posts/${id}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      return { success: true, id };\r\n    } catch (error) {\r\n      console.error(`서버에서 문서 ${id} 삭제 실패:`, error);\r\n      throw error;\r\n    }\r\n  },\r\n};\r\n\r\n// IndexedDB 함수들\r\nconst localAPI = {\r\n  async getDocuments() {\r\n    const db = await MikiDatabase.getInstance();\r\n    return await db.documents.orderBy('updatedAt').reverse().toArray();\r\n  },\r\n\r\n  async getDocument(id) {\r\n    const db = await MikiDatabase.getInstance();\r\n    return await db.documents.get(id);\r\n  },\r\n\r\n  async saveDocument(document) {\r\n    const db = await MikiDatabase.getInstance();\r\n    const now = new Date().toISOString();\r\n    \r\n    const docToSave = {\r\n      ...document,\r\n      updatedAt: now,\r\n      syncStatus: 'pending', // 서버 동기화 대기 상태\r\n    };\r\n\r\n    if (document.id) {\r\n      await db.documents.put(docToSave);\r\n    } else {\r\n      const id = `doc-${Date.now()}`;\r\n      docToSave.id = id;\r\n      await db.documents.add(docToSave);\r\n    }\r\n\r\n    return docToSave;\r\n  },\r\n\r\n  async deleteDocument(id) {\r\n    const db = await MikiDatabase.getInstance();\r\n    await db.documents.delete(id);\r\n    return { success: true, id };\r\n  },\r\n};\r\n\r\n// 1. 문서 목록 조회 훅\r\nexport const useDocuments = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useQuery({\r\n    queryKey: queryKeys.documents.lists(),\r\n    queryFn: async () => {\r\n      // 온라인 상태에서는 서버 데이터 우선\r\n      if (isOnline()) {\r\n        try {\r\n          const serverDocs = await documentAPI.fetchDocuments();\r\n          \r\n          // 서버 데이터를 IndexedDB에 캐시\r\n          const db = await MikiDatabase.getInstance();\r\n          for (const doc of serverDocs) {\r\n            await db.documents.put({\r\n              ...doc,\r\n              syncStatus: 'synced',\r\n            });\r\n          }\r\n          \r\n          return serverDocs;\r\n        } catch (error) {\r\n          console.warn('서버 데이터 가져오기 실패, 로컬 데이터 사용:', error);\r\n        }\r\n      }\r\n      \r\n      // 오프라인이거나 서버 실패 시 로컬 데이터 사용\r\n      return await localAPI.getDocuments();\r\n    },\r\n    staleTime: 2 * 60 * 1000, // 2분\r\n    cacheTime: 10 * 60 * 1000, // 10분\r\n  });\r\n};\r\n\r\n// 2. 특정 문서 조회 훅\r\nexport const useDocument = (id) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.documents.detail(id),\r\n    queryFn: async () => {\r\n      if (!id) return null;\r\n\r\n      // 온라인 상태에서는 서버 데이터 우선\r\n      if (isOnline()) {\r\n        try {\r\n          const serverDoc = await documentAPI.fetchDocument(id);\r\n          \r\n          // 서버 데이터를 IndexedDB에 캐시\r\n          const db = await MikiDatabase.getInstance();\r\n          await db.documents.put({\r\n            ...serverDoc,\r\n            syncStatus: 'synced',\r\n          });\r\n          \r\n          return serverDoc;\r\n        } catch (error) {\r\n          console.warn(`서버에서 문서 ${id} 가져오기 실패, 로컬 데이터 사용:`, error);\r\n        }\r\n      }\r\n      \r\n      // 오프라인이거나 서버 실패 시 로컬 데이터 사용\r\n      return await localAPI.getDocument(id);\r\n    },\r\n    enabled: !!id,\r\n    staleTime: 5 * 60 * 1000, // 5분\r\n  });\r\n};\r\n\r\n// 3. 문서 저장 뮤테이션 (Optimistic UI)\r\nexport const useSaveDocument = () => {\r\n  const queryClient = useQueryClient();\r\n  const { updateDocument, addDocument } = useDocumentStore();\r\n\r\n  return useMutation({\r\n    mutationFn: async (document) => {\r\n      // 1. 로컬에 즉시 저장 (Optimistic)\r\n      const localDoc = await localAPI.saveDocument(document);\r\n      \r\n      // 2. 온라인 상태에서만 서버 동기화 시도\r\n      if (isOnline()) {\r\n        try {\r\n          const serverDoc = await documentAPI.saveDocument(localDoc);\r\n          \r\n          // 서버 저장 성공 시 동기화 상태 업데이트\r\n          const db = await MikiDatabase.getInstance();\r\n          await db.documents.put({\r\n            ...serverDoc,\r\n            syncStatus: 'synced',\r\n          });\r\n          \r\n          return serverDoc;\r\n        } catch (error) {\r\n          console.warn('서버 저장 실패, 로컬에만 저장됨:', error);\r\n          \r\n          // 동기화 큐에 추가\r\n          const db = await MikiDatabase.getInstance();\r\n          await db.syncQueue.add({\r\n            id: `sync-${Date.now()}`,\r\n            type: 'save',\r\n            documentId: localDoc.id,\r\n            data: localDoc,\r\n            status: 'pending',\r\n            createdAt: new Date().toISOString(),\r\n            retryCount: 0,\r\n          });\r\n          \r\n          throw error;\r\n        }\r\n      }\r\n      \r\n      return localDoc;\r\n    },\r\n\r\n    // Optimistic Update\r\n    onMutate: async (newDocument) => {\r\n      // 진행 중인 쿼리 취소\r\n      await queryClient.cancelQueries({ queryKey: queryKeys.documents.all });\r\n\r\n      // 이전 데이터 백업\r\n      const previousDocuments = queryClient.getQueryData(queryKeys.documents.lists());\r\n      const previousDocument = newDocument.id \r\n        ? queryClient.getQueryData(queryKeys.documents.detail(newDocument.id))\r\n        : null;\r\n\r\n      // Optimistic 업데이트\r\n      if (newDocument.id) {\r\n        // 기존 문서 업데이트\r\n        queryClient.setQueryData(\r\n          queryKeys.documents.detail(newDocument.id),\r\n          (old) => ({ ...old, ...newDocument })\r\n        );\r\n        \r\n        queryClient.setQueryData(\r\n          queryKeys.documents.lists(),\r\n          (old) => old?.map(doc => \r\n            doc.id === newDocument.id ? { ...doc, ...newDocument } : doc\r\n          ) || []\r\n        );\r\n        \r\n        // Zustand 스토어 업데이트\r\n        updateDocument(newDocument.id, newDocument);\r\n      } else {\r\n        // 새 문서 추가\r\n        const tempId = `temp-${Date.now()}`;\r\n        const tempDoc = { ...newDocument, id: tempId };\r\n        \r\n        queryClient.setQueryData(\r\n          queryKeys.documents.lists(),\r\n          (old) => [tempDoc, ...(old || [])]\r\n        );\r\n        \r\n        // Zustand 스토어 업데이트\r\n        addDocument(tempDoc);\r\n      }\r\n\r\n      return { previousDocuments, previousDocument };\r\n    },\r\n\r\n    // 성공 시\r\n    onSuccess: (data, variables, context) => {\r\n      // 쿼리 무효화하여 최신 데이터 가져오기\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.documents.all });\r\n      \r\n      console.log('✅ 문서 저장 성공:', data.id);\r\n    },\r\n\r\n    // 실패 시 롤백\r\n    onError: (error, variables, context) => {\r\n      const errorInfo = handleQueryError(error, '문서 저장');\r\n      \r\n      // 이전 상태로 롤백\r\n      if (context?.previousDocuments) {\r\n        queryClient.setQueryData(queryKeys.documents.lists(), context.previousDocuments);\r\n      }\r\n      \r\n      if (context?.previousDocument && variables.id) {\r\n        queryClient.setQueryData(\r\n          queryKeys.documents.detail(variables.id),\r\n          context.previousDocument\r\n        );\r\n      }\r\n\r\n      console.error('❌ 문서 저장 실패:', errorInfo.message);\r\n      \r\n      // 사용자에게 알림 (토스트 등)\r\n      // 이 부분은 실제 알림 시스템과 연결\r\n    },\r\n\r\n    // 완료 시 (성공/실패 무관)\r\n    onSettled: () => {\r\n      // 관련 쿼리 리패치\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.documents.all });\r\n    },\r\n  });\r\n};\r\n\r\n// 4. 문서 삭제 뮤테이션 (Optimistic UI)\r\nexport const useDeleteDocument = () => {\r\n  const queryClient = useQueryClient();\r\n  const { deleteDocument } = useDocumentStore();\r\n\r\n  return useMutation({\r\n    mutationFn: async (id) => {\r\n      // 1. 로컬에서 즉시 삭제 (Optimistic)\r\n      const localResult = await localAPI.deleteDocument(id);\r\n      \r\n      // 2. 온라인 상태에서만 서버 동기화 시도\r\n      if (isOnline()) {\r\n        try {\r\n          return await documentAPI.deleteDocument(id);\r\n        } catch (error) {\r\n          console.warn('서버 삭제 실패, 로컬에만 삭제됨:', error);\r\n          \r\n          // 동기화 큐에 추가\r\n          const db = await MikiDatabase.getInstance();\r\n          await db.syncQueue.add({\r\n            id: `sync-${Date.now()}`,\r\n            type: 'delete',\r\n            documentId: id,\r\n            status: 'pending',\r\n            createdAt: new Date().toISOString(),\r\n            retryCount: 0,\r\n          });\r\n          \r\n          throw error;\r\n        }\r\n      }\r\n      \r\n      return localResult;\r\n    },\r\n\r\n    // Optimistic Update\r\n    onMutate: async (id) => {\r\n      await queryClient.cancelQueries({ queryKey: queryKeys.documents.all });\r\n\r\n      // 이전 데이터 백업\r\n      const previousDocuments = queryClient.getQueryData(queryKeys.documents.lists());\r\n      const previousDocument = queryClient.getQueryData(queryKeys.documents.detail(id));\r\n\r\n      // Optimistic 삭제\r\n      queryClient.setQueryData(\r\n        queryKeys.documents.lists(),\r\n        (old) => old?.filter(doc => doc.id !== id) || []\r\n      );\r\n      \r\n      queryClient.removeQueries({ queryKey: queryKeys.documents.detail(id) });\r\n      \r\n      // Zustand 스토어 업데이트\r\n      deleteDocument(id);\r\n\r\n      return { previousDocuments, previousDocument };\r\n    },\r\n\r\n    onSuccess: (data, id) => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.documents.all });\r\n      console.log('✅ 문서 삭제 성공:', id);\r\n    },\r\n\r\n    onError: (error, id, context) => {\r\n      const errorInfo = handleQueryError(error, '문서 삭제');\r\n      \r\n      // 롤백\r\n      if (context?.previousDocuments) {\r\n        queryClient.setQueryData(queryKeys.documents.lists(), context.previousDocuments);\r\n      }\r\n      \r\n      if (context?.previousDocument) {\r\n        queryClient.setQueryData(queryKeys.documents.detail(id), context.previousDocument);\r\n      }\r\n\r\n      console.error('❌ 문서 삭제 실패:', errorInfo.message);\r\n    },\r\n\r\n    onSettled: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.documents.all });\r\n    },\r\n  });\r\n};\r\n\r\n// 5. 문서 검색 훅\r\nexport const useSearchDocuments = (query) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.documents.search(query),\r\n    queryFn: async () => {\r\n      if (!query || query.trim().length < 2) {\r\n        return [];\r\n      }\r\n\r\n      // 로컬 검색 (IndexedDB)\r\n      const db = await MikiDatabase.getInstance();\r\n      const allDocs = await db.documents.toArray();\r\n      \r\n      const searchTerm = query.toLowerCase();\r\n      return allDocs.filter(doc => \r\n        doc.title?.toLowerCase().includes(searchTerm) ||\r\n        doc.content?.toLowerCase().includes(searchTerm)\r\n      );\r\n    },\r\n    enabled: !!query && query.trim().length >= 2,\r\n    staleTime: 30 * 1000, // 30초\r\n  });\r\n};\r\n\r\n// 6. 동기화 상태 훅\r\nexport const useSyncStatus = () => {\r\n  return useQuery({\r\n    queryKey: queryKeys.sync.status(),\r\n    queryFn: async () => {\r\n      const db = await MikiDatabase.getInstance();\r\n      const pendingItems = await db.syncQueue\r\n        .where('status')\r\n        .equals('pending')\r\n        .toArray();\r\n      \r\n      return {\r\n        hasPendingSync: pendingItems.length > 0,\r\n        pendingCount: pendingItems.length,\r\n        isOnline: isOnline(),\r\n      };\r\n    },\r\n    refetchInterval: 5000, // 5초마다 체크\r\n  });\r\n}; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\hooks\\useKeyboardShortcuts.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\hooks\\useResponsiveLayout.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkScreenSize'. Either include it or remove the dependency array.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [checkScreenSize, isMobile]","fix":{"range":[981,991],"text":"[checkScreenSize, isMobile]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\n\r\nconst useResponsiveLayout = () => {\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [isTablet, setIsTablet] = useState(false);\r\n  const [activeMobilePanel, setActiveMobilePanel] = useState('list');\r\n  const [isFullscreen, setIsFullscreen] = useState(false);\r\n\r\n  // 화면 크기 감지 함수\r\n  const checkScreenSize = () => {\r\n    const width = window.innerWidth;\r\n    const newIsMobile = width <= 768;\r\n    const newIsTablet = width > 768 && width <= 1024;\r\n    \r\n    setIsMobile(newIsMobile);\r\n    setIsTablet(newIsTablet);\r\n    \r\n    // 모바일에서 데스크톱으로 전환 시 활성 패널을 에디터로 설정\r\n    if (!newIsMobile && isMobile) {\r\n      setActiveMobilePanel('editor');\r\n    }\r\n  };\r\n\r\n  // 화면 크기 변경 감지\r\n  useEffect(() => {\r\n    checkScreenSize();\r\n    \r\n    const handleResize = () => {\r\n      checkScreenSize();\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, [isMobile]);\r\n\r\n  // 전체화면 토글\r\n  const toggleFullscreen = () => {\r\n    setIsFullscreen(prev => !prev);\r\n  };\r\n\r\n  // 모바일 패널 전환\r\n  const switchMobilePanel = (panel) => {\r\n    if (isMobile) {\r\n      setActiveMobilePanel(panel);\r\n    }\r\n  };\r\n\r\n  // 에디터 패널 클래스 계산\r\n  const getEditorPanelClass = () => {\r\n    if (isFullscreen) {\r\n      return \"bg-white rounded shadow flex flex-col h-full\";\r\n    }\r\n    return `bg-white rounded shadow flex flex-col ${\r\n      isMobile ? (activeMobilePanel === 'editor' ? 'block' : 'hidden') + ' flex-grow' : 'flex-1 mx-2'\r\n    }`;\r\n  };\r\n\r\n  // 레이아웃 정보 반환\r\n  return {\r\n    isMobile,\r\n    isTablet,\r\n    isFullscreen,\r\n    activeMobilePanel,\r\n    setActiveMobilePanel: switchMobilePanel,\r\n    toggleFullscreen,\r\n    editorPanelClass: getEditorPanelClass()\r\n  };\r\n};\r\n\r\nexport default useResponsiveLayout; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\index.jsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":6,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":6,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[109,147],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":7,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[148,188],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":8,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":8,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[189,248],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"react/no-deprecated","severity":2,"message":"ReactDOM.render is deprecated since React 18.0.0, use createRoot instead, see https://reactjs.org/link/switch-to-createroot","line":11,"column":1,"nodeType":"MemberExpression","messageId":"deprecated","endLine":11,"endColumn":16},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":18,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":18,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[382,422],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nconsole.log('Miki Editor v7 시작 중...');\nconsole.log('React 버전:', React.version);\nconsole.log('DOM 요소 확인:', document.getElementById('root'));\n\n// React 17 방식으로 렌더링\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nconsole.log('렌더링 완료, React 마운트 되었습니다.');\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\setupTests.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":183,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":183,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4592,4653],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// jest-dom adds custom jest matchers for asserting on DOM nodes.\n// allows you to do things like:\n// expect(element).toHaveTextContent(/react/i)\n// learn more: https://github.com/testing-library/jest-dom\nimport '@testing-library/jest-dom';\n\n// Mock window.matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(),\n    removeListener: jest.fn(),\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// Mock localStorage\nconst localStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.localStorage = localStorageMock;\n\n// Mock sessionStorage\nconst sessionStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.sessionStorage = sessionStorageMock;\n\n// Mock fetch\nglobal.fetch = jest.fn();\n\n// 🔧 JSDOM 브라우저 API 폴리필 추가 (2단계 - 테스트 환경 안정화)\n\n// Mock scrollIntoView (AiPanel.jsx 669줄에서 사용)\nElement.prototype.scrollIntoView = jest.fn();\n\n// Mock ResizeObserver\nglobal.ResizeObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// Mock IntersectionObserver\nglobal.IntersectionObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// Mock MutationObserver\nglobal.MutationObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  disconnect: jest.fn(),\n  takeRecords: jest.fn(),\n}));\n\n// Mock window.getComputedStyle\nglobal.getComputedStyle = jest.fn().mockImplementation(() => ({\n  getPropertyValue: jest.fn(),\n  setProperty: jest.fn(),\n}));\n\n// Mock window.requestAnimationFrame\nglobal.requestAnimationFrame = jest.fn().mockImplementation(cb => setTimeout(cb, 0));\nglobal.cancelAnimationFrame = jest.fn().mockImplementation(id => clearTimeout(id));\n\n// Mock window.requestIdleCallback\nglobal.requestIdleCallback = jest.fn().mockImplementation(cb => setTimeout(cb, 0));\nglobal.cancelIdleCallback = jest.fn().mockImplementation(id => clearTimeout(id));\n\n// Mock HTMLElement.offsetHeight, offsetWidth 등\nObject.defineProperties(HTMLElement.prototype, {\n  offsetHeight: {\n    get() { return parseFloat(this.style.height) || 0; }\n  },\n  offsetWidth: {\n    get() { return parseFloat(this.style.width) || 0; }\n  },\n  offsetTop: {\n    get() { return parseFloat(this.style.top) || 0; }\n  },\n  offsetLeft: {\n    get() { return parseFloat(this.style.left) || 0; }\n  },\n});\n\n// Mock window.location\ndelete window.location;\nwindow.location = {\n  href: 'http://localhost:3000',\n  origin: 'http://localhost:3000',\n  protocol: 'http:',\n  host: 'localhost:3000',\n  hostname: 'localhost',\n  port: '3000',\n  pathname: '/',\n  search: '',\n  hash: '',\n  assign: jest.fn(),\n  replace: jest.fn(),\n  reload: jest.fn(),\n};\n\n// Mock console methods to reduce noise in tests\nglobal.console = {\n  ...console,\n  log: jest.fn(),\n  warn: jest.fn(),\n  error: jest.fn(),\n};\n\n// Mock import.meta.env for Vite compatibility\nglobal.importMeta = {\n  env: {\n    NODE_ENV: 'test',\n    VITE_API_BASE_URL: 'http://localhost:3000',\n    VITE_AI_API_URL: 'http://localhost:3000/api/ai',\n  }\n};\n\n// Mock URL.createObjectURL and revokeObjectURL\nglobal.URL.createObjectURL = jest.fn(() => 'mocked-url');\nglobal.URL.revokeObjectURL = jest.fn();\n\n// Mock File and FileReader\nglobal.File = jest.fn().mockImplementation((bits, name, options) => ({\n  name,\n  size: bits.length,\n  type: options?.type || '',\n  lastModified: Date.now(),\n}));\n\nglobal.FileReader = jest.fn().mockImplementation(() => ({\n  readAsText: jest.fn(),\n  readAsDataURL: jest.fn(),\n  addEventListener: jest.fn(),\n  removeEventListener: jest.fn(),\n  result: null,\n  error: null,\n}));\n\n// Mock Clipboard API\nObject.defineProperty(navigator, 'clipboard', {\n  value: {\n    writeText: jest.fn().mockResolvedValue(undefined),\n    readText: jest.fn().mockResolvedValue(''),\n  },\n  writable: true,\n});\n\n// Mock navigator.userAgent\nObject.defineProperty(navigator, 'userAgent', {\n  value: 'Mozilla/5.0 (Node.js) Jest/Test',\n  writable: true,\n});\n\n// Mock window.crypto\nObject.defineProperty(window, 'crypto', {\n  value: {\n    getRandomValues: jest.fn().mockImplementation(arr => {\n      for (let i = 0; i < arr.length; i++) {\n        arr[i] = Math.floor(Math.random() * 256);\n      }\n      return arr;\n    }),\n    randomUUID: jest.fn().mockReturnValue('mocked-uuid-1234'),\n  },\n  writable: true,\n});\n\nconsole.log('✅ JSDOM 브라우저 API 폴리필 로드 완료 (2단계 - 테스트 환경 안정화)');\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\stores\\index.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":92,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":92,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2664,2698],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":109,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":109,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3099,3133],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'get' is defined but never used. Allowed unused args must match /^_/u.","line":119,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":119,"endColumn":32},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":150,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":150,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[4155,4187],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'get' is defined but never used. Allowed unused args must match /^_/u.","line":165,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { immer } from 'zustand/middleware/immer';\r\nimport { subscribeWithSelector } from 'zustand/middleware';\r\nimport { db } from '../utils/database';\r\n\r\n// Document slice\r\nconst createDocumentSlice = (set, get) => ({\r\n  // State\r\n  documents: {},\r\n  currentDocumentId: null,\r\n  isLoading: false,\r\n  saveStatus: '저장됨',\r\n  serverSaveStatus: '저장됨',\r\n  isSaving: false,\r\n  \r\n  // Document CRUD actions\r\n  setCurrentDocument: (id) => set((state) => {\r\n    state.currentDocumentId = id;\r\n  }),\r\n  \r\n  addDocument: (doc) => set((state) => {\r\n    state.documents[doc.id] = doc;\r\n  }),\r\n  \r\n  updateDocument: (id, updates) => set((state) => {\r\n    if (state.documents[id]) {\r\n      Object.assign(state.documents[id], updates, {\r\n        updatedAt: new Date().toISOString()\r\n      });\r\n    }\r\n  }),\r\n  \r\n  deleteDocument: (id) => set((state) => {\r\n    delete state.documents[id];\r\n    if (state.currentDocumentId === id) {\r\n      state.currentDocumentId = null;\r\n    }\r\n  }),\r\n  \r\n  // Title management with flags\r\n  setTitle: (id, title, isUserEdit = false) => set((state) => {\r\n    if (state.documents[id]) {\r\n      state.documents[id].title = title;\r\n      state.documents[id].isUserEditedTitle = isUserEdit;\r\n      state.documents[id].isAutoSyncedTitle = !isUserEdit;\r\n      state.documents[id].updatedAt = new Date().toISOString();\r\n    }\r\n  }),\r\n  \r\n  setContent: (id, content) => set((state) => {\r\n    if (state.documents[id]) {\r\n      state.documents[id].content = content;\r\n      state.documents[id].updatedAt = new Date().toISOString();\r\n      \r\n      // Auto-extract title if not user-edited\r\n      if (!state.documents[id].isUserEditedTitle) {\r\n        const extractedTitle = extractTitleFromContent(content);\r\n        if (extractedTitle && extractedTitle !== state.documents[id].title) {\r\n          state.documents[id].title = extractedTitle;\r\n          state.documents[id].isAutoSyncedTitle = true;\r\n        }\r\n      }\r\n    }\r\n  }),\r\n  \r\n  // Save status management\r\n  setSaveStatus: (status) => set((state) => {\r\n    state.saveStatus = status;\r\n  }),\r\n  \r\n  setServerSaveStatus: (status) => set((state) => {\r\n    state.serverSaveStatus = status;\r\n  }),\r\n  \r\n  setIsSaving: (saving) => set((state) => {\r\n    state.isSaving = saving;\r\n  }),\r\n  \r\n  // Async actions\r\n  loadDocuments: async () => {\r\n    set((state) => { state.isLoading = true; });\r\n    try {\r\n      const docs = await db.documents.toArray();\r\n      set((state) => {\r\n        state.documents = {};\r\n        docs.forEach(doc => {\r\n          state.documents[doc.id] = doc;\r\n        });\r\n        state.isLoading = false;\r\n      });\r\n    } catch (error) {\r\n      console.error('문서 로드 실패:', error);\r\n      set((state) => { state.isLoading = false; });\r\n    }\r\n  },\r\n  \r\n  saveDocument: async (id) => {\r\n    const doc = get().documents[id];\r\n    if (!doc) return;\r\n    \r\n    set((state) => { state.isSaving = true; });\r\n    try {\r\n      await db.documents.put(doc);\r\n      set((state) => { \r\n        state.saveStatus = '저장됨';\r\n        state.isSaving = false;\r\n      });\r\n    } catch (error) {\r\n      console.error('문서 저장 실패:', error);\r\n      set((state) => { \r\n        state.saveStatus = '저장 실패';\r\n        state.isSaving = false;\r\n      });\r\n    }\r\n  }\r\n});\r\n\r\n// UI slice\r\nconst createUISlice = (set, get) => ({\r\n  // State\r\n  isFullscreen: false,\r\n  searchQuery: '',\r\n  windowWidth: typeof window !== 'undefined' ? window.innerWidth : 0,\r\n  isMobile: false,\r\n  isTablet: false,\r\n  activeMobilePanel: 'editor',\r\n  message: { type: '', text: '' },\r\n  messageVisible: false,\r\n  \r\n  // Actions\r\n  setFullscreen: (fullscreen) => set((state) => {\r\n    state.isFullscreen = fullscreen;\r\n  }),\r\n  \r\n  setSearchQuery: (query) => set((state) => {\r\n    state.searchQuery = query;\r\n  }),\r\n  \r\n  setWindowDimensions: (width) => set((state) => {\r\n    state.windowWidth = width;\r\n    state.isMobile = width < 768;\r\n    state.isTablet = width >= 768 && width < 1024;\r\n  }),\r\n  \r\n  setActiveMobilePanel: (panel) => set((state) => {\r\n    state.activeMobilePanel = panel;\r\n    try {\r\n      localStorage.setItem('miki_active_mobile_panel', panel);\r\n    } catch (e) {\r\n      console.warn('패널 상태 저장 실패:', e);\r\n    }\r\n  }),\r\n  \r\n  showMessage: (type, text) => set((state) => {\r\n    state.message = { type, text };\r\n    state.messageVisible = true;\r\n  }),\r\n  \r\n  hideMessage: () => set((state) => {\r\n    state.messageVisible = false;\r\n  })\r\n});\r\n\r\n// Editor context slice\r\nconst createEditorSlice = (set, get) => ({\r\n  // State\r\n  editorContext: {\r\n    fullContent: '',\r\n    selection: null\r\n  },\r\n  \r\n  // Actions\r\n  setEditorContext: (context) => set((state) => {\r\n    state.editorContext = context;\r\n  })\r\n});\r\n\r\n// Helper function for title extraction\r\nconst extractTitleFromContent = (content) => {\r\n  if (!content || typeof content !== 'string') return '';\r\n  \r\n  const lines = content.split('\\n');\r\n  for (const line of lines) {\r\n    const trimmed = line.trim();\r\n    if (trimmed && !trimmed.startsWith('#')) {\r\n      // Remove markdown formatting\r\n      return trimmed\r\n        .replace(/\\*\\*(.*?)\\*\\*/g, '$1')\r\n        .replace(/\\*(.*?)\\*/g, '$1')\r\n        .replace(/`(.*?)`/g, '$1')\r\n        .replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1')\r\n        .replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g, '$1')\r\n        .substring(0, 50);\r\n    }\r\n  }\r\n  return '';\r\n};\r\n\r\n// Create the main store\r\nexport const useStore = create(\r\n  subscribeWithSelector(\r\n    immer((...a) => ({\r\n      ...createDocumentSlice(...a),\r\n      ...createUISlice(...a),\r\n      ...createEditorSlice(...a),\r\n      \r\n      // Reset method for testing\r\n      reset: () => a[0]((state) => {\r\n        // Reset document slice\r\n        state.documents = {};\r\n        state.currentDocumentId = null;\r\n        state.isLoading = false;\r\n        state.saveStatus = '저장됨';\r\n        state.serverSaveStatus = '저장됨';\r\n        state.isSaving = false;\r\n        \r\n        // Reset UI slice\r\n        state.isFullscreen = false;\r\n        state.searchQuery = '';\r\n        state.windowWidth = typeof window !== 'undefined' ? window.innerWidth : 0;\r\n        state.isMobile = false;\r\n        state.isTablet = false;\r\n        state.activeMobilePanel = 'editor';\r\n        state.message = { type: '', text: '' };\r\n        state.messageVisible = false;\r\n        \r\n        // Reset editor slice\r\n        state.editorContext = {\r\n          fullContent: '',\r\n          selection: null\r\n        };\r\n      })\r\n    }))\r\n  )\r\n);\r\n\r\n// Selectors for better performance\r\nexport const useCurrentDocument = () => useStore((state) => {\r\n  const currentId = state.currentDocumentId;\r\n  return currentId ? state.documents[currentId] : null;\r\n});\r\n\r\nexport const useDocumentList = () => useStore((state) => \r\n  Object.values(state.documents).sort((a, b) => \r\n    new Date(b.updatedAt) - new Date(a.updatedAt)\r\n  )\r\n);\r\n\r\nexport const useUIState = () => useStore((state) => ({\r\n  isFullscreen: state.isFullscreen,\r\n  searchQuery: state.searchQuery,\r\n  windowWidth: state.windowWidth,\r\n  isMobile: state.isMobile,\r\n  isTablet: state.isTablet,\r\n  activeMobilePanel: state.activeMobilePanel,\r\n  message: state.message,\r\n  messageVisible: state.messageVisible\r\n}));\r\n\r\n// Individual store hooks for App.jsx compatibility\r\nexport const useDocumentStore = () => useStore((state) => ({\r\n  documents: Object.values(state.documents),\r\n  currentDocument: state.currentDocumentId ? state.documents[state.currentDocumentId] : null,\r\n  setCurrentDocument: (doc) => state.setCurrentDocument(doc?.id || doc),\r\n  updateDocument: state.updateDocument,\r\n  addDocument: state.addDocument,\r\n  deleteDocument: state.deleteDocument,\r\n  loadDocuments: state.loadDocuments,\r\n}));\r\n\r\nexport const useUIStore = () => useStore((state) => ({\r\n  sidebarOpen: false, // 기본값\r\n  theme: 'light', // 기본값\r\n  isFullscreen: state.isFullscreen,\r\n  toggleSidebar: () => {}, // 기본 구현\r\n  setTheme: () => {}, // 기본 구현\r\n  toggleFullscreen: () => state.setFullscreen(!state.isFullscreen),\r\n}));\r\n\r\nexport const useEditorStore = () => useStore((state) => ({\r\n  content: state.currentDocumentId ? state.documents[state.currentDocumentId]?.content || '' : '',\r\n  title: state.currentDocumentId ? state.documents[state.currentDocumentId]?.title || '' : '',\r\n  isEditing: false, // 기본값\r\n  saveStatus: state.saveStatus,\r\n  setContent: (content) => {\r\n    if (state.currentDocumentId) {\r\n      state.setContent(state.currentDocumentId, content);\r\n    }\r\n  },\r\n  setTitle: (title) => {\r\n    if (state.currentDocumentId) {\r\n      state.setTitle(state.currentDocumentId, title, true);\r\n    }\r\n  },\r\n  setEditing: () => {}, // 기본 구현\r\n  setSaveStatus: state.setSaveStatus,\r\n})); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\sync\\conflict.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":17,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":17,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[442,499],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":24,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":24,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[687,739],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[931,984],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1151,1208],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":43,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":43,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1289,1325],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'operation' is defined but never used. Allowed unused args must match /^_/u.","line":58,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'operation' is defined but never used. Allowed unused args must match /^_/u.","line":334,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":334,"endColumn":49},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":337,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":337,"endColumn":58},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":338,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":338,"endColumn":60}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ConflictResolver - 문서 충돌 해결 모듈\r\n */\r\nexport class ConflictResolver {\r\n  constructor(options = {}) {\r\n    this.strategy = options.strategy || 'last-write-wins';\r\n    this.autoResolve = options.autoResolve !== false;\r\n    this.userPromptTimeout = options.userPromptTimeout || 30000; // 30초\r\n  }\r\n  \r\n  /**\r\n   * 충돌 해결 메인 메서드\r\n   */\r\n  async resolve(conflict) {\r\n    const { documentId, local, server, operation } = conflict;\r\n    \r\n    console.log(`🔄 충돌 해결 시작: ${documentId} (${operation})`);\r\n    \r\n    try {\r\n      // 1. 자동 해결 가능한지 확인\r\n      const autoResolution = this.tryAutoResolve(local, server, operation);\r\n      \r\n      if (autoResolution && this.autoResolve) {\r\n        console.log(`✅ 자동 충돌 해결: ${autoResolution.action}`);\r\n        return autoResolution;\r\n      }\r\n      \r\n      // 2. 사용자 개입 필요\r\n      const userResolution = await this.promptUserResolution(conflict);\r\n      \r\n      if (userResolution) {\r\n        console.log(`✅ 사용자 충돌 해결: ${userResolution.action}`);\r\n        return userResolution;\r\n      }\r\n      \r\n      // 3. 기본 전략 적용\r\n      const fallbackResolution = this.applyFallbackStrategy(local, server, operation);\r\n      console.log(`⚠️ 기본 전략 적용: ${fallbackResolution.action}`);\r\n      \r\n      return fallbackResolution;\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 충돌 해결 실패:', error);\r\n      \r\n      // 최후의 수단: 로컬 데이터 유지\r\n      return {\r\n        action: 'use_local',\r\n        data: local,\r\n        reason: '충돌 해결 실패로 인한 로컬 데이터 보존',\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 자동 해결 시도\r\n   */\r\n  tryAutoResolve(local, server, operation) {\r\n    // 1. 내용이 동일한 경우\r\n    if (this.isContentEqual(local, server)) {\r\n      return {\r\n        action: 'no_conflict',\r\n        data: local,\r\n        reason: '내용이 동일함'\r\n      };\r\n    }\r\n    \r\n    // 2. 한쪽이 비어있는 경우\r\n    if (this.isEmpty(local) && !this.isEmpty(server)) {\r\n      return {\r\n        action: 'use_server',\r\n        data: server,\r\n        reason: '로컬 데이터가 비어있음'\r\n      };\r\n    }\r\n    \r\n    if (!this.isEmpty(local) && this.isEmpty(server)) {\r\n      return {\r\n        action: 'use_local',\r\n        data: local,\r\n        reason: '서버 데이터가 비어있음'\r\n      };\r\n    }\r\n    \r\n    // 3. 단순 추가만 있는 경우 (텍스트 끝에 내용 추가)\r\n    const mergeResult = this.trySimpleMerge(local, server);\r\n    if (mergeResult) {\r\n      return {\r\n        action: 'merge',\r\n        data: mergeResult,\r\n        reason: '단순 병합 가능'\r\n      };\r\n    }\r\n    \r\n    // 4. 타임스탬프 기반 판단\r\n    if (local.updatedAt && server.updatedAt) {\r\n      const localTime = new Date(local.updatedAt);\r\n      const serverTime = new Date(server.updatedAt);\r\n      const timeDiff = Math.abs(localTime - serverTime);\r\n      \r\n      // 시간 차이가 1초 미만이면 내용 길이로 판단\r\n      if (timeDiff < 1000) {\r\n        const localLength = (local.content || '').length;\r\n        const serverLength = (server.content || '').length;\r\n        \r\n        if (localLength > serverLength) {\r\n          return {\r\n            action: 'use_local',\r\n            data: local,\r\n            reason: '동시 편집 시 더 긴 내용 선택'\r\n          };\r\n        } else {\r\n          return {\r\n            action: 'use_server',\r\n            data: server,\r\n            reason: '동시 편집 시 더 긴 내용 선택'\r\n          };\r\n        }\r\n      }\r\n    }\r\n    \r\n    return null; // 자동 해결 불가\r\n  }\r\n  \r\n  /**\r\n   * 단순 병합 시도\r\n   */\r\n  trySimpleMerge(local, server) {\r\n    const localContent = local.content || '';\r\n    const serverContent = server.content || '';\r\n    \r\n    // 한쪽이 다른 쪽의 부분집합인지 확인\r\n    if (localContent.includes(serverContent)) {\r\n      return {\r\n        ...local,\r\n        content: localContent,\r\n        title: local.title || server.title\r\n      };\r\n    }\r\n    \r\n    if (serverContent.includes(localContent)) {\r\n      return {\r\n        ...server,\r\n        content: serverContent,\r\n        title: server.title || local.title\r\n      };\r\n    }\r\n    \r\n    // 공통 접두사/접미사 찾기\r\n    const commonPrefix = this.findCommonPrefix(localContent, serverContent);\r\n    const commonSuffix = this.findCommonSuffix(localContent, serverContent);\r\n    \r\n    if (commonPrefix.length > 10 || commonSuffix.length > 10) {\r\n      // 간단한 3-way merge 시도\r\n      const localMiddle = localContent.slice(\r\n        commonPrefix.length, \r\n        localContent.length - commonSuffix.length\r\n      );\r\n      const serverMiddle = serverContent.slice(\r\n        commonPrefix.length, \r\n        serverContent.length - commonSuffix.length\r\n      );\r\n      \r\n      // 중간 부분을 합치기\r\n      const mergedContent = commonPrefix + localMiddle + '\\n' + serverMiddle + commonSuffix;\r\n      \r\n      return {\r\n        ...local,\r\n        content: mergedContent,\r\n        title: local.title || server.title,\r\n        mergedAt: new Date().toISOString()\r\n      };\r\n    }\r\n    \r\n    return null;\r\n  }\r\n  \r\n  /**\r\n   * 사용자 해결 프롬프트\r\n   */\r\n  async promptUserResolution(conflict) {\r\n    return new Promise((resolve) => {\r\n      const { documentId, local, server } = conflict;\r\n      \r\n      // 충돌 해결 UI 표시\r\n      const modal = this.createConflictModal(documentId, local, server);\r\n      document.body.appendChild(modal);\r\n      \r\n      // 타임아웃 설정\r\n      const timeout = setTimeout(() => {\r\n        document.body.removeChild(modal);\r\n        resolve(null); // 타임아웃 시 null 반환\r\n      }, this.userPromptTimeout);\r\n      \r\n      // 사용자 선택 처리\r\n      const handleChoice = (choice, data) => {\r\n        clearTimeout(timeout);\r\n        document.body.removeChild(modal);\r\n        resolve({\r\n          action: choice,\r\n          data: data,\r\n          reason: '사용자 선택'\r\n        });\r\n      };\r\n      \r\n      // 버튼 이벤트 리스너\r\n      modal.querySelector('.use-local').onclick = () => \r\n        handleChoice('use_local', local);\r\n      \r\n      modal.querySelector('.use-server').onclick = () => \r\n        handleChoice('use_server', server);\r\n      \r\n      modal.querySelector('.merge-manual').onclick = () => {\r\n        const mergedData = this.showMergeEditor(local, server);\r\n        handleChoice('merge', mergedData);\r\n      };\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * 충돌 해결 모달 생성\r\n   */\r\n  createConflictModal(documentId, local, server) {\r\n    const modal = document.createElement('div');\r\n    modal.className = 'conflict-resolution-modal';\r\n    modal.innerHTML = `\r\n      <div class=\"modal-overlay\">\r\n        <div class=\"modal-content\">\r\n          <h3>📄 문서 충돌 감지</h3>\r\n          <p>문서 \"${local.title || documentId}\"에서 충돌이 발생했습니다.</p>\r\n          \r\n          <div class=\"conflict-comparison\">\r\n            <div class=\"local-version\">\r\n              <h4>🖥️ 로컬 버전</h4>\r\n              <div class=\"content-preview\">${this.truncateContent(local.content)}</div>\r\n              <small>수정: ${new Date(local.updatedAt).toLocaleString()}</small>\r\n            </div>\r\n            \r\n            <div class=\"server-version\">\r\n              <h4>☁️ 서버 버전</h4>\r\n              <div class=\"content-preview\">${this.truncateContent(server.content)}</div>\r\n              <small>수정: ${new Date(server.updatedAt).toLocaleString()}</small>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"resolution-buttons\">\r\n            <button class=\"use-local\">로컬 버전 사용</button>\r\n            <button class=\"use-server\">서버 버전 사용</button>\r\n            <button class=\"merge-manual\">수동 병합</button>\r\n          </div>\r\n          \r\n          <p class=\"timeout-warning\">30초 후 자동으로 로컬 버전이 선택됩니다.</p>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    // 스타일 추가\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n      .conflict-resolution-modal {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        z-index: 10000;\r\n      }\r\n      .modal-overlay {\r\n        background: rgba(0,0,0,0.7);\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n      }\r\n      .modal-content {\r\n        background: white;\r\n        padding: 20px;\r\n        border-radius: 8px;\r\n        max-width: 600px;\r\n        max-height: 80vh;\r\n        overflow-y: auto;\r\n      }\r\n      .conflict-comparison {\r\n        display: flex;\r\n        gap: 20px;\r\n        margin: 20px 0;\r\n      }\r\n      .local-version, .server-version {\r\n        flex: 1;\r\n        border: 1px solid #ddd;\r\n        padding: 10px;\r\n        border-radius: 4px;\r\n      }\r\n      .content-preview {\r\n        background: #f5f5f5;\r\n        padding: 10px;\r\n        border-radius: 4px;\r\n        font-family: monospace;\r\n        font-size: 12px;\r\n        max-height: 150px;\r\n        overflow-y: auto;\r\n        white-space: pre-wrap;\r\n      }\r\n      .resolution-buttons {\r\n        display: flex;\r\n        gap: 10px;\r\n        justify-content: center;\r\n        margin: 20px 0;\r\n      }\r\n      .resolution-buttons button {\r\n        padding: 10px 20px;\r\n        border: none;\r\n        border-radius: 4px;\r\n        cursor: pointer;\r\n      }\r\n      .use-local { background: #4CAF50; color: white; }\r\n      .use-server { background: #2196F3; color: white; }\r\n      .merge-manual { background: #FF9800; color: white; }\r\n      .timeout-warning {\r\n        text-align: center;\r\n        color: #666;\r\n        font-size: 12px;\r\n      }\r\n    `;\r\n    modal.appendChild(style);\r\n    \r\n    return modal;\r\n  }\r\n  \r\n  /**\r\n   * 기본 전략 적용\r\n   */\r\n  applyFallbackStrategy(local, server, operation) {\r\n    switch (this.strategy) {\r\n      case 'last-write-wins':\r\n        const localTime = new Date(local.updatedAt || 0);\r\n        const serverTime = new Date(server.updatedAt || 0);\r\n        \r\n        return localTime >= serverTime ? {\r\n          action: 'use_local',\r\n          data: local,\r\n          reason: 'Last-Write-Wins: 로컬이 더 최신'\r\n        } : {\r\n          action: 'use_server',\r\n          data: server,\r\n          reason: 'Last-Write-Wins: 서버가 더 최신'\r\n        };\r\n        \r\n      case 'prefer-local':\r\n        return {\r\n          action: 'use_local',\r\n          data: local,\r\n          reason: 'Prefer-Local 전략'\r\n        };\r\n        \r\n      case 'prefer-server':\r\n        return {\r\n          action: 'use_server',\r\n          data: server,\r\n          reason: 'Prefer-Server 전략'\r\n        };\r\n        \r\n      default:\r\n        return {\r\n          action: 'use_local',\r\n          data: local,\r\n          reason: '알 수 없는 전략으로 인한 로컬 선택'\r\n        };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 유틸리티 메서드들\r\n   */\r\n  isContentEqual(local, server) {\r\n    return (local.content || '').trim() === (server.content || '').trim() &&\r\n           (local.title || '').trim() === (server.title || '').trim();\r\n  }\r\n  \r\n  isEmpty(data) {\r\n    return !data || \r\n           (!data.content || data.content.trim() === '') &&\r\n           (!data.title || data.title.trim() === '');\r\n  }\r\n  \r\n  findCommonPrefix(str1, str2) {\r\n    let i = 0;\r\n    while (i < str1.length && i < str2.length && str1[i] === str2[i]) {\r\n      i++;\r\n    }\r\n    return str1.slice(0, i);\r\n  }\r\n  \r\n  findCommonSuffix(str1, str2) {\r\n    let i = 0;\r\n    while (i < str1.length && i < str2.length && \r\n           str1[str1.length - 1 - i] === str2[str2.length - 1 - i]) {\r\n      i++;\r\n    }\r\n    return str1.slice(str1.length - i);\r\n  }\r\n  \r\n  truncateContent(content, maxLength = 200) {\r\n    if (!content) return '(내용 없음)';\r\n    return content.length > maxLength ? \r\n           content.slice(0, maxLength) + '...' : \r\n           content;\r\n  }\r\n}\r\n\r\n/**\r\n * 충돌 해결기 팩토리\r\n */\r\nexport const createConflictResolver = (options = {}) => {\r\n  return new ConflictResolver(options);\r\n};\r\n\r\n/**\r\n * 기본 충돌 해결기 인스턴스\r\n */\r\nexport const defaultConflictResolver = new ConflictResolver(); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\sync\\httpAdapter.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":31,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":31,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[801,858],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":58,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":58,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1616,1682],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":62,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":62,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1743,1798],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'options' is assigned a value but never used.","line":104,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":104,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * HttpAdapter - REST API 통신 어댑터\r\n */\r\nexport class HttpAdapter {\r\n  constructor(options = {}) {\r\n    this.baseURL = options.baseURL || 'http://localhost:3003/api';\r\n    this.timeout = options.timeout || 10000;\r\n    this.headers = {\r\n      'Content-Type': 'application/json',\r\n      ...options.headers\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * HTTP 요청 공통 처리\r\n   */\r\n  async request(method, endpoint, data = null, options = {}) {\r\n    const url = `${this.baseURL}${endpoint}`;\r\n    const config = {\r\n      method,\r\n      headers: { ...this.headers, ...options.headers },\r\n      signal: AbortSignal.timeout(this.timeout),\r\n      ...options\r\n    };\r\n    \r\n    if (data && (method === 'POST' || method === 'PUT' || method === 'PATCH')) {\r\n      config.body = JSON.stringify(data);\r\n    }\r\n    \r\n    try {\r\n      console.log(`🌐 ${method} ${url}`, data ? { data } : '');\r\n      \r\n      const response = await fetch(url, config);\r\n      \r\n      // ETag 헤더 처리 (캐시 무결성)\r\n      const etag = response.headers.get('ETag');\r\n      const lastModified = response.headers.get('Last-Modified');\r\n      \r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        const error = new Error(errorData.message || `HTTP ${response.status}`);\r\n        error.status = response.status;\r\n        error.data = errorData;\r\n        throw error;\r\n      }\r\n      \r\n      const result = await response.json();\r\n      \r\n      // 메타데이터 추가\r\n      if (etag || lastModified) {\r\n        result._meta = {\r\n          etag,\r\n          lastModified,\r\n          status: response.status\r\n        };\r\n      }\r\n      \r\n      console.log(`✅ ${method} ${url} 성공`, { status: response.status });\r\n      return result;\r\n      \r\n    } catch (error) {\r\n      console.error(`❌ ${method} ${url} 실패:`, error.message);\r\n      \r\n      // 네트워크 오류 표준화\r\n      if (error.name === 'AbortError') {\r\n        const timeoutError = new Error('요청 시간 초과');\r\n        timeoutError.name = 'TimeoutError';\r\n        timeoutError.code = 'TIMEOUT';\r\n        throw timeoutError;\r\n      }\r\n      \r\n      if (error.name === 'TypeError' && error.message.includes('fetch')) {\r\n        const networkError = new Error('네트워크 연결 실패');\r\n        networkError.name = 'NetworkError';\r\n        networkError.code = 'NETWORK_ERROR';\r\n        throw networkError;\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 문서 생성\r\n   */\r\n  async createDocument(data) {\r\n    return await this.request('POST', '/posts', {\r\n      title: data.title || '제목 없음',\r\n      content: data.content || '',\r\n      ...data\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * 문서 조회\r\n   */\r\n  async getDocument(id) {\r\n    return await this.request('GET', `/posts/${id}`);\r\n  }\r\n  \r\n  /**\r\n   * 문서 업데이트 (ETag 기반 충돌 감지)\r\n   */\r\n  async updateDocument(id, data, options = {}) {\r\n    const headers = {};\r\n    \r\n    // ETag 기반 조건부 업데이트\r\n    if (data._meta?.etag) {\r\n      headers['If-Match'] = data._meta.etag;\r\n    }\r\n    \r\n    // Last-Modified 기반 조건부 업데이트\r\n    if (data._meta?.lastModified) {\r\n      headers['If-Unmodified-Since'] = data._meta.lastModified;\r\n    }\r\n    \r\n    return await this.request('PUT', `/posts/${id}`, {\r\n      title: data.title,\r\n      content: data.content,\r\n      updatedAt: data.updatedAt || new Date().toISOString(),\r\n      ...data\r\n    }, { headers });\r\n  }\r\n  \r\n  /**\r\n   * 문서 삭제\r\n   */\r\n  async deleteDocument(id) {\r\n    return await this.request('DELETE', `/posts/${id}`);\r\n  }\r\n  \r\n  /**\r\n   * 문서 목록 조회\r\n   */\r\n  async getDocuments(options = {}) {\r\n    const params = new URLSearchParams();\r\n    \r\n    if (options.limit) params.append('limit', options.limit);\r\n    if (options.offset) params.append('offset', options.offset);\r\n    if (options.search) params.append('search', options.search);\r\n    if (options.since) params.append('since', options.since);\r\n    \r\n    const query = params.toString();\r\n    const endpoint = query ? `/posts?${query}` : '/posts';\r\n    \r\n    return await this.request('GET', endpoint);\r\n  }\r\n  \r\n  /**\r\n   * 서버 상태 확인\r\n   */\r\n  async healthCheck() {\r\n    try {\r\n      const result = await this.request('GET', '/health', null, { \r\n        timeout: 5000 \r\n      });\r\n      return { status: 'ok', ...result };\r\n    } catch (error) {\r\n      return { \r\n        status: 'error', \r\n        error: error.message,\r\n        code: error.code \r\n      };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 동기화 상태 조회\r\n   */\r\n  async getSyncStatus(documentIds = []) {\r\n    if (documentIds.length === 0) {\r\n      return await this.request('GET', '/sync/status');\r\n    }\r\n    \r\n    return await this.request('POST', '/sync/status', {\r\n      documentIds\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * 배치 업데이트 (여러 문서 한번에)\r\n   */\r\n  async batchUpdate(documents) {\r\n    return await this.request('POST', '/posts/batch', {\r\n      documents: documents.map(doc => ({\r\n        id: doc.id,\r\n        title: doc.title,\r\n        content: doc.content,\r\n        updatedAt: doc.updatedAt\r\n      }))\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * 충돌 해결을 위한 서버 데이터 조회\r\n   */\r\n  async getDocumentRevision(id, revision) {\r\n    return await this.request('GET', `/posts/${id}/revisions/${revision}`);\r\n  }\r\n  \r\n  /**\r\n   * 검색\r\n   */\r\n  async searchDocuments(query, options = {}) {\r\n    const params = new URLSearchParams({\r\n      q: query,\r\n      limit: options.limit || 20,\r\n      offset: options.offset || 0\r\n    });\r\n    \r\n    if (options.fields) {\r\n      params.append('fields', options.fields.join(','));\r\n    }\r\n    \r\n    return await this.request('GET', `/search?${params.toString()}`);\r\n  }\r\n}\r\n\r\n/**\r\n * HTTP 어댑터 팩토리\r\n */\r\nexport const createHttpAdapter = (options = {}) => {\r\n  return new HttpAdapter(options);\r\n};\r\n\r\n/**\r\n * 기본 HTTP 어댑터 인스턴스\r\n */\r\nexport const defaultHttpAdapter = new HttpAdapter(); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\sync\\index.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[996,1023],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":44,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":44,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1158,1187],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":85,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":85,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2128,2165],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":128,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":128,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3313,3353],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":189,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":189,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5071,5115],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":206,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":206,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5458,5512],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":216,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":216,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5765,5800],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":299,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":299,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7434,7483],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { HttpAdapter } from './httpAdapter';\r\nimport { WebSocketAdapter } from './wsAdapter';\r\nimport { SyncQueue } from '../utils/database';\r\nimport { ConflictResolver } from './conflict';\r\n\r\n/**\r\n * SyncManager - 중앙화된 동기화 관리자\r\n * \r\n * 역할:\r\n * - 로컬 IndexedDB와 원격 서버 간 데이터 동기화\r\n * - 네트워크 상태 감지 및 오프라인 큐 관리\r\n * - 충돌 해결 및 재시도 로직\r\n */\r\nexport class SyncManager {\r\n  constructor(options = {}) {\r\n    this.httpAdapter = options.httpAdapter || new HttpAdapter();\r\n    this.wsAdapter = options.wsAdapter || new WebSocketAdapter();\r\n    this.conflictResolver = options.conflictResolver || new ConflictResolver();\r\n    \r\n    this.isOnline = navigator.onLine;\r\n    this.syncInProgress = false;\r\n    this.syncInterval = null;\r\n    this.retryTimeout = null;\r\n    \r\n    // Event listeners\r\n    this.listeners = {\r\n      sync: [],\r\n      conflict: [],\r\n      error: []\r\n    };\r\n    \r\n    this.init();\r\n  }\r\n  \r\n  init() {\r\n    // Network status monitoring\r\n    window.addEventListener('online', () => {\r\n      console.log('🌐 네트워크 연결됨');\r\n      this.isOnline = true;\r\n      this.processPendingQueue();\r\n    });\r\n    \r\n    window.addEventListener('offline', () => {\r\n      console.log('📴 네트워크 연결 끊김');\r\n      this.isOnline = false;\r\n    });\r\n    \r\n    // Start periodic sync\r\n    this.startPeriodicSync();\r\n    \r\n    // WebSocket connection for real-time sync\r\n    if (this.isOnline) {\r\n      this.wsAdapter.connect();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 문서 동기화 (Optimistic UI 패턴)\r\n   */\r\n  async syncDocument(documentId, operation = 'update', data = {}) {\r\n    try {\r\n      // 1. 로컬 큐에 추가 (오프라인 대비)\r\n      await SyncQueue.enqueue(documentId, operation, data);\r\n      \r\n      // 2. 온라인 상태면 즉시 동기화 시도\r\n      if (this.isOnline) {\r\n        return await this.processSyncItem({\r\n          documentId,\r\n          operation,\r\n          data: JSON.stringify(data)\r\n        });\r\n      }\r\n      \r\n      // 3. 오프라인이면 큐에만 저장\r\n      this.emit('sync', {\r\n        status: 'queued',\r\n        documentId,\r\n        operation,\r\n        message: '오프라인 상태 - 큐에 저장됨'\r\n      });\r\n      \r\n      return { success: true, queued: true };\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 문서 동기화 실패:', error);\r\n      this.emit('error', { documentId, operation, error: error.message });\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 개별 동기화 항목 처리\r\n   */\r\n  async processSyncItem(item) {\r\n    try {\r\n      const data = JSON.parse(item.data || '{}');\r\n      let result;\r\n      \r\n      switch (item.operation) {\r\n        case 'create':\r\n          result = await this.httpAdapter.createDocument(data);\r\n          break;\r\n        case 'update':\r\n          result = await this.httpAdapter.updateDocument(item.documentId, data);\r\n          break;\r\n        case 'delete':\r\n          result = await this.httpAdapter.deleteDocument(item.documentId);\r\n          break;\r\n        default:\r\n          throw new Error(`알 수 없는 작업: ${item.operation}`);\r\n      }\r\n      \r\n      // 성공 시 큐에서 제거\r\n      if (item.queueId) {\r\n        await SyncQueue.markAsCompleted(item.queueId);\r\n      }\r\n      \r\n      this.emit('sync', {\r\n        status: 'completed',\r\n        documentId: item.documentId,\r\n        operation: item.operation,\r\n        result\r\n      });\r\n      \r\n      return { success: true, result };\r\n      \r\n    } catch (error) {\r\n      console.error(`❌ 동기화 항목 처리 실패:`, error);\r\n      \r\n      // 충돌 감지 (409 Conflict)\r\n      if (error.status === 409) {\r\n        return await this.handleConflict(item, error);\r\n      }\r\n      \r\n      // 재시도 가능한 오류 (5xx, 네트워크 오류)\r\n      if (this.isRetryableError(error)) {\r\n        if (item.queueId) {\r\n          await SyncQueue.markAsFailed(item.queueId, error.message);\r\n        }\r\n        return { success: false, retry: true, error: error.message };\r\n      }\r\n      \r\n      // 재시도 불가능한 오류 (4xx)\r\n      if (item.queueId) {\r\n        await SyncQueue.markAsFailed(item.queueId, error.message);\r\n      }\r\n      \r\n      this.emit('error', {\r\n        documentId: item.documentId,\r\n        operation: item.operation,\r\n        error: error.message\r\n      });\r\n      \r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 충돌 처리\r\n   */\r\n  async handleConflict(item, error) {\r\n    try {\r\n      const serverData = error.data || {};\r\n      const localData = JSON.parse(item.data || '{}');\r\n      \r\n      const resolution = await this.conflictResolver.resolve({\r\n        documentId: item.documentId,\r\n        local: localData,\r\n        server: serverData,\r\n        operation: item.operation\r\n      });\r\n      \r\n      this.emit('conflict', {\r\n        documentId: item.documentId,\r\n        resolution,\r\n        local: localData,\r\n        server: serverData\r\n      });\r\n      \r\n      // 해결된 데이터로 재시도\r\n      if (resolution.action === 'merge' || resolution.action === 'use_local') {\r\n        const mergedData = resolution.data || localData;\r\n        return await this.httpAdapter.updateDocument(item.documentId, mergedData);\r\n      }\r\n      \r\n      return { success: true, conflict: true, resolution };\r\n      \r\n    } catch (conflictError) {\r\n      console.error('❌ 충돌 해결 실패:', conflictError);\r\n      return { success: false, error: conflictError.message };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 대기 중인 큐 처리\r\n   */\r\n  async processPendingQueue() {\r\n    if (this.syncInProgress || !this.isOnline) {\r\n      return;\r\n    }\r\n    \r\n    this.syncInProgress = true;\r\n    \r\n    try {\r\n      const pendingItems = await SyncQueue.getPendingItems();\r\n      console.log(`📤 처리할 동기화 항목: ${pendingItems.length}개`);\r\n      \r\n      for (const item of pendingItems) {\r\n        await this.processSyncItem(item);\r\n        \r\n        // Rate limiting - 100ms 간격\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 큐 처리 실패:', error);\r\n    } finally {\r\n      this.syncInProgress = false;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 주기적 동기화 시작\r\n   */\r\n  startPeriodicSync(interval = 30000) { // 30초\r\n    if (this.syncInterval) {\r\n      clearInterval(this.syncInterval);\r\n    }\r\n    \r\n    this.syncInterval = setInterval(() => {\r\n      if (this.isOnline && !this.syncInProgress) {\r\n        this.processPendingQueue();\r\n      }\r\n    }, interval);\r\n  }\r\n  \r\n  /**\r\n   * 주기적 동기화 중지\r\n   */\r\n  stopPeriodicSync() {\r\n    if (this.syncInterval) {\r\n      clearInterval(this.syncInterval);\r\n      this.syncInterval = null;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 재시도 가능한 오류 판단\r\n   */\r\n  isRetryableError(error) {\r\n    // 5xx 서버 오류\r\n    if (error.status >= 500 && error.status < 600) {\r\n      return true;\r\n    }\r\n    \r\n    // 네트워크 오류\r\n    if (error.name === 'NetworkError' || error.code === 'NETWORK_ERROR') {\r\n      return true;\r\n    }\r\n    \r\n    // 타임아웃\r\n    if (error.name === 'TimeoutError' || error.code === 'TIMEOUT') {\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n  \r\n  /**\r\n   * 이벤트 리스너 등록\r\n   */\r\n  on(event, callback) {\r\n    if (this.listeners[event]) {\r\n      this.listeners[event].push(callback);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 이벤트 리스너 제거\r\n   */\r\n  off(event, callback) {\r\n    if (this.listeners[event]) {\r\n      const index = this.listeners[event].indexOf(callback);\r\n      if (index > -1) {\r\n        this.listeners[event].splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 이벤트 발생\r\n   */\r\n  emit(event, data) {\r\n    if (this.listeners[event]) {\r\n      this.listeners[event].forEach(callback => {\r\n        try {\r\n          callback(data);\r\n        } catch (error) {\r\n          console.error(`❌ 이벤트 리스너 오류 (${event}):`, error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 동기화 상태 조회\r\n   */\r\n  async getStatus() {\r\n    const pendingItems = await SyncQueue.getPendingItems();\r\n    const failedItems = await SyncQueue.getFailedItems?.() || [];\r\n    \r\n    return {\r\n      isOnline: this.isOnline,\r\n      syncInProgress: this.syncInProgress,\r\n      pendingCount: pendingItems.length,\r\n      failedCount: failedItems.length,\r\n      wsConnected: this.wsAdapter.isConnected()\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * 강제 동기화\r\n   */\r\n  async forcSync() {\r\n    if (!this.isOnline) {\r\n      throw new Error('오프라인 상태에서는 동기화할 수 없습니다.');\r\n    }\r\n    \r\n    return await this.processPendingQueue();\r\n  }\r\n  \r\n  /**\r\n   * 정리\r\n   */\r\n  destroy() {\r\n    this.stopPeriodicSync();\r\n    \r\n    if (this.retryTimeout) {\r\n      clearTimeout(this.retryTimeout);\r\n    }\r\n    \r\n    this.wsAdapter.disconnect();\r\n    \r\n    window.removeEventListener('online', this.handleOnline);\r\n    window.removeEventListener('offline', this.handleOffline);\r\n    \r\n    this.listeners = { sync: [], conflict: [], error: [] };\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet syncManagerInstance = null;\r\n\r\n/**\r\n * SyncManager 싱글톤 인스턴스 가져오기\r\n */\r\nexport const getSyncManager = (options = {}) => {\r\n  if (!syncManagerInstance) {\r\n    syncManagerInstance = new SyncManager(options);\r\n  }\r\n  return syncManagerInstance;\r\n};\r\n\r\n/**\r\n * SyncManager 인스턴스 재설정 (테스트용)\r\n */\r\nexport const resetSyncManager = () => {\r\n  if (syncManagerInstance) {\r\n    syncManagerInstance.destroy();\r\n    syncManagerInstance = null;\r\n  }\r\n}; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\sync\\wsAdapter.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":33,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":33,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[854,889],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[936,983],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":47,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":47,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1290,1333],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":56,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":56,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1442,1476],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":82,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":82,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[1999,2047],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":94,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":94,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2264,2314],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":98,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":98,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2373,2420],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":139,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":139,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3119,3152],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":154,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":154,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3424,3490],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":177,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":177,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4054,4103],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":181,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":181,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4151,4198],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":189,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":189,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4273,4340],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":210,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":210,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4728,4768],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":219,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":219,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4939,5004],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":229,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":229,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5208,5303],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":306,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":306,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6861,6920],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * WebSocketAdapter - 실시간 동기화를 위한 WebSocket 어댑터\r\n */\r\nexport class WebSocketAdapter {\r\n  constructor(options = {}) {\r\n    this.url = options.url || 'ws://localhost:3003/ws';\r\n    this.reconnectInterval = options.reconnectInterval || 5000;\r\n    this.maxReconnectAttempts = options.maxReconnectAttempts || 10;\r\n    this.heartbeatInterval = options.heartbeatInterval || 30000;\r\n    \r\n    this.ws = null;\r\n    this.isConnected = false;\r\n    this.reconnectAttempts = 0;\r\n    this.reconnectTimer = null;\r\n    this.heartbeatTimer = null;\r\n    \r\n    this.listeners = {\r\n      connect: [],\r\n      disconnect: [],\r\n      message: [],\r\n      error: [],\r\n      documentUpdate: [],\r\n      documentDelete: [],\r\n      conflict: []\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * WebSocket 연결\r\n   */\r\n  connect() {\r\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\r\n      console.log('🔌 WebSocket 이미 연결됨');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      console.log(`🔌 WebSocket 연결 시도: ${this.url}`);\r\n      this.ws = new WebSocket(this.url);\r\n      \r\n      this.ws.onopen = this.handleOpen.bind(this);\r\n      this.ws.onmessage = this.handleMessage.bind(this);\r\n      this.ws.onclose = this.handleClose.bind(this);\r\n      this.ws.onerror = this.handleError.bind(this);\r\n      \r\n    } catch (error) {\r\n      console.error('❌ WebSocket 연결 실패:', error);\r\n      this.scheduleReconnect();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * WebSocket 연결 해제\r\n   */\r\n  disconnect() {\r\n    console.log('🔌 WebSocket 연결 해제');\r\n    \r\n    this.clearTimers();\r\n    \r\n    if (this.ws) {\r\n      this.ws.onopen = null;\r\n      this.ws.onmessage = null;\r\n      this.ws.onclose = null;\r\n      this.ws.onerror = null;\r\n      \r\n      if (this.ws.readyState === WebSocket.OPEN) {\r\n        this.ws.close(1000, 'Client disconnect');\r\n      }\r\n      \r\n      this.ws = null;\r\n    }\r\n    \r\n    this.isConnected = false;\r\n    this.reconnectAttempts = 0;\r\n  }\r\n  \r\n  /**\r\n   * 메시지 전송\r\n   */\r\n  send(type, data = {}) {\r\n    if (!this.isConnected || !this.ws) {\r\n      console.warn('⚠️ WebSocket 연결되지 않음, 메시지 전송 실패');\r\n      return false;\r\n    }\r\n    \r\n    try {\r\n      const message = {\r\n        type,\r\n        data,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n      \r\n      this.ws.send(JSON.stringify(message));\r\n      console.log(`📤 WebSocket 메시지 전송: ${type}`, data);\r\n      return true;\r\n      \r\n    } catch (error) {\r\n      console.error('❌ WebSocket 메시지 전송 실패:', error);\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 문서 구독\r\n   */\r\n  subscribeToDocument(documentId) {\r\n    return this.send('subscribe', { documentId });\r\n  }\r\n  \r\n  /**\r\n   * 문서 구독 해제\r\n   */\r\n  unsubscribeFromDocument(documentId) {\r\n    return this.send('unsubscribe', { documentId });\r\n  }\r\n  \r\n  /**\r\n   * 문서 변경 알림\r\n   */\r\n  notifyDocumentChange(documentId, changes) {\r\n    return this.send('document_change', {\r\n      documentId,\r\n      changes,\r\n      clientId: this.getClientId()\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * 연결 상태 확인\r\n   */\r\n  isConnected() {\r\n    return this.isConnected && this.ws && this.ws.readyState === WebSocket.OPEN;\r\n  }\r\n  \r\n  /**\r\n   * 연결 열림 처리\r\n   */\r\n  handleOpen(event) {\r\n    console.log('✅ WebSocket 연결 성공');\r\n    \r\n    this.isConnected = true;\r\n    this.reconnectAttempts = 0;\r\n    \r\n    this.startHeartbeat();\r\n    this.emit('connect', { event });\r\n  }\r\n  \r\n  /**\r\n   * 메시지 수신 처리\r\n   */\r\n  handleMessage(event) {\r\n    try {\r\n      const message = JSON.parse(event.data);\r\n      console.log(`📥 WebSocket 메시지 수신: ${message.type}`, message.data);\r\n      \r\n      this.emit('message', message);\r\n      \r\n      // 메시지 타입별 처리\r\n      switch (message.type) {\r\n        case 'document_updated':\r\n          this.emit('documentUpdate', message.data);\r\n          break;\r\n          \r\n        case 'document_deleted':\r\n          this.emit('documentDelete', message.data);\r\n          break;\r\n          \r\n        case 'conflict_detected':\r\n          this.emit('conflict', message.data);\r\n          break;\r\n          \r\n        case 'pong':\r\n          // Heartbeat 응답\r\n          break;\r\n          \r\n        default:\r\n          console.log(`🤷 알 수 없는 메시지 타입: ${message.type}`);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('❌ WebSocket 메시지 파싱 실패:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 연결 종료 처리\r\n   */\r\n  handleClose(event) {\r\n    console.log(`🔌 WebSocket 연결 종료: ${event.code} - ${event.reason}`);\r\n    \r\n    this.isConnected = false;\r\n    this.clearTimers();\r\n    \r\n    this.emit('disconnect', { \r\n      code: event.code, \r\n      reason: event.reason,\r\n      wasClean: event.wasClean\r\n    });\r\n    \r\n    // 비정상 종료인 경우 재연결 시도\r\n    if (event.code !== 1000 && event.code !== 1001) {\r\n      this.scheduleReconnect();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 오류 처리\r\n   */\r\n  handleError(event) {\r\n    console.error('❌ WebSocket 오류:', event);\r\n    this.emit('error', { event });\r\n  }\r\n  \r\n  /**\r\n   * 재연결 스케줄링\r\n   */\r\n  scheduleReconnect() {\r\n    if (this.reconnectAttempts >= this.maxReconnectAttempts) {\r\n      console.error(`❌ 최대 재연결 시도 횟수(${this.maxReconnectAttempts}) 초과`);\r\n      return;\r\n    }\r\n    \r\n    this.reconnectAttempts++;\r\n    const delay = Math.min(\r\n      this.reconnectInterval * Math.pow(2, this.reconnectAttempts - 1),\r\n      30000 // 최대 30초\r\n    );\r\n    \r\n    console.log(`🔄 ${delay}ms 후 재연결 시도 (${this.reconnectAttempts}/${this.maxReconnectAttempts})`);\r\n    \r\n    this.reconnectTimer = setTimeout(() => {\r\n      this.connect();\r\n    }, delay);\r\n  }\r\n  \r\n  /**\r\n   * Heartbeat 시작\r\n   */\r\n  startHeartbeat() {\r\n    this.heartbeatTimer = setInterval(() => {\r\n      if (this.isConnected) {\r\n        this.send('ping');\r\n      }\r\n    }, this.heartbeatInterval);\r\n  }\r\n  \r\n  /**\r\n   * 타이머 정리\r\n   */\r\n  clearTimers() {\r\n    if (this.reconnectTimer) {\r\n      clearTimeout(this.reconnectTimer);\r\n      this.reconnectTimer = null;\r\n    }\r\n    \r\n    if (this.heartbeatTimer) {\r\n      clearInterval(this.heartbeatTimer);\r\n      this.heartbeatTimer = null;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 클라이언트 ID 생성/조회\r\n   */\r\n  getClientId() {\r\n    let clientId = localStorage.getItem('miki_client_id');\r\n    \r\n    if (!clientId) {\r\n      clientId = 'client_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\r\n      localStorage.setItem('miki_client_id', clientId);\r\n    }\r\n    \r\n    return clientId;\r\n  }\r\n  \r\n  /**\r\n   * 이벤트 리스너 등록\r\n   */\r\n  on(event, callback) {\r\n    if (this.listeners[event]) {\r\n      this.listeners[event].push(callback);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 이벤트 리스너 제거\r\n   */\r\n  off(event, callback) {\r\n    if (this.listeners[event]) {\r\n      const index = this.listeners[event].indexOf(callback);\r\n      if (index > -1) {\r\n        this.listeners[event].splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 이벤트 발생\r\n   */\r\n  emit(event, data) {\r\n    if (this.listeners[event]) {\r\n      this.listeners[event].forEach(callback => {\r\n        try {\r\n          callback(data);\r\n        } catch (error) {\r\n          console.error(`❌ WebSocket 이벤트 리스너 오류 (${event}):`, error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 연결 상태 정보\r\n   */\r\n  getStatus() {\r\n    return {\r\n      isConnected: this.isConnected,\r\n      readyState: this.ws?.readyState,\r\n      reconnectAttempts: this.reconnectAttempts,\r\n      url: this.url\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * WebSocket 어댑터 팩토리\r\n */\r\nexport const createWebSocketAdapter = (options = {}) => {\r\n  return new WebSocketAdapter(options);\r\n};\r\n\r\n/**\r\n * 기본 WebSocket 어댑터 인스턴스\r\n */\r\nexport const defaultWebSocketAdapter = new WebSocketAdapter(); ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\DataSyncManager.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":18,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":18,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[440,472],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":23,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":23,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[575,612],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":28,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":28,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[721,765],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[860,903],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":42,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":42,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1246,1337],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":62,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":62,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2048,2085],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":63,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":63,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2093,2113],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":68,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":68,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2176,2208],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":104,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":104,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3220,3266],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":118,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":118,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3641,3678],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":154,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":154,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[4666,4707],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":177,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":177,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5237,5274],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":180,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":180,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5320,5369],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":201,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":201,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5892,5929],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":203,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":203,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5964,6013],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'titleKey' is assigned a value but never used.","line":227,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":227,"endColumn":25},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":238,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":238,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6898,6968],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":267,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":267,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7760,7802],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":284,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":284,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8320,8379],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":288,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":288,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8476,8526],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":300,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":300,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8839,8888],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":322,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":322,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9404,9453],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":341,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":341,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9893,9945],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":343,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":343,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9976,10018],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":353,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":353,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10231,10271],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":354,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":354,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10277,10325],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":368,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":368,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10673,10723],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'title' is assigned a value but never used.","line":401,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":401,"endColumn":24},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":428,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":428,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12647,12698],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":430,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":430,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[12733,12772],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":438,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":438,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12919,12970],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":441,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":441,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12997,13037],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":442,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":442,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13045,13125],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":446,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":446,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[13185,13219],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":457,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":457,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13485,13534],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":464,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":464,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13701,13776],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'titleKey' is assigned a value but never used.","line":493,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":493,"endColumn":27},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":524,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":524,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15755,15793],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":525,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":525,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15801,15839],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":530,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":530,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15912,15948],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":543,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":543,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[16144,16180],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":584,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":584,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[17547,17583],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":588,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":588,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[17647,17678],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":43,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 서버와 로컬 스토리지 간의 데이터 동기화를 관리하는 클래스\r\n * 수정: 서버 API 구조에 맞게 동기화 로직 개선\r\n */\r\nclass DataSyncManager {\r\n  constructor() {\r\n    this.serverUrl = 'http://localhost:3003/api/posts';\r\n    this.syncInProgress = false;\r\n  }\r\n\r\n  /**\r\n   * 서버와 로컬 스토리지 완전 동기화\r\n   * @param {Array} keepTitles - 보존할 문서 제목 배열\r\n   * @returns {Object} - 동기화 결과\r\n   */\r\n  async fullSync(keepTitles = ['제니', '로제', '먐시리', '블랙핑크']) {\r\n    if (this.syncInProgress) {\r\n      console.log('동기화가 이미 진행 중입니다.');\r\n      return { success: false, message: '동기화 진행 중' };\r\n    }\r\n\r\n    this.syncInProgress = true;\r\n    console.log('=== 전체 데이터 동기화 시작 ===');\r\n\r\n    try {\r\n      // 1단계: 서버 문서 목록 가져오기\r\n      const serverDocs = await this.getServerDocuments();\r\n      console.log(`서버 문서: ${serverDocs.length}개`);\r\n\r\n      // 2단계: 로컬 스토리지 문서 목록 가져오기\r\n      const localDocs = this.getLocalDocuments();\r\n      console.log(`로컬 문서: ${localDocs.length}개`);\r\n\r\n      // 3단계: 보존할 문서만 필터링\r\n      const filteredServerDocs = serverDocs.filter(doc => \r\n        keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n      );\r\n      const filteredLocalDocs = localDocs.filter(doc => \r\n        keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n      );\r\n\r\n      console.log(`필터링 후 - 서버: ${filteredServerDocs.length}개, 로컬: ${filteredLocalDocs.length}개`);\r\n\r\n      // 4단계: 불필요한 서버 문서 삭제\r\n      const serverDeleteResults = await this.cleanupServerDocuments(serverDocs, keepTitles);\r\n      \r\n      // 5단계: 불필요한 로컬 문서 삭제\r\n      const localDeleteResults = this.cleanupLocalDocuments(localDocs, keepTitles);\r\n\r\n      // 6단계: 최신 버전으로 통합\r\n      const mergeResults = await this.mergeDocuments(filteredServerDocs, filteredLocalDocs);\r\n\r\n      const result = {\r\n        success: true,\r\n        serverDeleted: serverDeleteResults.deleted,\r\n        localDeleted: localDeleteResults.deleted,\r\n        merged: mergeResults.merged,\r\n        finalCount: mergeResults.finalDocuments.length,\r\n        message: `동기화 완료: ${mergeResults.finalDocuments.length}개 문서 유지`\r\n      };\r\n\r\n      console.log('=== 전체 데이터 동기화 완료 ===');\r\n      console.log(result);\r\n      \r\n      return result;\r\n\r\n    } catch (error) {\r\n      console.error('동기화 오류:', error);\r\n      return { \r\n        success: false, \r\n        error: error.message,\r\n        message: '동기화 실패' \r\n      };\r\n    } finally {\r\n      this.syncInProgress = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 서버에서 모든 문서 가져오기 (수정: title 추출 로직 개선)\r\n   */\r\n  async getServerDocuments() {\r\n    try {\r\n      const response = await fetch(this.serverUrl);\r\n      if (!response.ok) {\r\n        throw new Error(`서버 응답 오류: ${response.status}`);\r\n      }\r\n      \r\n      const serverPosts = await response.json();\r\n      \r\n      // 각 문서의 전체 내용을 개별적으로 가져오기\r\n      const fullDocuments = [];\r\n      for (const post of serverPosts) {\r\n        try {\r\n          const fullContent = await this.getServerDocument(post.id);\r\n          fullDocuments.push({\r\n            id: post.id,\r\n            title: post.title || post.id,\r\n            content: fullContent.content || '',\r\n            updatedAt: fullContent.updatedAt || post.updatedAt || new Date().toISOString(),\r\n            source: 'server'\r\n          });\r\n        } catch (error) {\r\n          console.warn(`문서 ${post.id} 가져오기 실패:`, error);\r\n          // 실패한 경우 기본 정보만 사용\r\n          fullDocuments.push({\r\n            id: post.id,\r\n            title: post.title || post.id,\r\n            content: post.preview || '',\r\n            updatedAt: post.updatedAt || new Date().toISOString(),\r\n            source: 'server'\r\n          });\r\n        }\r\n      }\r\n      \r\n      return fullDocuments;\r\n    } catch (error) {\r\n      console.error('서버 문서 조회 오류:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 서버에서 특정 문서의 전체 내용 가져오기\r\n   */\r\n  async getServerDocument(id) {\r\n    const response = await fetch(`${this.serverUrl}/${id}`);\r\n    if (!response.ok) {\r\n      throw new Error(`문서 조회 실패: ${response.status}`);\r\n    }\r\n    return await response.json();\r\n  }\r\n\r\n  /**\r\n   * 로컬 스토리지에서 모든 문서 가져오기\r\n   */\r\n  getLocalDocuments() {\r\n    const documents = [];\r\n    const documentKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\r\n    \r\n    for (const key of documentKeys) {\r\n      try {\r\n        const docData = JSON.parse(localStorage.getItem(key));\r\n        if (docData && docData.title) {\r\n          documents.push({\r\n            id: docData.id || key.replace('miki_document_', ''),\r\n            title: docData.title,\r\n            content: docData.content || '',\r\n            updatedAt: docData.updatedAt || new Date().toISOString(),\r\n            source: 'local'\r\n          });\r\n        }\r\n      } catch (e) {\r\n        console.warn(`로컬 문서 파싱 오류 (${key}):`, e);\r\n      }\r\n    }\r\n    \r\n    return documents;\r\n  }\r\n\r\n  /**\r\n   * 서버에서 불필요한 문서 삭제\r\n   */\r\n  async cleanupServerDocuments(serverDocs, keepTitles) {\r\n    const toDelete = serverDocs.filter(doc => \r\n      !keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n    );\r\n\r\n    let deleted = 0;\r\n    for (const doc of toDelete) {\r\n      try {\r\n        const response = await fetch(`${this.serverUrl}/${doc.id}`, {\r\n          method: 'DELETE'\r\n        });\r\n        if (response.ok) {\r\n          deleted++;\r\n          console.log(`서버에서 삭제: ${doc.title}`);\r\n        }\r\n      } catch (error) {\r\n        console.error(`서버 삭제 실패 (${doc.title}):`, error);\r\n      }\r\n    }\r\n\r\n    return { deleted, total: toDelete.length };\r\n  }\r\n\r\n  /**\r\n   * 로컬 스토리지에서 불필요한 문서 삭제\r\n   */\r\n  cleanupLocalDocuments(localDocs, keepTitles) {\r\n    const toDelete = localDocs.filter(doc => \r\n      !keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n    );\r\n\r\n    let deleted = 0;\r\n    for (const doc of toDelete) {\r\n      try {\r\n        localStorage.removeItem(`miki_document_${doc.id}`);\r\n        localStorage.removeItem(`miki_title_${doc.id}`);\r\n        deleted++;\r\n        console.log(`로컬에서 삭제: ${doc.title}`);\r\n      } catch (error) {\r\n        console.error(`로컬 삭제 실패 (${doc.title}):`, error);\r\n      }\r\n    }\r\n\r\n    return { deleted, total: toDelete.length };\r\n  }\r\n\r\n  /**\r\n   * 서버와 로컬 문서를 최신 버전으로 통합\r\n   */\r\n  async mergeDocuments(serverDocs, localDocs) {\r\n    const finalDocuments = [];\r\n    const titleGroups = {};\r\n\r\n    // 제목별로 그룹화\r\n    [...serverDocs, ...localDocs].forEach(doc => {\r\n      const titleKey = doc.title.toLowerCase();\r\n      if (!titleGroups[titleKey]) {\r\n        titleGroups[titleKey] = [];\r\n      }\r\n      titleGroups[titleKey].push(doc);\r\n    });\r\n\r\n    // 각 제목별로 최신 버전 선택 및 동기화\r\n    for (const [titleKey, docs] of Object.entries(titleGroups)) {\r\n      // 최신 문서 선택 (updatedAt 기준)\r\n      const latestDoc = docs.sort((a, b) => \r\n        new Date(b.updatedAt) - new Date(a.updatedAt)\r\n      )[0];\r\n\r\n      // 서버와 로컬 모두에 최신 버전 저장\r\n      await this.saveToServer(latestDoc);\r\n      this.saveToLocal(latestDoc);\r\n\r\n      finalDocuments.push(latestDoc);\r\n      console.log(`통합 완료: ${latestDoc.title} (최신: ${latestDoc.updatedAt})`);\r\n    }\r\n\r\n    return { merged: finalDocuments.length, finalDocuments };\r\n  }\r\n\r\n  /**\r\n   * 서버에 문서 저장 (수정: 서버 API 구조에 맞게 개선)\r\n   */\r\n  async saveToServer(doc) {\r\n    try {\r\n      // 먼저 해당 ID의 문서가 서버에 존재하는지 확인\r\n      const existingResponse = await fetch(`${this.serverUrl}/${doc.id}`);\r\n      \r\n      if (existingResponse.ok) {\r\n        // 문서가 존재하면 PUT으로 업데이트\r\n        const updateResponse = await fetch(`${this.serverUrl}/${doc.id}`, {\r\n          method: 'PUT',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            content: doc.content,\r\n            title: doc.title\r\n          })\r\n        });\r\n        \r\n        if (!updateResponse.ok) {\r\n          throw new Error(`서버 업데이트 실패: ${updateResponse.status}`);\r\n        }\r\n        \r\n        console.log(`✅ 서버 업데이트 완료: ${doc.title}`);\r\n      } else {\r\n        // 문서가 없으면 POST로 새로 생성\r\n        const createResponse = await fetch(this.serverUrl, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            title: doc.title,\r\n            content: doc.content\r\n          })\r\n        });\r\n        \r\n        if (!createResponse.ok) {\r\n          throw new Error(`서버 생성 실패: ${createResponse.status}`);\r\n        }\r\n        \r\n        const result = await createResponse.json();\r\n        console.log(`✅ 서버 생성 완료: ${doc.title} (ID: ${result.id})`);\r\n        \r\n        // 새로 생성된 ID가 다르면 로컬에서도 업데이트\r\n        if (result.id !== doc.id) {\r\n          console.log(`🔄 ID 변경: ${doc.id} → ${result.id}`);\r\n          \r\n          // 기존 로컬 데이터 삭제\r\n          localStorage.removeItem(`miki_document_${doc.id}`);\r\n          localStorage.removeItem(`miki_title_${doc.id}`);\r\n          \r\n          // 새 ID로 저장\r\n          doc.id = result.id;\r\n          this.saveToLocal(doc);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(`서버 저장 오류 (${doc.title}):`, error);\r\n      throw error; // 에러를 상위로 전파\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 로컬 스토리지에 문서 저장\r\n   */\r\n  saveToLocal(doc) {\r\n    try {\r\n      const docKey = `miki_document_${doc.id}`;\r\n      const titleKey = `miki_title_${doc.id}`;\r\n      \r\n      localStorage.setItem(docKey, JSON.stringify({\r\n        id: doc.id,\r\n        title: doc.title,\r\n        content: doc.content,\r\n        updatedAt: doc.updatedAt || new Date().toISOString()\r\n      }));\r\n      \r\n      localStorage.setItem(titleKey, doc.title);\r\n    } catch (error) {\r\n      console.error(`로컬 저장 오류 (${doc.title}):`, error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 최근 문서 목록 재구성\r\n   */\r\n  updateRecentDocuments(documents) {\r\n    try {\r\n      const recentDocs = documents\r\n        .sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt))\r\n        .slice(0, 20)\r\n        .map(doc => ({\r\n          id: doc.id,\r\n          title: doc.title,\r\n          updatedAt: doc.updatedAt\r\n        }));\r\n\r\n      localStorage.setItem('miki_recent_docs', JSON.stringify(recentDocs));\r\n      console.log(`최근 문서 목록 업데이트: ${recentDocs.length}개`);\r\n    } catch (error) {\r\n      console.error('최근 문서 목록 업데이트 오류:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 즉시 로컬 스토리지 정리 (UI에서 호출용)\r\n   * @param {Array} keepTitles - 보존할 문서 제목 배열\r\n   * @returns {Object} - 정리 결과\r\n   */\r\n  immediateLocalCleanup(keepTitles = ['제니', '로제', '먐시리', '블랙핑크']) {\r\n    console.log('=== 즉시 로컬 스토리지 정리 시작 ===');\r\n    console.log(`보존할 문서: ${keepTitles.join(', ')}`);\r\n    \r\n    const stats = {\r\n      totalDocuments: 0,\r\n      preservedDocuments: 0,\r\n      deletedDocuments: 0,\r\n      spaceSaved: 0\r\n    };\r\n    \r\n    try {\r\n      // 모든 문서 키 수집\r\n      const documentKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\r\n      stats.totalDocuments = documentKeys.length;\r\n      \r\n      console.log(`📊 총 ${documentKeys.length}개 문서 발견`);\r\n      \r\n      const toDelete = [];\r\n      const toKeep = [];\r\n      \r\n      // 제목별 그룹화 및 분류\r\n      const titleGroups = {};\r\n      \r\n      for (const key of documentKeys) {\r\n        try {\r\n          const docData = JSON.parse(localStorage.getItem(key));\r\n          if (!docData || !docData.title) continue;\r\n          \r\n          const title = docData.title.toLowerCase();\r\n          const shouldKeep = keepTitles.some(keepTitle => \r\n            title === keepTitle.toLowerCase()\r\n          );\r\n          \r\n          if (shouldKeep) {\r\n            if (!titleGroups[title]) {\r\n              titleGroups[title] = [];\r\n            }\r\n            titleGroups[title].push({ key, data: docData });\r\n          } else {\r\n            toDelete.push({ key, title: docData.title });\r\n          }\r\n        } catch (e) {\r\n          // 파싱 오류가 있는 문서는 삭제\r\n          toDelete.push({ key, title: '파싱 오류' });\r\n        }\r\n      }\r\n      \r\n      // 각 제목별로 최신 버전만 보존\r\n      for (const [title, docs] of Object.entries(titleGroups)) {\r\n        if (docs.length > 1) {\r\n          // 최신 문서 선택\r\n          const latest = docs.sort((a, b) => \r\n            new Date(b.data.updatedAt || 0) - new Date(a.data.updatedAt || 0)\r\n          )[0];\r\n          \r\n          // 나머지는 삭제 목록에 추가\r\n          docs.forEach(doc => {\r\n            if (doc.key !== latest.key) {\r\n              toDelete.push({ key: doc.key, title: doc.data.title });\r\n            } else {\r\n              toKeep.push({ key: doc.key, title: doc.data.title });\r\n            }\r\n          });\r\n        } else {\r\n          toKeep.push({ key: docs[0].key, title: docs[0].data.title });\r\n        }\r\n      }\r\n      \r\n      // 삭제 실행\r\n      for (const item of toDelete) {\r\n        try {\r\n          const docId = item.key.replace('miki_document_', '');\r\n          localStorage.removeItem(item.key);\r\n          localStorage.removeItem(`miki_title_${docId}`);\r\n          stats.deletedDocuments++;\r\n          console.log(`❌ 삭제: ${item.key} - \"${item.title}\"`);\r\n        } catch (e) {\r\n          console.error(`삭제 실패: ${item.key}`, e);\r\n        }\r\n      }\r\n      \r\n      stats.preservedDocuments = toKeep.length;\r\n      \r\n      // 보존된 문서 로그\r\n      toKeep.forEach(item => {\r\n        console.log(`✅ 보존: ${item.key} - \"${item.title}\"`);\r\n      });\r\n      \r\n      console.log('=== 즉시 로컬 스토리지 정리 완료 ===');\r\n      console.log(`보존: ${stats.preservedDocuments}개, 삭제: ${stats.deletedDocuments}개`);\r\n      \r\n      return stats;\r\n    } catch (error) {\r\n      console.error('즉시 정리 오류:', error);\r\n      return { ...stats, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 안전한 동기화 테스트 (실제 변경 없이 시뮬레이션만)\r\n   * @param {Array} keepTitles - 보존할 문서 제목 배열\r\n   * @returns {Object} - 테스트 결과\r\n   */\r\n  async safeTestSync(keepTitles = ['제니', '로제', '먐시리', '블랙핑크']) {\r\n    console.log('=== 안전한 동기화 테스트 시작 (실제 변경 없음) ===');\r\n    \r\n    try {\r\n      // 1단계: 현재 상태 분석\r\n      const serverDocs = await this.getServerDocuments();\r\n      const localDocs = this.getLocalDocuments();\r\n      \r\n      console.log(`📊 현재 상태: 서버 ${serverDocs.length}개, 로컬 ${localDocs.length}개`);\r\n      \r\n      // 2단계: 필터링 시뮬레이션\r\n      const serverFiltered = serverDocs.filter(doc => \r\n        keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n      );\r\n      const localFiltered = localDocs.filter(doc => \r\n        keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n      );\r\n      \r\n      // 3단계: 삭제 대상 분석\r\n      const serverToDelete = serverDocs.filter(doc => \r\n        !keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n      );\r\n      const localToDelete = localDocs.filter(doc => \r\n        !keepTitles.some(title => title.toLowerCase() === doc.title.toLowerCase())\r\n      );\r\n      \r\n      // 4단계: 통합 시뮬레이션\r\n      const titleGroups = {};\r\n      [...serverFiltered, ...localFiltered].forEach(doc => {\r\n        const titleKey = doc.title.toLowerCase();\r\n        if (!titleGroups[titleKey]) {\r\n          titleGroups[titleKey] = [];\r\n        }\r\n        titleGroups[titleKey].push(doc);\r\n      });\r\n      \r\n      const mergeResults = [];\r\n      for (const [titleKey, docs] of Object.entries(titleGroups)) {\r\n        const latest = docs.sort((a, b) => \r\n          new Date(b.updatedAt) - new Date(a.updatedAt)\r\n        )[0];\r\n        mergeResults.push({\r\n          title: latest.title,\r\n          selectedSource: latest.source,\r\n          versions: docs.length,\r\n          latestUpdate: latest.updatedAt\r\n        });\r\n      }\r\n      \r\n      const testResult = {\r\n        success: true,\r\n        currentState: {\r\n          server: serverDocs.length,\r\n          local: localDocs.length\r\n        },\r\n        afterFiltering: {\r\n          server: serverFiltered.length,\r\n          local: localFiltered.length\r\n        },\r\n        toDelete: {\r\n          server: serverToDelete.length,\r\n          local: localToDelete.length\r\n        },\r\n        finalMerged: mergeResults.length,\r\n        mergeDetails: mergeResults,\r\n        message: `테스트 완료: ${mergeResults.length}개 문서가 최종 보존됩니다`\r\n      };\r\n      \r\n      console.log('=== 안전한 동기화 테스트 완료 ===');\r\n      console.log('📊 테스트 결과:', testResult);\r\n      \r\n      return testResult;\r\n      \r\n    } catch (error) {\r\n      console.error('동기화 테스트 오류:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message,\r\n        message: '테스트 실패'\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 현재 동기화 상태 진단\r\n   */\r\n  async diagnoseCurrentState() {\r\n    console.log('=== 동기화 상태 진단 시작 ===');\r\n    \r\n    try {\r\n      const serverDocs = await this.getServerDocuments();\r\n      const localDocs = this.getLocalDocuments();\r\n      \r\n      // 제목별 그룹화\r\n      const serverTitles = new Set(serverDocs.map(doc => doc.title.toLowerCase()));\r\n      const localTitles = new Set(localDocs.map(doc => doc.title.toLowerCase()));\r\n      \r\n      const onlyServer = serverDocs.filter(doc => \r\n        !localTitles.has(doc.title.toLowerCase())\r\n      );\r\n      const onlyLocal = localDocs.filter(doc => \r\n        !serverTitles.has(doc.title.toLowerCase())\r\n      );\r\n      const both = serverDocs.filter(doc => \r\n        localTitles.has(doc.title.toLowerCase())\r\n      );\r\n      \r\n      const diagnosis = {\r\n        server: {\r\n          total: serverDocs.length,\r\n          titles: Array.from(serverTitles)\r\n        },\r\n        local: {\r\n          total: localDocs.length,\r\n          titles: Array.from(localTitles)\r\n        },\r\n        discrepancies: {\r\n          onlyServer: onlyServer.length,\r\n          onlyLocal: onlyLocal.length,\r\n          both: both.length\r\n        },\r\n        details: {\r\n          onlyServerDocs: onlyServer.map(doc => ({ id: doc.id, title: doc.title })),\r\n          onlyLocalDocs: onlyLocal.map(doc => ({ id: doc.id, title: doc.title })),\r\n          sharedDocs: both.map(doc => ({ id: doc.id, title: doc.title }))\r\n        }\r\n      };\r\n      \r\n      console.log('📊 진단 완료:', diagnosis);\r\n      return diagnosis;\r\n      \r\n    } catch (error) {\r\n      console.error('진단 오류:', error);\r\n      return { error: error.message };\r\n    }\r\n  }\r\n}\r\n\r\nexport default DataSyncManager; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\DocumentSearchManager.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'API_TYPE' is assigned a value but never used.","line":7,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'API_KEY' is assigned a value but never used.","line":8,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'SERVER_URL' is assigned a value but never used.","line":9,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'CLAUDE_API_URL' is assigned a value but never used.","line":11,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":21},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":35,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":35,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[929,970],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1033,1093],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":58,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":58,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1782,1832],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":64,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":64,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2072,2113],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":67,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":67,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2167,2208],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":73,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":73,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2358,2425],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":78,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":78,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2638,2683],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":83,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":83,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2824,2864],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":86,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":86,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2888,2929],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":88,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":88,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2958,2997],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":98,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":98,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3129,3161],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":137,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":137,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4333,4398],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":157,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":157,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5149,5222],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":160,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":160,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5297,5348],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":174,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":174,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5835,5899],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":177,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":177,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5951,5999],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":187,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":187,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6274,6321],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":212,"column":19,"nodeType":"MemberExpression","messageId":"unexpected","endLine":212,"endColumn":30,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7208,7268],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":229,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":229,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[7663,7698],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":233,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":233,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7737,7798],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":237,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":237,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7877,7914],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":248,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":248,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8053,8085],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":255,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":255,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8254,8293],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":285,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":285,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9222,9277],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":288,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":288,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9333,9370],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":301,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":301,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9605,9638],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":307,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":307,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9793,9832],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":313,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":313,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10014,10063],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":326,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":326,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10528,10591],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":334,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":334,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10844,10927],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":335,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":335,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10936,10969],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":336,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":336,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[10978,11024],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":337,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":337,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11033,11121],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":342,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":342,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11197,11271],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":345,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":345,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11325,11378],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":368,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":368,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12258,12298],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":379,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":379,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[12591,12626],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":400,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":400,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13072,13107],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":405,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":405,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13205,13260],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":408,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":408,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13315,13345],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":418,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":418,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13622,13657],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":433,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":433,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14189,14252],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":439,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":439,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14391,14481],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":440,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":440,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14492,14538],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":448,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":448,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14743,14790],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":454,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":454,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14964,15010],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":462,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":462,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15226,15267],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":468,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":468,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15441,15482],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":480,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":480,"endColumn":28,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15957,16082],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":483,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":483,"endColumn":27,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[16148,16194],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":492,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":492,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[16415,16476],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":497,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":497,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[16590,16651],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":500,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":500,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[16745,16806],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":503,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":503,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[16840,16894],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":507,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":507,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[16993,17048],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":518,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":518,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[17307,17357],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":531,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":531,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[17747,17797],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":543,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":543,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[18192,18234],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":553,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":553,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18524,18561],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":614,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":614,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[20249,20284],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":620,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":620,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[20424,20476],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":694,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":694,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[22322,22361],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":708,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":708,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[22784,22824],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":741,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":741,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[23816,23859],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":744,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":744,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[23916,23950],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":746,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":746,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[23989,24026],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":757,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":757,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[24249,24284],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":763,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":763,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[24431,24464],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":769,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":769,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[24636,24664],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":773,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":773,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[24776,24822],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":780,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":780,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[24959,24984],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":785,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":785,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[25209,25261],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":790,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":790,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[25371,25400],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":795,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":795,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[25622,25677],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":801,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":801,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[25822,25866],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":805,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":805,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[25919,25965],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":808,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":808,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[26024,26061],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":839,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":839,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[26830,26900],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":840,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":840,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[26905,26953],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":856,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":856,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[27336,27393],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":897,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":897,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[28718,28755],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":899,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":899,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[28783,28820],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":933,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":933,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[29817,29856],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":951,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":951,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[30417,30486],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":961,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":961,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[30830,30899],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":972,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":972,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[31219,31283],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":981,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":981,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[31461,31513],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":998,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":998,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[32039,32077],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1000,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1000,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[32118,32165],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1005,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1005,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[32277,32339],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1020,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1020,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[32898,32955],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1022,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1022,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[32992,33033],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1027,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1027,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33085,33123],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1028,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1028,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33130,33176],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1029,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1029,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33183,33235],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1030,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1030,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33242,33292],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1031,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1031,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33299,33364],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1034,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1034,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33413,33441],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1035,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1035,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33450,33492],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1036,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1036,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33501,33549],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1040,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1040,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[33610,33658],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1041,"column":39,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1041,"endColumn":50},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1045,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1045,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[33770,33812],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":107,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// DocumentSearchManager.js\n// AI 패널과 링크 생성 사이에 공유되는 문서 검색 기능을 제공하는 클래스\n\nimport DocumentSummaryManager from './DocumentSummaryManager.js';\n\n// 환경 변수 처리 - Jest 호환성을 위해 기본값 사용\nconst API_TYPE = 'claude';\nconst API_KEY = '';\nconst SERVER_URL = 'http://localhost:3001';\n\nconst CLAUDE_API_URL = 'https://api.anthropic.com/v1/messages';\nconst CLAUDE_MODEL = 'claude-3-5-haiku-20241022';\n\n/**\n * 문서 검색 기능을 제공하는 클래스\n * 키워드 검색과 의미 기반 검색을 결합하여 하이브리드 검색 제공\n */\nclass DocumentSearchManager {\n  constructor() {\n    this.summaryManager = new DocumentSummaryManager();\n    this.documentCache = new Map(); // 문서 ID를 키로, 문서 내용 및 메타데이터를 값으로 저장\n    this.documentEmbeddings = new Map(); // 문서 ID를 키로, 문서 임베딩을 값으로 저장\n    this.maxResults = 10; // 검색 결과 최대 개수\n    this.useAiSearch = true; // AI 검색 사용 여부\n    \n    // 초기화 시 로컬 스토리지 진단 실행\n    this.analyzeLocalStorage();\n  }\n\n  /**\n   * 로컬 스토리지 전체 분석 - 디버깅용\n   */\n  analyzeLocalStorage() {\n    try {\n      console.log(\"===== 로컬 스토리지 분석 시작 =====\");\n      const allKeys = Object.keys(localStorage);\n      \n      console.log(`총 ${allKeys.length}개 항목이 로컬 스토리지에 저장되어 있습니다.`);\n      \n      // 키 패턴별 분류\n      const patterns = {\n        document: allKeys.filter(key => key.includes('document')),\n        title: allKeys.filter(key => key.includes('title')),\n        content: allKeys.filter(key => key.includes('content')),\n        ai: allKeys.filter(key => key.includes('ai')),\n        temp: allKeys.filter(key => key.includes('temp')),\n        other: allKeys.filter(key => \n          !key.includes('document') && \n          !key.includes('title') && \n          !key.includes('content') && \n          !key.includes('ai') &&\n          !key.includes('temp')\n        )\n      };\n      \n      // 패턴별 출력\n      Object.entries(patterns).forEach(([pattern, keys]) => {\n        console.log(`\\n[${pattern}] 패턴: ${keys.length}개`);\n        keys.slice(0, 5).forEach(key => {\n          const value = localStorage.getItem(key);\n          const valuePreview = value ? \n            (value.length > 50 ? value.substring(0, 50) + '...' : value) : \n            '(없음)';\n          console.log(`- ${key}: ${valuePreview}`);\n        });\n        if (keys.length > 5) {\n          console.log(`... 외 ${keys.length - 5}개`);\n        }\n      });\n      \n      // miki_document 패턴 상세 분석\n      const documentKeys = allKeys.filter(key => key.startsWith('miki_document_'));\n      console.log(`\\n문서 내용 키(miki_document_*): ${documentKeys.length}개`);\n      documentKeys.forEach(key => {\n        const docId = key.replace('miki_document_', '');\n        const content = localStorage.getItem(key);\n        const contentLength = content ? content.length : 0;\n        console.log(`- ${docId}: ${contentLength}자`);\n        \n        // 관련 타이틀 확인\n        const titleKey = `miki_title_${docId}`;\n        const title = localStorage.getItem(titleKey);\n        console.log(`  제목: ${title || '(없음)'}`);\n      });\n      \n      console.log(\"===== 로컬 스토리지 분석 완료 =====\");\n    } catch (error) {\n      console.error(\"로컬 스토리지 분석 오류:\", error);\n    }\n  }\n\n  /**\n   * 모든 가능한 문서 키 패턴 스캔 및 수집\n   * @returns {Object} - 키 패턴별 문서 정보\n   */\n  scanDocumentPatterns() {\n    try {\n      console.log(\"문서 저장 패턴 스캔 중...\");\n      const allStorageKeys = Object.keys(localStorage);\n      \n      // 키 패턴 정의\n      const patterns = {\n        // 현재 편집 중인 임시 문서\n        temp: {\n          title: 'miki_editor_title_temp',\n          content: 'miki_editor_content_temp',\n          savedAt: 'miki_editor_saved_at'\n        },\n        // 저장된 문서 패턴들\n        document: {\n          prefix: 'miki_document_',\n          titlePrefix: 'miki_title_'\n        },\n        // 기타 패턴\n        recentDocs: 'miki_recent_docs',\n        conversations: 'miki_ai_conversations_'\n      };\n      \n      // 패턴별 문서 수집\n      const collectedDocs = {};\n      \n      // 1. 현재 편집 중인 임시 문서\n      const tempTitle = localStorage.getItem(patterns.temp.title);\n      const tempContent = localStorage.getItem(patterns.temp.content);\n      const tempSavedAt = localStorage.getItem(patterns.temp.savedAt);\n      \n      if (tempTitle && tempContent) {\n        const tempDoc = {\n          id: this.slugify(tempTitle),\n          title: tempTitle,\n          content: tempContent,\n          savedAt: tempSavedAt,\n          path: `/doc/${this.slugify(tempTitle)}`,\n          isTemp: true\n        };\n        collectedDocs[tempDoc.id] = tempDoc;\n        console.log(`임시 문서 발견: \"${tempTitle}\" (${tempContent.length}자)`);\n      }\n      \n      // 2. 저장된 문서 (miki_document_* 패턴)\n      const documentKeys = allStorageKeys.filter(key => key.startsWith(patterns.document.prefix));\n      for (const key of documentKeys) {\n        try {\n          const docId = key.replace(patterns.document.prefix, '');\n          const titleKey = `${patterns.document.titlePrefix}${docId}`;\n          const rawDocContent = localStorage.getItem(key);\n          \n          // JSON 형식으로 저장된 문서 파싱 시도\n          let docContent, docTitle;\n          \n          try {\n            // JSON 파싱 시도\n            const docJson = JSON.parse(rawDocContent);\n            docTitle = docJson.title || localStorage.getItem(titleKey) || docId;\n            docContent = docJson.content || '';\n            \n            console.log(`JSON 파싱 성공: 문서 \"${docTitle}\" 내용 길이: ${docContent.length}자`);\n          } catch (e) {\n            // JSON 파싱 실패 시 원본 텍스트 사용\n            console.log(`JSON 파싱 실패, 원본 텍스트 사용: ${e.message}`);\n            docTitle = localStorage.getItem(titleKey) || docId.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\n            docContent = rawDocContent;\n          }\n          \n          if (docId && docContent) {\n            const docObject = {\n              id: docId,\n              title: docTitle,\n              content: docContent,\n              path: `/doc/${docId}`,\n              isDocument: true\n            };\n            collectedDocs[docId] = docObject;\n            console.log(`저장된 문서 발견: \"${docTitle}\" (${docContent.length}자)`);\n          }\n        } catch (docError) {\n          console.error(`문서 키 ${key} 처리 중 오류:`, docError);\n        }\n      }\n      \n      // 3. 최근 문서 목록\n      try {\n        const recentDocsJson = localStorage.getItem(patterns.recentDocs);\n        if (recentDocsJson) {\n          const recentDocs = JSON.parse(recentDocsJson);\n          if (Array.isArray(recentDocs)) {\n            console.log(`최근 문서 목록: ${recentDocs.length}개`);\n            \n            for (const doc of recentDocs) {\n              if (!doc.id && !doc.title) continue;\n              \n              const docId = doc.id || this.slugify(doc.title);\n              \n              // 이미 수집된 문서인지 확인\n              if (collectedDocs[docId]) {\n                // 이미 있는 문서라면 최근 문서 플래그 추가\n                collectedDocs[docId].isRecent = true;\n                continue;\n              }\n              \n              // 문서 내용 검색을 위한 여러 키 패턴 시도\n              const contentPatterns = [\n                `${patterns.document.prefix}${docId}`,\n                `miki_content_${docId}`,\n                `miki_doc_content_${docId}`\n              ];\n              \n              let docContent = null;\n              for (const pattern of contentPatterns) {\n                docContent = localStorage.getItem(pattern);\n                if (docContent) {\n                  console.log(`\"${doc.title}\" 문서의 내용을 ${pattern} 키에서 찾았습니다.`);\n                  break;\n                }\n              }\n              \n              // 최근 문서 추가\n              collectedDocs[docId] = {\n                id: docId,\n                title: doc.title,\n                content: docContent || '',\n                path: `/doc/${docId}`,\n                isRecent: true\n              };\n            }\n          }\n        }\n      } catch (e) {\n        console.warn(\"최근 문서 목록 처리 오류:\", e);\n      }\n      \n      // 문서 수 출력\n      console.log(`총 ${Object.keys(collectedDocs).length}개 문서 발견`);\n      \n      return Object.values(collectedDocs);\n    } catch (error) {\n      console.error(\"문서 패턴 스캔 오류:\", error);\n      return [];\n    }\n  }\n\n  /**\n   * 로컬 스토리지에서 모든 문서 정보 로드\n   * @returns {Array} - 문서 객체 배열\n   */\n  getAllDocuments() {\n    try {\n      console.log(\"모든 문서 정보 로드 중...\");\n      \n      // 개선된 문서 패턴 스캔 사용\n      const allDocuments = this.scanDocumentPatterns();\n      \n      // 문서가 없으면 샘플 문서 추가\n      if (allDocuments.length === 0) {\n        console.log(\"문서가 없습니다. 샘플 문서를 추가합니다.\");\n        \n        // 샘플 문서 추가\n        const sampleDocs = [\n          {\n            id: 'welcome',\n            title: 'Miki 사용법',\n            content: '# Miki 사용법\\n\\nMiki는 마크다운 기반 위키 에디터입니다. 마크다운 문법을 사용하여 문서를 작성할 수 있습니다.\\n\\n## 주요 기능\\n\\n- 마크다운 편집\\n- AI 연동\\n- 문서 검색\\n- 내용 기반 링크',\n            path: '/doc/welcome',\n            isCommon: true\n          },\n          {\n            id: 'markdown-guide',\n            title: '마크다운 가이드',\n            content: '# 마크다운 가이드\\n\\n마크다운은 텍스트 기반의 마크업 언어로, 쉽게 읽고 쓸 수 있으며 HTML로 변환이 가능합니다.\\n\\n## 문법\\n\\n### 제목\\n# 제목 1\\n## 제목 2\\n\\n### 강조\\n**굵게** 또는 *기울임*\\n\\n### 링크\\n[링크 텍스트](URL)',\n            path: '/doc/markdown-guide',\n            isCommon: true\n          }\n        ];\n        \n        sampleDocs.forEach(doc => {\n          allDocuments.push(doc);\n        });\n      }\n      \n      // 문서 캐시 업데이트\n      allDocuments.forEach(doc => {\n        this.documentCache.set(doc.id, doc);\n      });\n      \n      console.log(\"검색 가능한 모든 문서:\", allDocuments.length, \"건\");\n      return allDocuments;\n    } catch (error) {\n      console.error(\"문서 정보 로드 오류:\", error);\n      return [];\n    }\n  }\n\n  /**\n   * 키워드 기반 로컬 문서 검색\n   * @param {string} query - 검색어\n   * @returns {Promise<Array>} - 검색 결과 배열\n   */\n  async searchByKeyword(query) {\n    if (!query || query.trim().length === 0) return [];\n    \n    console.log(\"키워드 검색 시작:\", query);\n    const searchQuery = query.toLowerCase().trim();\n    \n    try {\n      // URL 형식이면 검색하지 않고 바로 반환\n      if (/^https?:\\/\\//i.test(searchQuery)) {\n        console.log(\"URL 형식 감지:\", searchQuery);\n        return [{ id: 'url', title: `URL: ${searchQuery}`, path: searchQuery, isUrl: true }];\n      }\n      \n      // 문서 로드\n      const allDocuments = this.getAllDocuments();\n      console.log(`검색 대상 문서: ${allDocuments.length}개`);\n      \n      // 검색어로 필터링 (개선된 로그 추가)\n      const searchResults = allDocuments.filter(doc => {\n        const docTitle = (doc.title || '').toLowerCase();\n        \n        // 내용 확인 - content 속성이 있는지 확인\n        let docContent = '';\n        if (doc.content) {\n          if (typeof doc.content === 'string') {\n            docContent = doc.content.toLowerCase();\n          } else if (typeof doc.content === 'object') {\n            // content가 객체인 경우 (내용 디버깅)\n            console.log(`문서 \"${doc.title}\"의 content가 객체입니다:`, doc.content);\n            docContent = JSON.stringify(doc.content).toLowerCase();\n          }\n        }\n        \n        const titleMatch = docTitle.includes(searchQuery);\n        const contentMatch = docContent && docContent.includes(searchQuery);\n        \n        console.log(`문서 \"${doc.title}\" 검색 결과: 제목 일치=${titleMatch}, 내용 일치=${contentMatch}`);\n        console.log(`- 제목: ${docTitle}`);\n        console.log(`- 내용 타입: ${typeof doc.content}`);\n        console.log(`- 내용 일부: ${docContent ? docContent.substring(0, 50) + '...' : '(내용 없음)'}`);\n        \n        return titleMatch || contentMatch;\n      });\n      \n      console.log(`키워드 \"${searchQuery}\" 검색 결과: ${searchResults.length}개 문서 일치`);\n      \n      if (searchResults.length > 0) {\n        console.log(\"키워드 검색 결과:\", searchResults.length, \"건\");\n        \n        // 현재 문서 > 제목 일치 > 내용 일치 순으로 정렬\n        return searchResults.sort((a, b) => {\n          if (a.isCurrent && !b.isCurrent) return -1;\n          if (!a.isCurrent && b.isCurrent) return 1;\n          \n          const aTitleMatch = a.title.toLowerCase().includes(searchQuery);\n          const bTitleMatch = b.title.toLowerCase().includes(searchQuery);\n          \n          if (aTitleMatch && !bTitleMatch) return -1;\n          if (!aTitleMatch && bTitleMatch) return 1;\n          \n          return a.title.localeCompare(b.title);\n        }).slice(0, this.maxResults).map(doc => ({\n          id: doc.id,\n          title: doc.title + (doc.isCurrent ? ' (현재 문서)' : doc.isRecent ? ' (최근 문서)' : ''),\n          path: doc.path,\n          preview: doc.content ? doc.content.substring(0, 100) + '...' : null\n        }));\n      }\n      \n      // 검색 결과가 없으면 새 문서 만들기 옵션 제공\n      console.log(\"검색 결과 없음, 새 문서 만들기 옵션 제공\");\n      return [\n        { \n          id: 'new_' + searchQuery, \n          title: `\"${searchQuery}\" 새 문서 생성`, \n          path: `/doc/${this.slugify(searchQuery)}`,\n          preview: `\"${searchQuery}\" 문서를 새로 생성합니다.`, \n          isCreateNew: true \n        }\n      ];\n    } catch (error) {\n      console.error(\"키워드 검색 오류:\", error);\n      return [\n        { \n          id: 'error', \n          title: '오류 발생 - URL 직접 입력', \n          path: '#',\n          preview: 'URL을 직접 입력하여 외부 링크를 생성할 수 있습니다.', \n          isError: true \n        }\n      ];\n    }\n  }\n\n  /**\n   * 의미 기반 문서 검색 - 토큰 최적화된 검색 구현\n   * @param {string} query - 검색어\n   * @returns {Promise<Array>} - 의미 기반 검색 결과 배열\n   */\n  async searchBySemantic(query) {\n    if (!query || query.trim().length === 0) return [];\n    \n    console.log(\"의미 기반 검색 시작:\", query);\n    \n    try {\n      // 1단계: 로컬 문서 가져오기\n      const allDocuments = this.getAllDocuments();\n      console.log(`의미 기반 검색 대상 문서: ${allDocuments.length}개`);\n      \n      if (allDocuments.length === 0) {\n        console.log(\"검색 대상 문서가 없습니다\");\n        return [];\n      }\n      \n      // 2단계: 토큰 최적화를 위한 로컬 필터링\n      // 쿼리를 의미 있는 키워드로 분리\n      const queryText = query.toLowerCase().trim();\n      // 단어 최소 길이를 0으로 낮춤 (모든 단어 허용)\n      const queryWords = queryText.split(/\\s+/).filter(word => word.length > 0);\n      \n      console.log(\"검색 키워드:\", queryWords);\n      \n      // 각 문서별 관련도 점수 계산 (간단한 TF-IDF 유사)\n      const scoredDocuments = allDocuments.map(doc => {\n        try {\n          // 문서 텍스트 준비\n          const docTitle = (doc.title || '').toLowerCase();\n          \n          // 내용 확인 - content 속성이 있는지 확인\n          let docContent = '';\n          if (doc.content) {\n            if (typeof doc.content === 'string') {\n              docContent = doc.content.toLowerCase();\n            } else if (typeof doc.content === 'object') {\n              // content가 객체인 경우 (내용 디버깅)\n              console.log(`문서 \"${doc.title}\"의 content가 객체입니다:`, doc.content);\n              docContent = JSON.stringify(doc.content).toLowerCase();\n            }\n          }\n          \n          // 디버깅용 로그\n          console.log(`문서 \"${doc.title}\" 내용 검색 시작 (내용 길이: ${docContent ? docContent.length : 0}자)`);\n          console.log(`- 내용 타입: ${typeof doc.content}`);\n          \n          // 기본 점수 계산\n          let score = 0;\n          \n          // 제목에 쿼리 전체가 포함되어 있으면 높은 점수\n          if (docTitle.includes(queryText)) {\n            score += 15;  // 점수 상향 조정\n            console.log(`- 제목 전체 일치 (${queryText}): +15점`);\n          }\n          \n          // 내용에 쿼리 전체가 포함되어 있으면 점수 추가\n          if (docContent && docContent.includes(queryText)) {\n            score += 8;  // 점수 상향 조정\n            console.log(`- 내용 전체 일치 (${queryText}): +8점`);\n          }\n          \n          // 각 쿼리 단어별 점수 계산\n          for (const word of queryWords) {\n            // 제목에 단어가 포함되어 있으면 점수 추가\n            if (docTitle.includes(word)) {\n              score += 3;\n              console.log(`- 제목 단어 일치 (${word}): +3점`);\n            }\n            \n            // 내용에 단어가 포함되어 있으면 점수 추가 (가중치 증가)\n            if (docContent && docContent.includes(word)) {\n              score += 2;\n              console.log(`- 내용 단어 일치 (${word}): +2점`);\n            }\n            \n            // 단어 발생 빈도에 따라 추가 점수\n            try {\n              const titleMatches = (docTitle.match(new RegExp(word, 'gi')) || []).length;\n              const contentMatches = docContent ? (docContent.match(new RegExp(word, 'gi')) || []).length : 0;\n              \n              score += titleMatches * 0.5;\n              score += contentMatches * 0.3;\n              \n              if (titleMatches > 0 || contentMatches > 0) {\n                console.log(`- 단어 빈도 (${word}): 제목=${titleMatches}회, 내용=${contentMatches}회, +${titleMatches * 0.5 + contentMatches * 0.3}점`);\n              }\n            } catch (regexError) {\n              console.warn(`정규식 오류 (${word}):`, regexError);\n            }\n          }\n          \n          // 문서 추가 가중치\n          let finalScore = score;\n          \n          if (doc.content && doc.content.length > 0) {\n            finalScore *= 1.2;  // 내용이 있는 문서 우대\n            console.log(`- 내용 존재 가중치: x1.2 (${score} -> ${finalScore})`);\n          }\n          \n          if (doc.isTemp) {\n            finalScore *= 1.5;  // 현재 편집 중인 문서 우대\n            console.log(`- 현재 문서 가중치: x1.5 (${score} -> ${finalScore})`);\n          } else if (doc.isRecent) {\n            finalScore *= 1.3;  // 최근 문서 우대\n            console.log(`- 최근 문서 가중치: x1.3 (${score} -> ${finalScore})`);\n          }\n          \n          console.log(`문서 \"${doc.title}\" 최종 점수: ${finalScore}`);\n          \n          return { ...doc, score: finalScore };\n        } catch (docError) {\n          console.error(`문서 \"${doc.title}\" 점수 계산 오류:`, docError);\n          return { ...doc, score: 0 };\n        }\n      });\n      \n      // 디버깅용: 각 문서의 점수 확인 (상위 5개만)\n      const top5Docs = [...scoredDocuments]\n        .sort((a, b) => b.score - a.score)\n        .slice(0, 5);\n      \n      top5Docs.forEach(doc => {\n        console.log(`문서 \"${doc.title}\" 점수: ${doc.score}`);\n      });\n      \n      // 점수 기준 정렬 및 필터링\n      const sortedDocuments = scoredDocuments\n        .filter(doc => doc.score > 0.5)  // 낮은 점수 문서 제외 (임계값 낮춤)\n        .sort((a, b) => b.score - a.score);  // 점수 높은 순으로 정렬\n      \n      // 3단계: 최종 결과 구성\n      // 상위 결과만 반환 (토큰 최적화)\n      const topResults = sortedDocuments.slice(0, this.maxResults);\n      \n      if (topResults.length > 0) {\n        console.log(`의미 기반 검색 결과: ${topResults.length}건`);\n        return topResults.map(doc => ({\n          id: doc.id,\n          title: doc.title + (doc.isTemp ? ' (현재 문서)' : doc.isRecent ? ' (최근 문서)' : ''),\n          path: doc.path || `/doc/${doc.id}`,\n          preview: this.generatePreview(doc.content, queryText),\n          score: doc.score,\n          isSemanticMatch: true\n        }));\n      }\n      \n      // 4단계: 결과가 없는 경우 새 문서 생성 옵션 제공\n      console.log(\"의미 기반 검색 결과 없음, 새 문서 옵션 제공\");\n      return [{ \n        id: 'new_' + queryText, \n        title: `\"${queryText}\" 새 문서 생성`, \n        path: `/doc/${this.slugify(queryText)}`,\n        preview: `\"${queryText}\"에 관한 새 문서를 생성합니다.`, \n        isCreateNew: true,\n        isSemanticMatch: true\n      }];\n    } catch (error) {\n      console.error(\"의미 기반 검색 오류:\", error);\n      return [];\n    }\n  }\n  \n  /**\n   * 검색어 주변 문맥을 추출하여 미리보기 생성\n   * @param {string|object} content - 문서 내용 (문자열 또는 객체)\n   * @param {string} query - 검색어\n   * @returns {string} - 미리보기 텍스트\n   */\n  generatePreview(content, query) {\n    if (!content || !query) return '';\n    \n    // content가 객체인 경우 문자열로 변환\n    let contentStr = '';\n    if (typeof content === 'string') {\n      contentStr = content;\n    } else if (typeof content === 'object') {\n      // content가 객체이고 content.content가 있으면 해당 값 사용\n      if (content.content && typeof content.content === 'string') {\n        contentStr = content.content;\n      } else {\n        // 그 외의 경우 JSON 문자열로 변환\n        contentStr = JSON.stringify(content);\n      }\n    }\n    \n    // 마크다운 태그 제거\n    const cleanContent = contentStr.replace(/\\[(.*?)\\]\\(.*?\\)/g, '$1')\n                               .replace(/[*#_~`>]/g, '');\n    \n    // 검색어 위치 찾기\n    const queryPosition = cleanContent.toLowerCase().indexOf(query.toLowerCase());\n    \n    if (queryPosition === -1) {\n      // 검색어가 정확히 없으면 문서 앞부분 반환\n      return cleanContent.slice(0, 100) + '...';\n    }\n    \n    // 검색어 주변 문맥 추출 (앞뒤 50자)\n    const start = Math.max(0, queryPosition - 50);\n    const end = Math.min(cleanContent.length, queryPosition + query.length + 50);\n    \n    let preview = cleanContent.slice(start, end);\n    \n    // 시작/끝 부분 처리\n    if (start > 0) preview = '...' + preview;\n    if (end < cleanContent.length) preview = preview + '...';\n    \n    return preview;\n  }\n\n  /**\n   * AI를 활용한 문서 검색 (Claude API 사용)\n   * @param {string} query - 검색어\n   * @returns {Promise<Array>} - 검색 결과 배열\n   */\n  async searchByAi(query) {\n    if (!query || query.trim().length === 0) return [];\n    \n    console.log(\"AI 기반 검색 시작:\", query);\n    const searchQuery = query.toLowerCase().trim();\n    \n    try {\n      // 문서 로드\n      const allDocuments = this.getAllDocuments();\n      console.log(`AI 검색 대상 문서: ${allDocuments.length}개`);\n      \n      if (allDocuments.length === 0) {\n        return [];\n      }\n      \n      // 모든 문서 내용 통합 (AI에 전송할 컨텍스트)\n      let documentsContext = \"검색 가능한 문서 목록:\\n\\n\";\n      allDocuments.forEach((doc, index) => {\n        let docContent = '';\n        if (typeof doc.content === 'string') {\n          docContent = doc.content.substring(0, 200); // 내용은 일부만 포함\n        } else if (typeof doc.content === 'object') {\n          docContent = doc.content.content || JSON.stringify(doc.content).substring(0, 200);\n        }\n        \n        documentsContext += `${index + 1}. 제목: ${doc.title}\\n`;\n        documentsContext += `   내용 일부: ${docContent}...\\n\\n`;\n      });\n      \n      // Claude API 요청 구성\n      const prompt = `\n당신은 문서 검색 도우미입니다. 아래 문서 목록에서 다음 검색어와 가장 관련성이 높은 문서를 찾아 문서 제목, 관련성 점수, 간단한 이유를 JSON 형식으로 반환해주세요.\n\n검색어: \"${searchQuery}\"\n\n${documentsContext}\n\n검색 결과는 다음 JSON 형식으로 반환해주세요:\n\\`\\`\\`json\n{\n  \"results\": [\n    {\n      \"title\": \"문서 제목\",\n      \"score\": 0.95,\n      \"reason\": \"이 문서가 검색어와 관련이 있는 이유에 대한 간단한 설명\"\n    },\n    ...\n  ]\n}\n\\`\\`\\`\n\n최대 ${this.maxResults}개의 관련 문서만 포함해 주세요. 관련성이 높은 순서로 정렬해 주세요.\n`;\n\n      // 백엔드 프록시 서버를 통해 API 호출\n      const response = await fetch('http://localhost:3003/api/claude', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: CLAUDE_MODEL,\n          messages: [\n            {\n              role: \"user\",\n              content: [\n                {\n                  type: \"text\",\n                  text: prompt\n                }\n              ]\n            }\n          ],\n          max_tokens: 2000,\n          temperature: 0.1,\n        }),\n      });\n      \n      if (!response.ok) {\n        throw new Error(`AI 검색 API 오류: ${response.status}`);\n      }\n      \n      const responseData = await response.json();\n      console.log(\"AI 검색 응답:\", responseData);\n      \n      // 응답에서 JSON 파싱\n      const textContent = responseData.content\n        .filter(item => item.type === 'text')\n        .map(item => item.text)\n        .join('\\n');\n      \n      const jsonMatch = textContent.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n      if (!jsonMatch || !jsonMatch[1]) {\n        throw new Error(\"AI 응답에서 JSON 형식을 찾을 수 없습니다\");\n      }\n      \n      const aiResults = JSON.parse(jsonMatch[1]);\n      console.log(\"파싱된 AI 검색 결과:\", aiResults);\n      \n      // AI 결과를 실제 문서와 매핑\n      const mappedResults = aiResults.results.map(result => {\n        const matchedDoc = allDocuments.find(doc => \n          doc.title.toLowerCase() === result.title.toLowerCase() ||\n          doc.title.toLowerCase().includes(result.title.toLowerCase()) ||\n          result.title.toLowerCase().includes(doc.title.toLowerCase())\n        );\n        \n        if (matchedDoc) {\n          return {\n            id: matchedDoc.id,\n            title: matchedDoc.title,\n            path: matchedDoc.path,\n            preview: result.reason,\n            score: result.score,\n            isAiMatch: true\n          };\n        }\n        \n        // 매칭되는 문서가 없는 경우 기본 결과 반환\n        return {\n          id: this.slugify(result.title),\n          title: result.title,\n          path: `/doc/${this.slugify(result.title)}`,\n          preview: result.reason,\n          score: result.score,\n          isAiMatch: true,\n          isCreateNew: true\n        };\n      });\n      \n      console.log(\"최종 AI 검색 결과:\", mappedResults);\n      return mappedResults;\n    } catch (error) {\n      console.error(\"AI 검색 오류:\", error);\n      // 오류 발생 시 기본 키워드 검색으로 폴백\n      console.log(\"AI 검색 실패, 키워드 검색으로 대체\");\n      return await this.searchByKeyword(query);\n    }\n  }\n\n  /**\n   * 통합 검색 - AI 검색 또는 키워드 검색을 선택적으로 사용\n   * @param {string} query - 검색어\n   * @returns {Promise<Array>} - 검색 결과 배열\n   */\n  async searchDocuments(query) {\n    console.log(\"통합 문서 검색 시작:\", query);\n    if (!query || query.trim().length === 0) return [];\n    \n    try {\n      // URL 형식 확인\n      if (/^https?:\\/\\//i.test(query.trim())) {\n        console.log(\"URL 형식 감지:\", query);\n        return [{ id: 'url', title: `URL: ${query.trim()}`, path: query.trim(), isUrl: true }];\n      }\n      \n      if (this.useAiSearch) {\n        // AI 검색 사용 시\n        console.log(\"AI 검색 모드로 실행\");\n        const aiResults = await this.searchByAi(query);\n        \n        if (aiResults.length > 0) {\n          console.log(\"AI 검색 결과 찾음:\", aiResults.length);\n          return aiResults;\n        }\n      }\n      \n      // AI 검색 결과가 없거나 AI 검색을 사용하지 않는 경우 기존 로직 실행\n      // 1단계: 키워드 검색 먼저 시도\n      console.log(\"키워드 검색 시작\");\n      const keywordResults = await this.searchByKeyword(query);\n      \n      // 키워드 검색 결과가 있고, 새 문서 생성 옵션만 있는 것이 아니면 결과 반환\n      if (keywordResults.length > 0 && !keywordResults.some(result => result.isCreateNew)) {\n        console.log(\"키워드 검색 결과 찾음:\", keywordResults.length);\n        return keywordResults;\n      }\n      \n      // 2단계: 키워드 검색 결과가 없거나 새 문서 생성 옵션만 있으면 의미 기반 검색 실행\n      console.log(\"의미 기반 검색으로 전환\");\n      const semanticResults = await this.searchBySemantic(query);\n      \n      // 의미 기반 검색에서 새 문서 생성 옵션이 아닌 결과가 있는 경우\n      if (semanticResults.length > 0 && semanticResults.some(result => !result.isCreateNew)) {\n        console.log(\"의미 기반 검색 결과 반환:\", semanticResults.length);\n        return semanticResults;\n      }\n      \n      // 3단계: 두 검색 모두 실제 결과가 없고 새 문서 생성 옵션만 있는 경우\n      if (keywordResults.length > 0) {\n        console.log(\"새 문서 생성 옵션만 있음, 키워드 검색 결과 반환\");\n        return keywordResults;\n      }\n      \n      console.log(\"새 문서 생성 옵션만 있음, 의미 기반 검색 결과 반환\");\n      return semanticResults;\n    } catch (error) {\n      console.error(\"통합 문서 검색 오류:\", error);\n      return [{ \n        id: 'error', \n        title: '오류 발생 - 검색 실패', \n        path: '#',\n        preview: '검색 중 오류가 발생했습니다. 다시 시도하거나 URL을 직접 입력하세요.', \n        isError: true \n      }];\n    }\n  }\n\n  /**\n   * 문자열을 슬러그 형식으로 변환 (URL 친화적인 형식)\n   * @param {string} str - 변환할 문자열\n   * @returns {string} - 슬러그 형식의 문자열\n   */\n  slugify(str) {\n    return str\n      .toLowerCase()\n      .trim()\n      .replace(/[\\s\\W-]+/g, '-') // 공백, 특수문자를 하이픈으로 변환\n      .replace(/^-+|-+$/g, '');  // 시작/끝 하이픈 제거\n  }\n\n  /**\n   * 사용자 지정 문서만 보존하는 강력한 정리 함수\n   * @param {Array} keepTitles - 보존할 문서 제목 배열\n   * @param {boolean} dryRun - true면 실제 삭제하지 않고 로그만 출력\n   * @returns {Object} - 정리 결과 통계\n   */\n  cleanupKeepOnlySpecified(keepTitles = ['제니', '로제', '아파트', '먐시리', '블랙핑크'], dryRun = false) {\n    console.log(`=== 지정 문서만 보존 정리 ${dryRun ? '(시뮬레이션)' : '(실제 실행)'} ===`);\n    console.log(`보존할 문서: ${keepTitles.join(', ')}`);\n    \n    const stats = {\n      totalDocuments: 0,\n      preservedDocuments: 0,\n      deletedDocuments: 0,\n      spaceSaved: 0,\n      backupCreated: false,\n      errors: []\n    };\n    \n    try {\n      // 1단계: 모든 문서 수집\n      const documentKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\n      stats.totalDocuments = documentKeys.length;\n      \n      console.log(`📊 분석 시작: 총 ${documentKeys.length}개 문서 발견`);\n      \n      // 2단계: 백업 생성 (삭제할 문서가 있을 때만)\n      if (!dryRun) {\n        // 먼저 삭제할 문서가 있는지 미리 확인\n        let hasDocumentsToDelete = false;\n        for (const key of documentKeys) {\n          try {\n            const docData = JSON.parse(localStorage.getItem(key));\n            if (!docData || !docData.title) {\n              hasDocumentsToDelete = true;\n              break;\n            }\n            const title = docData.title.trim().toLowerCase();\n            const shouldKeep = keepTitles.some(keepTitle => \n              title === keepTitle.toLowerCase()\n            );\n            if (!shouldKeep) {\n              hasDocumentsToDelete = true;\n              break;\n            }\n          } catch (e) {\n            hasDocumentsToDelete = true;\n            break;\n          }\n        }\n        \n        // 삭제할 문서가 있을 때만 백업 생성\n        if (hasDocumentsToDelete) {\n          const backupData = {};\n          documentKeys.forEach(key => {\n            backupData[key] = localStorage.getItem(key);\n          });\n          \n          const backupKey = `miki_backup_manual_${Date.now()}`;\n          localStorage.setItem(backupKey, JSON.stringify({\n            timestamp: new Date().toISOString(),\n            documents: backupData,\n            type: 'manual_cleanup'\n          }));\n          stats.backupCreated = true;\n          console.log(`✅ 백업 완료: ${backupKey}`);\n        } else {\n          console.log(`⏭️ 백업 건너뜀: 삭제할 문서가 없음`);\n        }\n      }\n      \n      // 3단계: 문서 분류 및 중복 제거\n      const preserveList = [];\n      const deleteList = [];\n      const titleGroups = {}; // 제목별 그룹화\n      \n      // 먼저 제목별로 그룹화\n      for (const key of documentKeys) {\n        try {\n          const docData = JSON.parse(localStorage.getItem(key));\n          \n          if (!docData || !docData.title) {\n            deleteList.push({ key, reason: '제목 없음', size: localStorage.getItem(key)?.length || 0 });\n            continue;\n          }\n          \n          const title = docData.title.trim().toLowerCase();\n          \n          if (!titleGroups[title]) {\n            titleGroups[title] = [];\n          }\n          \n          titleGroups[title].push({\n            key,\n            title: docData.title,\n            data: docData,\n            updatedAt: new Date(docData.updatedAt || 0)\n          });\n          \n        } catch (e) {\n          deleteList.push({ key, reason: '파싱 오류', size: localStorage.getItem(key)?.length || 0 });\n          console.log(`❌ 삭제 예정: ${key} - 파싱 오류`);\n        }\n      }\n      \n      // 각 제목 그룹에서 처리\n      for (const [titleLower, docs] of Object.entries(titleGroups)) {\n        const shouldKeep = keepTitles.some(keepTitle => \n          titleLower === keepTitle.toLowerCase()\n        );\n        \n        if (shouldKeep) {\n          // 보존할 제목인 경우: 최신 문서만 보존, 나머지는 삭제\n          docs.sort((a, b) => b.updatedAt - a.updatedAt); // 최신순 정렬\n          \n          const latestDoc = docs[0]; // 가장 최신 문서\n          const duplicates = docs.slice(1); // 나머지 중복 문서들\n          \n          preserveList.push(latestDoc);\n          console.log(`✅ 보존: ${latestDoc.key} - \"${latestDoc.title}\" (최신 버전)`);\n          \n          // 중복 문서들은 삭제 목록에 추가\n          for (const duplicate of duplicates) {\n            deleteList.push({\n              key: duplicate.key,\n              title: duplicate.title,\n              reason: `중복 문서 (${latestDoc.key}가 최신)`,\n              size: localStorage.getItem(duplicate.key)?.length || 0\n            });\n            console.log(`❌ 삭제 예정: ${duplicate.key} - \"${duplicate.title}\" (중복)`);\n          }\n        } else {\n          // 보존하지 않을 제목인 경우: 모든 문서 삭제\n          for (const doc of docs) {\n            deleteList.push({\n              key: doc.key,\n              title: doc.title,\n              reason: '지정 목록에 없음',\n              size: localStorage.getItem(doc.key)?.length || 0\n            });\n            console.log(`❌ 삭제 예정: ${doc.key} - \"${doc.title}\" (보존 목록에 없음)`);\n          }\n        }\n      }\n      \n      stats.preservedDocuments = preserveList.length;\n      stats.deletedDocuments = deleteList.length;\n      \n      // 4단계: 실제 삭제 실행\n      console.log(`\\n🔥 삭제 실행: ${deleteList.length}개 문서`);\n      \n      if (!dryRun && deleteList.length > 0) {\n        let successCount = 0;\n        \n        for (const item of deleteList) {\n          try {\n            localStorage.removeItem(item.key);\n            \n            // 관련 제목 키도 삭제\n            const titleKey = item.key.replace('miki_document_', 'miki_title_');\n            if (localStorage.getItem(titleKey)) {\n              localStorage.removeItem(titleKey);\n            }\n            \n            stats.spaceSaved += item.size;\n            successCount++;\n            console.log(`  ✅ 삭제 완료: ${item.key}`);\n          } catch (error) {\n            console.error(`  ❌ 삭제 실패: ${item.key}`, error);\n            stats.errors.push(`삭제 실패: ${item.key} - ${error.message}`);\n          }\n        }\n        \n        console.log(`✅ 삭제 완료: ${successCount}/${deleteList.length}개`);\n      }\n      \n      // 5단계: 최근 문서 목록 재구성\n      if (!dryRun && deleteList.length > 0) {\n        try {\n          const remainingDocs = preserveList.map(item => ({\n            id: item.data.id || item.key.replace('miki_document_', ''),\n            title: item.data.title,\n            updatedAt: item.data.updatedAt || new Date().toISOString()\n          }));\n          \n          remainingDocs.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\n          localStorage.setItem('miki_recent_docs', JSON.stringify(remainingDocs));\n          \n          console.log(`📝 최근 문서 목록 재구성: ${remainingDocs.length}개`);\n        } catch (error) {\n          console.error('최근 문서 목록 재구성 오류:', error);\n        }\n      }\n      \n      // 6단계: 결과 보고\n      console.log(`\\n📊 === 정리 완료 보고서 ===`);\n      console.log(`총 문서: ${stats.totalDocuments}개`);\n      console.log(`보존된 문서: ${stats.preservedDocuments}개`);\n      console.log(`삭제된 문서: ${stats.deletedDocuments}개`);\n      console.log(`절약된 공간: ${(stats.spaceSaved / 1024).toFixed(1)}KB`);\n      \n      if (stats.backupCreated) {\n        console.log(`\\n🛡️ 백업 정보:`);\n        console.log(`백업 키: miki_backup_manual_*`);\n        console.log(`복구 방법: 개발자 도구에서 백업 키로 검색하여 복구 가능`);\n      }\n      \n      if (stats.errors.length > 0) {\n        console.log(`\\n⚠️ 오류 ${stats.errors.length}개:`);\n        stats.errors.forEach(error => console.log(`  - ${error}`));\n      }\n      \n    } catch (error) {\n      console.error('지정 문서 보존 정리 중 오류:', error);\n      stats.errors.push(`정리 오류: ${error.message}`);\n    }\n    \n    return stats;\n  }\n}\n\nexport default DocumentSearchManager; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\DocumentSummaryManager.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'API_TYPE' is assigned a value but never used.","line":10,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'headingPattern' is assigned a value but never used.","line":66,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// DocumentSummaryManager.js\n// 문서를 마크다운으로 변환하고 섹션별로 요약하는 클래스\n\n/**\n * 문서 요약 관리 클래스\n * Claude API를 사용하여 문서 요약 생성 및 관리\n */\n\n// API 타입 설정 - 브라우저 호환성을 위해 기본값 사용\nconst API_TYPE = (typeof process !== 'undefined' && process.env?.VITE_AI_API_TYPE) || 'claude';\n\n/**\n * 문서 요약 및 변환을 처리하는 클래스\n * AI 처리를 위한 토큰 최적화와 문맥 관리를 담당\n */\nclass DocumentSummaryManager {\n  constructor() {\n    this.summaries = new Map(); // 문서 ID 또는 경로를 키로, 요약 정보를 값으로 저장\n    this.maxSectionLength = 1000; // 섹션당 최대 문자 수 (약 250 토큰)\n    this.maxSummaryLength = 150; // 요약당 최대 문자 수 (약 40 토큰)\n  }\n\n  /**\n   * 문서를 섹션으로 분할하고 요약 생성\n   * @param {string} documentId - 문서 식별자\n   * @param {string} content - 마크다운 형식의 문서 내용\n   * @returns {Object} - 섹션 및 요약 정보를 포함한 객체\n   */\n  processDocument(documentId, content) {\n    if (!content) return null;\n\n    // 문서를 헤딩을 기준으로 섹션으로 분할\n    const sections = this._splitIntoSections(content);\n    \n    // 각 섹션에 대한 요약 생성\n    const processedSections = sections.map(section => {\n      const summary = this._generateSummary(section.content);\n      return {\n        ...section,\n        summary: summary\n      };\n    });\n\n    // 문서 전체 요약 생성\n    const documentSummary = this._generateDocumentSummary(processedSections);\n    \n    // 결과 객체 생성 및 캐시 저장\n    const result = {\n      id: documentId,\n      summary: documentSummary,\n      sections: processedSections,\n      lastUpdated: new Date().toISOString()\n    };\n    \n    this.summaries.set(documentId, result);\n    return result;\n  }\n\n  /**\n   * 문서를 헤딩을 기준으로 섹션으로 분할\n   * @param {string} content - 마크다운 형식의 문서 내용\n   * @returns {Array} - 섹션 객체 배열\n   */\n  _splitIntoSections(content) {\n    // 헤딩 패턴 (# 제목, ## 제목 등)\n    const headingPattern = /^(#{1,6})\\s+(.+)$/gm;\n    const lines = content.split('\\n');\n    const sections = [];\n    \n    let currentHeading = \"문서\";\n    let currentLevel = 0;\n    let currentContent = \"\";\n    let sectionStart = 0;\n    \n    // 헤딩이 없는 시작 부분을 첫 번째 섹션으로 처리\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i];\n      const headingMatch = line.match(/^(#{1,6})\\s+(.+)$/);\n      \n      if (headingMatch) {\n        // 첫 번째 헤딩을 만났을 때 이전 내용이 있으면 섹션으로 추가\n        if (currentContent.trim()) {\n          sections.push({\n            title: \"소개\",\n            level: 0,\n            content: currentContent.trim(),\n            startLine: sectionStart,\n            endLine: i - 1\n          });\n        }\n        \n        // 현재 헤딩 정보 업데이트\n        currentHeading = headingMatch[2];\n        currentLevel = headingMatch[1].length;\n        currentContent = line;\n        sectionStart = i;\n      } else {\n        // 헤딩이 아닌 일반 텍스트 줄 추가\n        currentContent += \"\\n\" + line;\n      }\n      \n      // 다음 헤딩을 만나거나 문서 끝에 도달하면 섹션 추가\n      const nextLine = i + 1 < lines.length ? lines[i + 1] : null;\n      const isNextHeading = nextLine && nextLine.match(/^(#{1,6})\\s+(.+)$/);\n      \n      if (isNextHeading || i === lines.length - 1) {\n        if (currentContent.trim()) {\n          sections.push({\n            title: currentHeading,\n            level: currentLevel,\n            content: currentContent.trim(),\n            startLine: sectionStart,\n            endLine: i\n          });\n        }\n        \n        if (isNextHeading) {\n          const nextHeadingMatch = nextLine.match(/^(#{1,6})\\s+(.+)$/);\n          currentHeading = nextHeadingMatch[2];\n          currentLevel = nextHeadingMatch[1].length;\n          currentContent = \"\";\n          sectionStart = i + 1;\n        }\n      }\n    }\n    \n    // 섹션이 없으면 전체 문서를 하나의 섹션으로 처리\n    if (sections.length === 0 && content.trim()) {\n      sections.push({\n        title: \"문서\",\n        level: 0,\n        content: content.trim(),\n        startLine: 0,\n        endLine: lines.length - 1\n      });\n    }\n    \n    return sections;\n  }\n  \n  /**\n   * 섹션 내용에 대한 간단한 요약 생성 (실제로는 AI를 통해 요약할 수 있음)\n   * @param {string} sectionContent - 섹션 내용\n   * @returns {string} - 섹션 요약\n   */\n  _generateSummary(sectionContent) {\n    // 간단한 요약 방식: 첫 번째 문장 또는 일정 길이 추출\n    if (!sectionContent) return \"\";\n    \n    // 너무 긴 섹션은 일정 길이만 사용\n    if (sectionContent.length > this.maxSectionLength) {\n      sectionContent = sectionContent.substring(0, this.maxSectionLength) + \"...\";\n    }\n    \n    // 첫 번째 문장 또는 첫 번째 줄을 요약으로 사용\n    let summary = \"\";\n    const firstSentenceMatch = sectionContent.match(/^.+?[.!?](?:\\s|$)/);\n    \n    if (firstSentenceMatch) {\n      summary = firstSentenceMatch[0].trim();\n    } else {\n      // 문장이 명확하지 않으면 첫 번째 줄 사용\n      const firstLine = sectionContent.split('\\n')[0].trim();\n      summary = firstLine;\n    }\n    \n    // 요약이 너무 길면 자르기\n    if (summary.length > this.maxSummaryLength) {\n      summary = summary.substring(0, this.maxSummaryLength) + \"...\";\n    }\n    \n    return summary;\n  }\n  \n  /**\n   * 문서 전체 요약 생성\n   * @param {Array} sections - 섹션 객체 배열\n   * @returns {string} - 문서 전체 요약\n   */\n  _generateDocumentSummary(sections) {\n    // 각 섹션의 제목을 모아서 문서 구조 요약 생성\n    const titles = sections.map(section => {\n      const indent = \"  \".repeat(Math.max(0, section.level - 1));\n      return `${indent}- ${section.title}`;\n    });\n    \n    return \"문서 구조:\\n\" + titles.join('\\n');\n  }\n  \n  /**\n   * 저장된 문서 요약 가져오기\n   * @param {string} documentId - 문서 식별자\n   * @returns {Object|null} - 저장된 요약 객체 또는 null\n   */\n  getSummary(documentId) {\n    return this.summaries.get(documentId) || null;\n  }\n  \n  /**\n   * 문서의 특정 부분 주변 컨텍스트 가져오기\n   * @param {string} documentId - 문서 식별자\n   * @param {number} lineNumber - 줄 번호\n   * @param {number} contextLines - 앞뒤로 포함할 줄 수\n   * @returns {Object|null} - 컨텍스트 정보 객체 또는 null\n   */\n  getContextAroundLine(documentId, lineNumber, contextLines = 5) {\n    const summary = this.summaries.get(documentId);\n    if (!summary) return null;\n    \n    // 해당 라인이 포함된 섹션 찾기\n    const section = summary.sections.find(\n      s => lineNumber >= s.startLine && lineNumber <= s.endLine\n    );\n    \n    if (!section) return null;\n    \n    // 섹션 내용에서 주변 컨텍스트 추출\n    const lines = section.content.split('\\n');\n    const lineIndex = lineNumber - section.startLine;\n    \n    const start = Math.max(0, lineIndex - contextLines);\n    const end = Math.min(lines.length - 1, lineIndex + contextLines);\n    \n    const contextLines_code = lines.slice(start, end + 1);\n    \n    return {\n      section: section.title,\n      context: contextLines_code.join('\\n'),\n      startLine: section.startLine + start,\n      endLine: section.startLine + end\n    };\n  }\n  \n  /**\n   * 캐시된 모든 요약 정보 지우기\n   */\n  clearCache() {\n    this.summaries.clear();\n  }\n}\n\nexport default DocumentSummaryManager; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\ServerDiagnostic.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":13,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":13,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[233,275],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":23,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":23,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[535,605],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":26,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":26,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[646,683],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":31,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":31,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[821,922],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":37,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":37,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1050,1087],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":42,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":42,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1222,1323],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":48,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":48,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1444,1478],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":58,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":58,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1892,1950],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":59,"column":41,"nodeType":"MemberExpression","messageId":"unexpected","endLine":59,"endColumn":52},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":61,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":61,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2039,2094],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":62,"column":36,"nodeType":"MemberExpression","messageId":"unexpected","endLine":62,"endColumn":47},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":64,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":64,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2204,2261],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":65,"column":40,"nodeType":"MemberExpression","messageId":"unexpected","endLine":65,"endColumn":51},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":67,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":67,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2349,2403],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":68,"column":35,"nodeType":"MemberExpression","messageId":"unexpected","endLine":68,"endColumn":46},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":71,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":71,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2547,2594],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":89,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":89,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3102,3144],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":90,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":90,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3154,3205],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":92,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":92,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3260,3301],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":97,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":97,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3361,3396],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":100,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":100,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3453,3513],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":102,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":102,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3565,3615],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":107,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":107,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3693,3753],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":109,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":109,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3804,3854],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":114,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":114,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3934,3993],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":116,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":116,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4051,4090],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":139,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":139,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4590,4623],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":161,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":161,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[5149,5195],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":173,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":173,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5327,5367],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":177,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":177,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5460,5493],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":187,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":187,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5709,5759],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":193,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":193,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5938,5977],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":198,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":198,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6100,6145],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":204,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":204,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6338,6375],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":210,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":210,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6569,6604],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":215,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":215,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6661,6707],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":219,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":219,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6766,6800],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":37,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 서버와 로컬 스토리지의 상세한 차이점을 분석하는 진단 도구\r\n */\r\nclass ServerDiagnostic {\r\n  constructor() {\r\n    this.serverUrl = 'http://localhost:3003/api/posts';\r\n  }\r\n\r\n  /**\r\n   * 서버와 로컬의 상세한 차이점 분석\r\n   */\r\n  async analyzeDiscrepancies() {\r\n    console.log('🔍 === 서버-로컬 불일치 분석 시작 ===');\r\n    \r\n    try {\r\n      // 1. 서버 문서 목록 가져오기\r\n      const serverResponse = await fetch(this.serverUrl);\r\n      const serverDocs = await serverResponse.json();\r\n      \r\n      // 2. 로컬 문서 목록 가져오기\r\n      const localDocs = this.getLocalDocuments();\r\n      \r\n      console.log(`📊 서버: ${serverDocs.length}개, 로컬: ${localDocs.length}개`);\r\n      \r\n      // 3. 서버 문서 상세 분석\r\n      console.log('\\n🌐 === 서버 문서 목록 ===');\r\n      const serverTitles = new Set();\r\n      const serverById = new Map();\r\n      \r\n      serverDocs.forEach((doc, index) => {\r\n        console.log(`${index + 1}. ID: \"${doc.id}\" | 제목: \"${doc.title}\" | 크기: ${doc.content?.length || 0}자`);\r\n        serverTitles.add(doc.title);\r\n        serverById.set(doc.id, doc);\r\n      });\r\n      \r\n      // 4. 로컬 문서 상세 분석\r\n      console.log('\\n📱 === 로컬 문서 목록 ===');\r\n      const localTitles = new Set();\r\n      const localById = new Map();\r\n      \r\n      localDocs.forEach((doc, index) => {\r\n        console.log(`${index + 1}. ID: \"${doc.id}\" | 제목: \"${doc.title}\" | 크기: ${doc.content?.length || 0}자`);\r\n        localTitles.add(doc.title);\r\n        localById.set(doc.id, doc);\r\n      });\r\n      \r\n      // 5. 차이점 분석\r\n      console.log('\\n❌ === 차이점 분석 ===');\r\n      \r\n      // 서버에만 있는 문서\r\n      const serverOnlyTitles = [...serverTitles].filter(title => !localTitles.has(title));\r\n      const serverOnlyIds = serverDocs.filter(doc => !localById.has(doc.id));\r\n      \r\n      // 로컬에만 있는 문서\r\n      const localOnlyTitles = [...localTitles].filter(title => !serverTitles.has(title));\r\n      const localOnlyIds = localDocs.filter(doc => !serverById.has(doc.id));\r\n      \r\n      console.log(`🌐 서버에만 있는 제목: ${serverOnlyTitles.length}개`);\r\n      serverOnlyTitles.forEach(title => console.log(`  - \"${title}\"`));\r\n      \r\n      console.log(`🌐 서버에만 있는 ID: ${serverOnlyIds.length}개`);\r\n      serverOnlyIds.forEach(doc => console.log(`  - ID: \"${doc.id}\" | 제목: \"${doc.title}\"`));\r\n      \r\n      console.log(`📱 로컬에만 있는 제목: ${localOnlyTitles.length}개`);\r\n      localOnlyTitles.forEach(title => console.log(`  - \"${title}\"`));\r\n      \r\n      console.log(`📱 로컬에만 있는 ID: ${localOnlyIds.length}개`);\r\n      localOnlyIds.forEach(doc => console.log(`  - ID: \"${doc.id}\" | 제목: \"${doc.title}\"`));\r\n      \r\n      // 6. 제목은 같지만 ID가 다른 문서들 찾기\r\n      console.log('\\n🔄 === 제목은 같지만 ID가 다른 문서들 ===');\r\n      const titleConflicts = [];\r\n      \r\n      serverDocs.forEach(serverDoc => {\r\n        const sameTitle = localDocs.filter(localDoc => \r\n          localDoc.title === serverDoc.title && localDoc.id !== serverDoc.id\r\n        );\r\n        \r\n        if (sameTitle.length > 0) {\r\n          titleConflicts.push({\r\n            title: serverDoc.title,\r\n            server: serverDoc,\r\n            local: sameTitle\r\n          });\r\n        }\r\n      });\r\n      \r\n      titleConflicts.forEach(conflict => {\r\n        console.log(`📝 제목: \"${conflict.title}\"`);\r\n        console.log(`  🌐 서버 ID: \"${conflict.server.id}\"`);\r\n        conflict.local.forEach(local => {\r\n          console.log(`  📱 로컬 ID: \"${local.id}\"`);\r\n        });\r\n      });\r\n      \r\n      // 7. 동기화 제안\r\n      console.log('\\n💡 === 동기화 제안 ===');\r\n      \r\n      if (serverOnlyIds.length > 0) {\r\n        console.log(`🔽 서버에서 로컬로 가져올 문서: ${serverOnlyIds.length}개`);\r\n        serverOnlyIds.forEach(doc => {\r\n          console.log(`  - \"${doc.title}\" (ID: ${doc.id})`);\r\n        });\r\n      }\r\n      \r\n      if (localOnlyIds.length > 0) {\r\n        console.log(`🔼 로컬에서 서버로 업로드할 문서: ${localOnlyIds.length}개`);\r\n        localOnlyIds.forEach(doc => {\r\n          console.log(`  - \"${doc.title}\" (ID: ${doc.id})`);\r\n        });\r\n      }\r\n      \r\n      if (titleConflicts.length > 0) {\r\n        console.log(`🔧 충돌 해결이 필요한 문서: ${titleConflicts.length}개`);\r\n        titleConflicts.forEach(conflict => {\r\n          console.log(`  - \"${conflict.title}\"`);\r\n        });\r\n      }\r\n      \r\n      return {\r\n        server: {\r\n          docs: serverDocs,\r\n          titles: serverTitles,\r\n          count: serverDocs.length\r\n        },\r\n        local: {\r\n          docs: localDocs,\r\n          titles: localTitles,\r\n          count: localDocs.length\r\n        },\r\n        differences: {\r\n          serverOnly: serverOnlyIds,\r\n          localOnly: localOnlyIds,\r\n          titleConflicts: titleConflicts\r\n        }\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 분석 실패:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 로컬 스토리지에서 문서 목록 가져오기\r\n   */\r\n  getLocalDocuments() {\r\n    const docs = [];\r\n    \r\n    Object.keys(localStorage).forEach(key => {\r\n      if (key.startsWith('miki_document_')) {\r\n        try {\r\n          const docData = JSON.parse(localStorage.getItem(key));\r\n          docs.push({\r\n            id: docData.id,\r\n            title: docData.title,\r\n            content: docData.content,\r\n            updatedAt: docData.updatedAt\r\n          });\r\n        } catch (error) {\r\n          console.warn(`⚠️ 로컬 문서 파싱 실패: ${key}`, error);\r\n        }\r\n      }\r\n    });\r\n    \r\n    return docs;\r\n  }\r\n\r\n  /**\r\n   * 자동 동기화 실행 (안전하게)\r\n   */\r\n  async performSafeSync() {\r\n    console.log('🔄 === 안전한 자동 동기화 시작 ===');\r\n    \r\n    const analysis = await this.analyzeDiscrepancies();\r\n    if (!analysis) {\r\n      console.error('❌ 분석 실패로 동기화 중단');\r\n      return false;\r\n    }\r\n    \r\n    const { differences } = analysis;\r\n    let syncCount = 0;\r\n    \r\n    try {\r\n      // 1. 서버에만 있는 문서들을 로컬로 가져오기\r\n      for (const serverDoc of differences.serverOnly) {\r\n        console.log(`🔽 서버에서 가져오기: \"${serverDoc.title}\"`);\r\n        \r\n        const localKey = `miki_document_${serverDoc.id}`;\r\n        localStorage.setItem(localKey, JSON.stringify(serverDoc));\r\n        \r\n        syncCount++;\r\n        console.log(`✅ 로컬 저장 완료: ${localKey}`);\r\n      }\r\n      \r\n      // 2. 제목 충돌 해결 (서버 버전을 우선으로)\r\n      for (const conflict of differences.titleConflicts) {\r\n        console.log(`🔧 충돌 해결: \"${conflict.title}\"`);\r\n        \r\n        // 로컬의 구버전 제거\r\n        conflict.local.forEach(localDoc => {\r\n          const oldKey = `miki_document_${localDoc.id}`;\r\n          localStorage.removeItem(oldKey);\r\n          console.log(`🗑️ 구버전 제거: ${oldKey}`);\r\n        });\r\n        \r\n        // 서버 버전을 로컬에 저장\r\n        const newKey = `miki_document_${conflict.server.id}`;\r\n        localStorage.setItem(newKey, JSON.stringify(conflict.server));\r\n        console.log(`✅ 신버전 저장: ${newKey}`);\r\n        \r\n        syncCount++;\r\n      }\r\n      \r\n      console.log(`🎉 동기화 완료: ${syncCount}개 문서 처리`);\r\n      return true;\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 동기화 실패:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\n// 전역에서 사용할 수 있도록 export\r\nexport default ServerDiagnostic; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\SyncManager.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":17,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":17,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[397,432],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":42,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":42,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[968,1022],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":90,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":90,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2485,2612],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":107,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":107,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3172,3225],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":110,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":110,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3303,3337],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":114,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":114,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3429,3473],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":139,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":139,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4317,4346],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":143,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":143,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4410,4443],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":155,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":155,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4637,4669],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":171,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":171,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5111,5153],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":172,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":172,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5161,5233],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":176,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":176,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5292,5328],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":188,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":188,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5604,5642],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":219,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":219,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6549,6595],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":231,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":231,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7031,7076],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":238,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":238,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7351,7399],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":246,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":246,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7642,7680],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":250,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":250,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7716,7810],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":254,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":254,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7871,7907],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":267,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":267,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8203,8247],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":271,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":271,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8333,8371],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":301,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":301,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9184,9240],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":314,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":314,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9673,9755],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":341,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":341,"endColumn":28,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11002,11047],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":344,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":344,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11102,11148],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":352,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":352,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11369,11419],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":357,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":357,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[11528,11582],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":362,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":362,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[11688,11749],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":366,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":366,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[11810,11846],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":376,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":376,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12013,12052],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":405,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":405,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[12956,13012],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":409,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":409,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[13077,13118],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":425,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":425,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13473,13501],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":462,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":462,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14564,14593],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":463,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":463,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[14601,14734],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":468,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":468,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[14808,14842],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":494,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":494,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15442,15474],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":508,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":508,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15858,15884],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":512,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":512,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15956,15992],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":39,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 로컬 스토리지와 서버 간의 동기화 및 매핑 오류 해결을 담당하는 클래스\r\n * 기존 DataSyncManager와 달리 안전하고 점진적인 동기화를 수행\r\n */\r\nclass SyncManager {\r\n  constructor() {\r\n    this.serverUrl = 'http://localhost:3003/api/posts';\r\n    this.syncInProgress = false;\r\n    this.backupKey = `miki_sync_backup_${Date.now()}`;\r\n  }\r\n\r\n  /**\r\n   * 1단계: 현재 상황 진단\r\n   * @returns {Object} - 진단 결과\r\n   */\r\n  async diagnoseCurrentState() {\r\n    console.log('=== 현재 상황 진단 시작 ===');\r\n    \r\n    const diagnosis = {\r\n      local: {\r\n        documents: [],\r\n        totalCount: 0,\r\n        duplicates: {},\r\n        issues: []\r\n      },\r\n      server: {\r\n        documents: [],\r\n        totalCount: 0,\r\n        accessible: false\r\n      },\r\n      mapping: {\r\n        conflicts: [],\r\n        orphans: []\r\n      }\r\n    };\r\n\r\n    try {\r\n      // 로컬 스토리지 분석\r\n      const localKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\r\n      diagnosis.local.totalCount = localKeys.length;\r\n      \r\n      console.log(`📱 로컬 스토리지: ${localKeys.length}개 문서 발견`);\r\n      \r\n      const titleGroups = {};\r\n      \r\n      for (const key of localKeys) {\r\n        try {\r\n          const docData = JSON.parse(localStorage.getItem(key));\r\n          const docId = key.replace('miki_document_', '');\r\n          \r\n          if (!docData || !docData.title) {\r\n            diagnosis.local.issues.push(`${key}: 제목 없음`);\r\n            continue;\r\n          }\r\n          \r\n          const doc = {\r\n            id: docId,\r\n            title: docData.title,\r\n            content: docData.content || '',\r\n            updatedAt: docData.updatedAt || new Date().toISOString(),\r\n            storageKey: key,\r\n            contentLength: (docData.content || '').length\r\n          };\r\n          \r\n          diagnosis.local.documents.push(doc);\r\n          \r\n          // 제목별 그룹화 (중복 검사)\r\n          const titleKey = docData.title.toLowerCase();\r\n          if (!titleGroups[titleKey]) {\r\n            titleGroups[titleKey] = [];\r\n          }\r\n          titleGroups[titleKey].push(doc);\r\n          \r\n        } catch (e) {\r\n          diagnosis.local.issues.push(`${key}: 파싱 오류 - ${e.message}`);\r\n        }\r\n      }\r\n      \r\n      // 중복 문서 찾기\r\n      for (const [title, docs] of Object.entries(titleGroups)) {\r\n        if (docs.length > 1) {\r\n          diagnosis.local.duplicates[title] = docs.map(d => ({\r\n            id: d.id,\r\n            updatedAt: d.updatedAt,\r\n            contentLength: d.contentLength\r\n          }));\r\n        }\r\n      }\r\n      \r\n      console.log(`📊 로컬 분석 완료: ${diagnosis.local.documents.length}개 유효, ${Object.keys(diagnosis.local.duplicates).length}개 제목에 중복`);\r\n      \r\n      // 서버 상태 확인\r\n      try {\r\n        const response = await fetch(this.serverUrl);\r\n        if (response.ok) {\r\n          const serverDocs = await response.json();\r\n          diagnosis.server.accessible = true;\r\n          diagnosis.server.totalCount = serverDocs.length;\r\n          diagnosis.server.documents = serverDocs.map(doc => ({\r\n            id: doc.id,\r\n            title: doc.title,\r\n            preview: doc.preview || '',\r\n            updatedAt: doc.updatedAt,\r\n            filename: doc.filename\r\n          }));\r\n          \r\n          console.log(`🌐 서버 분석 완료: ${serverDocs.length}개 문서`);\r\n        } else {\r\n          diagnosis.server.accessible = false;\r\n          console.warn('⚠️ 서버에 접근할 수 없습니다');\r\n        }\r\n      } catch (error) {\r\n        diagnosis.server.accessible = false;\r\n        console.error('❌ 서버 연결 실패:', error.message);\r\n      }\r\n      \r\n      // 매핑 충돌 분석\r\n      if (diagnosis.server.accessible) {\r\n        for (const localDoc of diagnosis.local.documents) {\r\n          const serverDoc = diagnosis.server.documents.find(s => s.id === localDoc.id);\r\n          const serverDocByTitle = diagnosis.server.documents.find(s => \r\n            s.title.toLowerCase() === localDoc.title.toLowerCase()\r\n          );\r\n          \r\n          if (serverDoc && serverDocByTitle && serverDoc.id !== serverDocByTitle.id) {\r\n            diagnosis.mapping.conflicts.push({\r\n              localDoc,\r\n              serverDocById: serverDoc,\r\n              serverDocByTitle: serverDocByTitle\r\n            });\r\n          }\r\n          \r\n          if (!serverDoc && !serverDocByTitle) {\r\n            diagnosis.mapping.orphans.push(localDoc);\r\n          }\r\n        }\r\n      }\r\n      \r\n      console.log('=== 진단 완료 ===');\r\n      return diagnosis;\r\n      \r\n    } catch (error) {\r\n      console.error('진단 중 오류:', error);\r\n      return diagnosis;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 2단계: 백업 생성\r\n   * @param {Object} diagnosis - 진단 결과\r\n   * @returns {boolean} - 백업 성공 여부\r\n   */\r\n  createBackup(diagnosis) {\r\n    try {\r\n      console.log('=== 백업 생성 시작 ===');\r\n      \r\n      const backup = {\r\n        timestamp: new Date().toISOString(),\r\n        diagnosis,\r\n        localStorage: {}\r\n      };\r\n      \r\n      // 모든 miki 관련 로컬 스토리지 데이터 백업\r\n      for (const key of Object.keys(localStorage)) {\r\n        if (key.startsWith('miki_')) {\r\n          backup.localStorage[key] = localStorage.getItem(key);\r\n        }\r\n      }\r\n      \r\n      localStorage.setItem(this.backupKey, JSON.stringify(backup));\r\n      console.log(`✅ 백업 완료: ${this.backupKey}`);\r\n      console.log(`📦 백업 크기: ${Object.keys(backup.localStorage).length}개 항목`);\r\n      \r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ 백업 생성 실패:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 3단계: 로컬 중복 문서 정리\r\n   * @param {Object} diagnosis - 진단 결과\r\n   * @param {Array} keepTitles - 보존할 문서 제목들\r\n   * @returns {Object} - 정리 결과\r\n   */\r\n  cleanupLocalDuplicates(diagnosis, keepTitles = ['제니', '로제', '먐시리', '블랙핑크']) {\r\n    console.log('=== 로컬 중복 문서 정리 시작 ===');\r\n    \r\n    const result = {\r\n      preserved: [],\r\n      removed: [],\r\n      errors: []\r\n    };\r\n    \r\n    try {\r\n      // 제목별로 그룹화\r\n      const titleGroups = {};\r\n      for (const doc of diagnosis.local.documents) {\r\n        const titleKey = doc.title.toLowerCase();\r\n        if (!titleGroups[titleKey]) {\r\n          titleGroups[titleKey] = [];\r\n        }\r\n        titleGroups[titleKey].push(doc);\r\n      }\r\n      \r\n      for (const [titleKey, docs] of Object.entries(titleGroups)) {\r\n        const shouldKeep = keepTitles.some(keepTitle => \r\n          titleKey === keepTitle.toLowerCase()\r\n        );\r\n        \r\n        if (!shouldKeep) {\r\n          // 보존하지 않을 문서들은 모두 삭제\r\n          for (const doc of docs) {\r\n            try {\r\n              localStorage.removeItem(doc.storageKey);\r\n              localStorage.removeItem(`miki_title_${doc.id}`);\r\n              result.removed.push(doc);\r\n              console.log(`❌ 삭제: ${doc.title} (보존 목록에 없음)`);\r\n            } catch (e) {\r\n              result.errors.push(`삭제 실패: ${doc.title} - ${e.message}`);\r\n            }\r\n          }\r\n        } else if (docs.length > 1) {\r\n          // 보존할 문서 중 중복이 있는 경우: 최신 버전만 유지\r\n          docs.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\r\n          const latest = docs[0];\r\n          const duplicates = docs.slice(1);\r\n          \r\n          result.preserved.push(latest);\r\n          console.log(`✅ 보존: ${latest.title} (최신 버전)`);\r\n          \r\n          for (const duplicate of duplicates) {\r\n            try {\r\n              localStorage.removeItem(duplicate.storageKey);\r\n              localStorage.removeItem(`miki_title_${duplicate.id}`);\r\n              result.removed.push(duplicate);\r\n              console.log(`❌ 삭제: ${duplicate.title} (중복 버전)`);\r\n            } catch (e) {\r\n              result.errors.push(`중복 삭제 실패: ${duplicate.title} - ${e.message}`);\r\n            }\r\n          }\r\n        } else {\r\n          // 보존할 문서 중 중복이 없는 경우\r\n          result.preserved.push(docs[0]);\r\n          console.log(`✅ 보존: ${docs[0].title}`);\r\n        }\r\n      }\r\n      \r\n      console.log(`=== 로컬 정리 완료: 보존 ${result.preserved.length}개, 삭제 ${result.removed.length}개 ===`);\r\n      return result;\r\n      \r\n    } catch (error) {\r\n      console.error('로컬 정리 중 오류:', error);\r\n      result.errors.push(`정리 오류: ${error.message}`);\r\n      return result;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 4단계: 서버와 로컬 매핑 수정\r\n   * @param {Object} diagnosis - 진단 결과\r\n   * @returns {Object} - 매핑 수정 결과\r\n   */\r\n  async fixServerLocalMapping(diagnosis) {\r\n    if (!diagnosis.server.accessible) {\r\n      console.log('⚠️ 서버에 접근할 수 없어 매핑 수정을 건너뜁니다');\r\n      return { success: false, reason: 'Server not accessible' };\r\n    }\r\n    \r\n    console.log('=== 서버-로컬 매핑 수정 시작 ===');\r\n    \r\n    const result = {\r\n      synced: [],\r\n      conflicts: [],\r\n      errors: []\r\n    };\r\n    \r\n    try {\r\n      // 현재 로컬에 남아있는 문서들 다시 확인\r\n      const currentLocalDocs = [];\r\n      const localKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\r\n      \r\n      for (const key of localKeys) {\r\n        try {\r\n          const docData = JSON.parse(localStorage.getItem(key));\r\n          if (docData && docData.title) {\r\n            currentLocalDocs.push({\r\n              id: key.replace('miki_document_', ''),\r\n              title: docData.title,\r\n              content: docData.content || '',\r\n              updatedAt: docData.updatedAt,\r\n              storageKey: key\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // 파싱 오류 무시\r\n        }\r\n      }\r\n      \r\n      console.log(`📱 현재 로컬 문서: ${currentLocalDocs.length}개`);\r\n      \r\n      // 각 로컬 문서에 대해 서버와 매핑 확인 및 수정\r\n      for (const localDoc of currentLocalDocs) {\r\n        try {\r\n          // 서버에서 같은 제목의 문서 찾기\r\n          const serverDoc = diagnosis.server.documents.find(s => \r\n            s.title.toLowerCase() === localDoc.title.toLowerCase()\r\n          );\r\n          \r\n          if (serverDoc) {\r\n            // 서버에 같은 제목의 문서가 있는 경우\r\n            if (serverDoc.id !== localDoc.id) {\r\n              console.log(`🔄 ID 불일치 수정: \"${localDoc.title}\" ${localDoc.id} → ${serverDoc.id}`);\r\n              \r\n              // 서버의 최신 내용 가져오기\r\n              const serverContentResponse = await fetch(`${this.serverUrl}/${serverDoc.id}`);\r\n              if (serverContentResponse.ok) {\r\n                const serverContent = await serverContentResponse.json();\r\n                \r\n                // 로컬 스토리지에서 기존 키 삭제\r\n                localStorage.removeItem(localDoc.storageKey);\r\n                localStorage.removeItem(`miki_title_${localDoc.id}`);\r\n                \r\n                // 서버 ID로 새로 저장\r\n                const newKey = `miki_document_${serverDoc.id}`;\r\n                localStorage.setItem(newKey, JSON.stringify({\r\n                  id: serverDoc.id,\r\n                  title: serverContent.title || localDoc.title,\r\n                  content: serverContent.content || localDoc.content,\r\n                  updatedAt: serverContent.updatedAt || localDoc.updatedAt\r\n                }));\r\n                localStorage.setItem(`miki_title_${serverDoc.id}`, serverContent.title || localDoc.title);\r\n                \r\n                result.synced.push({\r\n                  title: localDoc.title,\r\n                  oldId: localDoc.id,\r\n                  newId: serverDoc.id\r\n                });\r\n                \r\n                console.log(`✅ 매핑 수정 완료: ${localDoc.title}`);\r\n              }\r\n            } else {\r\n              console.log(`✅ 이미 올바른 매핑: ${localDoc.title}`);\r\n              result.synced.push({\r\n                title: localDoc.title,\r\n                id: localDoc.id,\r\n                status: 'already_correct'\r\n              });\r\n            }\r\n          } else {\r\n            console.log(`⚠️ 서버에 없는 로컬 문서: ${localDoc.title}`);\r\n            // 필요시 서버에 업로드하거나 로컬에서 제거할 수 있음\r\n          }\r\n          \r\n        } catch (error) {\r\n          console.error(`❌ 매핑 수정 실패: ${localDoc.title}`, error);\r\n          result.errors.push(`${localDoc.title}: ${error.message}`);\r\n        }\r\n      }\r\n      \r\n      console.log(`=== 매핑 수정 완료: ${result.synced.length}개 처리 ===`);\r\n      return result;\r\n      \r\n    } catch (error) {\r\n      console.error('매핑 수정 중 오류:', error);\r\n      result.errors.push(`매핑 수정 오류: ${error.message}`);\r\n      return result;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 5단계: 최근 문서 목록 재구성\r\n   */\r\n  rebuildRecentDocuments() {\r\n    console.log('=== 최근 문서 목록 재구성 시작 ===');\r\n    \r\n    try {\r\n      const documents = [];\r\n      const localKeys = Object.keys(localStorage).filter(key => key.startsWith('miki_document_'));\r\n      \r\n      for (const key of localKeys) {\r\n        try {\r\n          const docData = JSON.parse(localStorage.getItem(key));\r\n          if (docData && docData.title) {\r\n            documents.push({\r\n              id: docData.id || key.replace('miki_document_', ''),\r\n              title: docData.title,\r\n              updatedAt: docData.updatedAt || new Date().toISOString()\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // 파싱 오류 무시\r\n        }\r\n      }\r\n      \r\n      // 최신순 정렬\r\n      documents.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\r\n      \r\n      // 최대 20개만 유지\r\n      const recentDocs = documents.slice(0, 20);\r\n      \r\n      localStorage.setItem('miki_recent_docs', JSON.stringify(recentDocs));\r\n      \r\n      console.log(`✅ 최근 문서 목록 재구성 완료: ${recentDocs.length}개`);\r\n      return recentDocs;\r\n      \r\n    } catch (error) {\r\n      console.error('최근 문서 목록 재구성 오류:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 전체 동기화 실행\r\n   * @param {Array} keepTitles - 보존할 문서 제목들\r\n   * @returns {Object} - 동기화 결과\r\n   */\r\n  async performFullSync(keepTitles = ['제니', '로제', '먐시리', '블랙핑크']) {\r\n    if (this.syncInProgress) {\r\n      return { success: false, message: '동기화가 이미 진행 중입니다' };\r\n    }\r\n    \r\n    this.syncInProgress = true;\r\n    console.log('🚀 전체 동기화 시작');\r\n    \r\n    try {\r\n      // 1단계: 진단\r\n      const diagnosis = await this.diagnoseCurrentState();\r\n      \r\n      // 2단계: 백업\r\n      const backupSuccess = this.createBackup(diagnosis);\r\n      if (!backupSuccess) {\r\n        throw new Error('백업 생성 실패');\r\n      }\r\n      \r\n      // 3단계: 로컬 정리\r\n      const cleanupResult = this.cleanupLocalDuplicates(diagnosis, keepTitles);\r\n      \r\n      // 4단계: 매핑 수정\r\n      const mappingResult = await this.fixServerLocalMapping(diagnosis);\r\n      \r\n      // 5단계: 최근 문서 목록 재구성\r\n      const recentDocs = this.rebuildRecentDocuments();\r\n      \r\n      const finalResult = {\r\n        success: true,\r\n        diagnosis,\r\n        backup: this.backupKey,\r\n        cleanup: {\r\n          preserved: cleanupResult.preserved.length,\r\n          removed: cleanupResult.removed.length,\r\n          errors: cleanupResult.errors.length\r\n        },\r\n        mapping: {\r\n          synced: mappingResult.synced?.length || 0,\r\n          errors: mappingResult.errors?.length || 0\r\n        },\r\n        recentDocs: recentDocs.length\r\n      };\r\n      \r\n      console.log('🎉 전체 동기화 완료!');\r\n      console.log(`📊 결과: 보존 ${finalResult.cleanup.preserved}개, 삭제 ${finalResult.cleanup.removed}개, 매핑 수정 ${finalResult.mapping.synced}개`);\r\n      \r\n      return finalResult;\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 동기화 실패:', error);\r\n      return {\r\n        success: false,\r\n        message: error.message,\r\n        backup: this.backupKey\r\n      };\r\n    } finally {\r\n      this.syncInProgress = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 백업에서 복원\r\n   * @param {string} backupKey - 백업 키 (선택사항, 기본값은 최신 백업)\r\n   */\r\n  restoreFromBackup(backupKey = null) {\r\n    try {\r\n      const useBackupKey = backupKey || this.backupKey;\r\n      const backupData = localStorage.getItem(useBackupKey);\r\n      \r\n      if (!backupData) {\r\n        throw new Error('백업 데이터를 찾을 수 없습니다');\r\n      }\r\n      \r\n      const backup = JSON.parse(backupData);\r\n      \r\n      console.log('🔄 백업에서 복원 시작...');\r\n      \r\n      // 현재 miki 데이터 모두 삭제\r\n      for (const key of Object.keys(localStorage)) {\r\n        if (key.startsWith('miki_') && key !== useBackupKey) {\r\n          localStorage.removeItem(key);\r\n        }\r\n      }\r\n      \r\n      // 백업 데이터 복원\r\n      for (const [key, value] of Object.entries(backup.localStorage)) {\r\n        localStorage.setItem(key, value);\r\n      }\r\n      \r\n      console.log('✅ 백업 복원 완료');\r\n      return { success: true };\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 백업 복원 실패:', error);\r\n      return { success: false, message: error.message };\r\n    }\r\n  }\r\n}\r\n\r\nexport default SyncManager; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\database.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'trans' is defined but never used. Allowed unused args must match /^_/u.","line":15,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":66},{"ruleId":"no-unused-vars","severity":1,"message":"'primKey' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":69},{"ruleId":"no-unused-vars","severity":1,"message":"'obj' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":71,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":74},{"ruleId":"no-unused-vars","severity":1,"message":"'trans' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":81},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[958,1011],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":36,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":36,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1094,1144],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":39,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":39,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1199,1234],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":57,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":57,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1838,1889],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":65,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":65,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2108,2145],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":89,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":89,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3006,3049],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":98,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":98,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3160,3197],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":112,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":112,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3583,3635],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":130,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":130,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4078,4136],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":132,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":132,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4167,4206],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":205,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":205,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6136,6175],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":234,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":234,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6917,6946],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":238,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":238,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7018,7057],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":261,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":261,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7757,7797],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":280,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":280,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8273,8306],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":291,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":291,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[8742,8798],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":301,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":301,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8959,9000],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":21,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Dexie from 'dexie';\r\n\r\n// Database schema\r\nexport class MikiDatabase extends Dexie {\r\n  constructor() {\r\n    super('MikiEditorDB');\r\n    \r\n    // Define schemas\r\n    this.version(1).stores({\r\n      documents: '++id, title, content, updatedAt, isUserEditedTitle, isAutoSyncedTitle',\r\n      syncQueue: '++queueId, documentId, operation, status, retryAt, retryCount, data'\r\n    });\r\n    \r\n    // Add hooks for automatic timestamps\r\n    this.documents.hook('creating', function (primKey, obj, trans) {\r\n      obj.createdAt = new Date().toISOString();\r\n      obj.updatedAt = new Date().toISOString();\r\n    });\r\n    \r\n    this.documents.hook('updating', function (modifications, primKey, obj, trans) {\r\n      modifications.updatedAt = new Date().toISOString();\r\n    });\r\n  }\r\n}\r\n\r\n// Create database instance\r\nexport const db = new MikiDatabase();\r\n\r\n// Migration utilities\r\nexport class DatabaseMigration {\r\n  static async migrateFromLocalStorage() {\r\n    console.log('🔄 localStorage → IndexedDB 마이그레이션 시작');\r\n    \r\n    try {\r\n      const localDocs = this.getLocalStorageDocuments();\r\n      console.log(`📄 발견된 로컬 문서: ${localDocs.length}개`);\r\n      \r\n      if (localDocs.length === 0) {\r\n        console.log('✅ 마이그레이션할 문서가 없습니다.');\r\n        return { success: true, migrated: 0 };\r\n      }\r\n      \r\n      // Batch insert for better performance\r\n      await db.transaction('rw', db.documents, async () => {\r\n        for (const doc of localDocs) {\r\n          await db.documents.put({\r\n            id: doc.id,\r\n            title: doc.title || '제목 없음',\r\n            content: doc.content || '',\r\n            updatedAt: doc.updatedAt || new Date().toISOString(),\r\n            isUserEditedTitle: doc.isUserEditedTitle || false,\r\n            isAutoSyncedTitle: doc.isAutoSyncedTitle || false\r\n          });\r\n        }\r\n      });\r\n      \r\n      console.log(`✅ ${localDocs.length}개 문서 마이그레이션 완료`);\r\n      \r\n      // Mark migration as completed\r\n      localStorage.setItem('miki_migration_completed', 'true');\r\n      \r\n      return { success: true, migrated: localDocs.length };\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 마이그레이션 실패:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n  \r\n  static getLocalStorageDocuments() {\r\n    const documents = [];\r\n    const keys = Object.keys(localStorage);\r\n    \r\n    for (const key of keys) {\r\n      if (key.startsWith('miki_document_')) {\r\n        try {\r\n          const docData = JSON.parse(localStorage.getItem(key));\r\n          const id = key.replace('miki_document_', '');\r\n          \r\n          documents.push({\r\n            id: id,\r\n            title: docData.title || localStorage.getItem(`miki_title_${id}`) || '제목 없음',\r\n            content: docData.content || '',\r\n            updatedAt: docData.updatedAt || new Date().toISOString(),\r\n            isUserEditedTitle: docData.isUserEditedTitle || false,\r\n            isAutoSyncedTitle: docData.isAutoSyncedTitle || false\r\n          });\r\n        } catch (error) {\r\n          console.warn(`⚠️ 문서 파싱 실패: ${key}`, error);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return documents;\r\n  }\r\n  \r\n  static async cleanupLocalStorage() {\r\n    console.log('🧹 localStorage 정리 시작');\r\n    \r\n    const keysToRemove = [];\r\n    const keys = Object.keys(localStorage);\r\n    \r\n    for (const key of keys) {\r\n      if (key.startsWith('miki_document_') || \r\n          key.startsWith('miki_title_') ||\r\n          key.startsWith('miki_search_cache_')) {\r\n        keysToRemove.push(key);\r\n      }\r\n    }\r\n    \r\n    keysToRemove.forEach(key => localStorage.removeItem(key));\r\n    console.log(`🗑️ ${keysToRemove.length}개 항목 정리 완료`);\r\n  }\r\n}\r\n\r\n// Sync queue management\r\nexport class SyncQueue {\r\n  static async enqueue(documentId, operation, data = {}) {\r\n    try {\r\n      await db.syncQueue.add({\r\n        documentId,\r\n        operation, // 'create', 'update', 'delete'\r\n        status: 'pending',\r\n        retryAt: new Date().toISOString(),\r\n        retryCount: 0,\r\n        data: JSON.stringify(data),\r\n        createdAt: new Date().toISOString()\r\n      });\r\n      \r\n      console.log(`📤 동기화 큐에 추가: ${operation} - ${documentId}`);\r\n    } catch (error) {\r\n      console.error('❌ 동기화 큐 추가 실패:', error);\r\n    }\r\n  }\r\n  \r\n  static async getPendingItems() {\r\n    return await db.syncQueue\r\n      .where('status')\r\n      .equals('pending')\r\n      .and(item => new Date(item.retryAt) <= new Date())\r\n      .toArray();\r\n  }\r\n  \r\n  static async markAsCompleted(queueId) {\r\n    await db.syncQueue.update(queueId, { \r\n      status: 'completed',\r\n      completedAt: new Date().toISOString()\r\n    });\r\n  }\r\n  \r\n  static async markAsFailed(queueId, error) {\r\n    const item = await db.syncQueue.get(queueId);\r\n    const retryCount = (item?.retryCount || 0) + 1;\r\n    const maxRetries = 5;\r\n    \r\n    if (retryCount >= maxRetries) {\r\n      await db.syncQueue.update(queueId, {\r\n        status: 'failed',\r\n        retryCount,\r\n        lastError: error,\r\n        failedAt: new Date().toISOString()\r\n      });\r\n    } else {\r\n      // Exponential backoff: 2^retryCount minutes\r\n      const retryDelay = Math.pow(2, retryCount) * 60 * 1000;\r\n      const retryAt = new Date(Date.now() + retryDelay).toISOString();\r\n      \r\n      await db.syncQueue.update(queueId, {\r\n        status: 'pending',\r\n        retryCount,\r\n        retryAt,\r\n        lastError: error\r\n      });\r\n    }\r\n  }\r\n  \r\n  static async cleanup() {\r\n    // Remove completed items older than 7 days\r\n    const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString();\r\n    \r\n    await db.syncQueue\r\n      .where('status')\r\n      .equals('completed')\r\n      .and(item => item.completedAt < weekAgo)\r\n      .delete();\r\n  }\r\n}\r\n\r\n// Database utilities\r\nexport class DatabaseUtils {\r\n  static async exportData() {\r\n    try {\r\n      const documents = await db.documents.toArray();\r\n      const syncQueue = await db.syncQueue.toArray();\r\n      \r\n      const exportData = {\r\n        version: 1,\r\n        exportedAt: new Date().toISOString(),\r\n        documents,\r\n        syncQueue\r\n      };\r\n      \r\n      return JSON.stringify(exportData, null, 2);\r\n    } catch (error) {\r\n      console.error('❌ 데이터 내보내기 실패:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  static async importData(jsonData) {\r\n    try {\r\n      const data = JSON.parse(jsonData);\r\n      \r\n      if (data.version !== 1) {\r\n        throw new Error('지원하지 않는 데이터 버전입니다.');\r\n      }\r\n      \r\n      await db.transaction('rw', [db.documents, db.syncQueue], async () => {\r\n        // Clear existing data\r\n        await db.documents.clear();\r\n        await db.syncQueue.clear();\r\n        \r\n        // Import documents\r\n        if (data.documents?.length > 0) {\r\n          await db.documents.bulkAdd(data.documents);\r\n        }\r\n        \r\n        // Import sync queue\r\n        if (data.syncQueue?.length > 0) {\r\n          await db.syncQueue.bulkAdd(data.syncQueue);\r\n        }\r\n      });\r\n      \r\n      console.log('✅ 데이터 가져오기 완료');\r\n      return { success: true };\r\n      \r\n    } catch (error) {\r\n      console.error('❌ 데이터 가져오기 실패:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n  \r\n  static async getStorageInfo() {\r\n    try {\r\n      const docCount = await db.documents.count();\r\n      const queueCount = await db.syncQueue.count();\r\n      \r\n      // Estimate storage usage (rough calculation)\r\n      const docs = await db.documents.toArray();\r\n      const totalSize = docs.reduce((size, doc) => {\r\n        return size + (doc.content?.length || 0) + (doc.title?.length || 0);\r\n      }, 0);\r\n      \r\n      return {\r\n        documentCount: docCount,\r\n        queueCount: queueCount,\r\n        estimatedSize: totalSize,\r\n        formattedSize: this.formatBytes(totalSize)\r\n      };\r\n    } catch (error) {\r\n      console.error('❌ 저장소 정보 조회 실패:', error);\r\n      return null;\r\n    }\r\n  }\r\n  \r\n  static formatBytes(bytes) {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  }\r\n}\r\n\r\n// Initialize database and handle migrations\r\nexport const initializeDatabase = async () => {\r\n  try {\r\n    // Open database\r\n    await db.open();\r\n    console.log('✅ IndexedDB 연결 성공');\r\n    \r\n    // Check if migration is needed\r\n    const migrationCompleted = localStorage.getItem('miki_migration_completed');\r\n    \r\n    if (!migrationCompleted) {\r\n      const result = await DatabaseMigration.migrateFromLocalStorage();\r\n      \r\n      if (result.success && result.migrated > 0) {\r\n        // Optional: Clean up localStorage after successful migration\r\n        // await DatabaseMigration.cleanupLocalStorage();\r\n        console.log('📦 마이그레이션 완료, localStorage는 백업용으로 유지됩니다.');\r\n      }\r\n    }\r\n    \r\n    // Cleanup old sync queue items\r\n    await SyncQueue.cleanup();\r\n    \r\n    return { success: true };\r\n    \r\n  } catch (error) {\r\n    console.error('❌ 데이터베이스 초기화 실패:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n}; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\errorHandler.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":114,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":114,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3010,3172],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// 에러 타입 정의\r\nexport const ErrorTypes = {\r\n  NETWORK_ERROR: 'NETWORK_ERROR',\r\n  SERVER_ERROR: 'SERVER_ERROR',\r\n  NOT_FOUND: 'NOT_FOUND',\r\n  VALIDATION_ERROR: 'VALIDATION_ERROR',\r\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR',\r\n};\r\n\r\n// 에러 분류 함수\r\nexport const classifyError = (error) => {\r\n  if (!error) return ErrorTypes.UNKNOWN_ERROR;\r\n\r\n  // 네트워크 연결 오류\r\n  if (error.name === 'TypeError' && error.message.includes('fetch')) {\r\n    return ErrorTypes.NETWORK_ERROR;\r\n  }\r\n\r\n  // HTTP 상태 코드 기반 분류\r\n  if (error.message.includes('HTTP')) {\r\n    const statusMatch = error.message.match(/HTTP (\\d+)/);\r\n    if (statusMatch) {\r\n      const status = parseInt(statusMatch[1]);\r\n      if (status === 404) return ErrorTypes.NOT_FOUND;\r\n      if (status >= 400 && status < 500) return ErrorTypes.VALIDATION_ERROR;\r\n      if (status >= 500) return ErrorTypes.SERVER_ERROR;\r\n    }\r\n  }\r\n\r\n  // 특정 에러 메시지 패턴\r\n  if (error.message.includes('찾을 수 없습니다')) {\r\n    return ErrorTypes.NOT_FOUND;\r\n  }\r\n\r\n  return ErrorTypes.UNKNOWN_ERROR;\r\n};\r\n\r\n// 사용자 친화적 에러 메시지 생성\r\nexport const getErrorMessage = (error, context = '') => {\r\n  const errorType = classifyError(error);\r\n  \r\n  const messages = {\r\n    [ErrorTypes.NETWORK_ERROR]: {\r\n      title: '네트워크 연결 오류',\r\n      message: '인터넷 연결을 확인하고 다시 시도해주세요.',\r\n      action: '다시 시도',\r\n      canRetry: true,\r\n    },\r\n    [ErrorTypes.SERVER_ERROR]: {\r\n      title: '서버 오류',\r\n      message: '서버에 일시적인 문제가 발생했습니다. 잠시 후 다시 시도해주세요.',\r\n      action: '다시 시도',\r\n      canRetry: true,\r\n    },\r\n    [ErrorTypes.NOT_FOUND]: {\r\n      title: '문서를 찾을 수 없음',\r\n      message: '요청한 문서가 존재하지 않거나 삭제되었습니다.',\r\n      action: '목록으로 돌아가기',\r\n      canRetry: false,\r\n    },\r\n    [ErrorTypes.VALIDATION_ERROR]: {\r\n      title: '입력 오류',\r\n      message: '입력한 정보를 확인하고 다시 시도해주세요.',\r\n      action: '수정하기',\r\n      canRetry: false,\r\n    },\r\n    [ErrorTypes.UNKNOWN_ERROR]: {\r\n      title: '알 수 없는 오류',\r\n      message: '예상치 못한 오류가 발생했습니다.',\r\n      action: '다시 시도',\r\n      canRetry: true,\r\n    },\r\n  };\r\n\r\n  const errorInfo = messages[errorType];\r\n  \r\n  // 컨텍스트별 메시지 커스터마이징\r\n  if (context) {\r\n    switch (context) {\r\n      case 'save':\r\n        errorInfo.message = `문서 저장 중 ${errorInfo.message.toLowerCase()}`;\r\n        break;\r\n      case 'load':\r\n        errorInfo.message = `문서 불러오기 중 ${errorInfo.message.toLowerCase()}`;\r\n        break;\r\n      case 'delete':\r\n        errorInfo.message = `문서 삭제 중 ${errorInfo.message.toLowerCase()}`;\r\n        break;\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...errorInfo,\r\n    originalError: error,\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n};\r\n\r\n// 에러 로깅 함수\r\nexport const logError = (error, context = '', additionalInfo = {}) => {\r\n  const errorInfo = getErrorMessage(error, context);\r\n  \r\n  const logData = {\r\n    ...errorInfo,\r\n    context,\r\n    additionalInfo,\r\n    userAgent: navigator.userAgent,\r\n    url: window.location.href,\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n\r\n  // 개발 환경에서만 상세 로그 출력\r\n  if ((typeof process !== 'undefined' && process.env?.NODE_ENV === 'development') || false) {\r\n    console.error('🔍 Error Details:', {\r\n      message: error.message,\r\n      stack: error.stack,\r\n      context,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  }\r\n\r\n  // 프로덕션 환경에서는 에러 리포팅 서비스로 전송\r\n  if ((typeof process !== 'undefined' && process.env?.NODE_ENV === 'production') || false) {\r\n    // TODO: Sentry.captureException(error, { extra: logData });\r\n  }\r\n\r\n  return logData;\r\n};\r\n\r\n// 재시도 가능한 에러인지 확인\r\nexport const isRetryableError = (error) => {\r\n  const errorType = classifyError(error);\r\n  return [ErrorTypes.NETWORK_ERROR, ErrorTypes.SERVER_ERROR, ErrorTypes.UNKNOWN_ERROR].includes(errorType);\r\n};\r\n\r\n// 오프라인 상태 감지\r\nexport const isOfflineError = (error) => {\r\n  return classifyError(error) === ErrorTypes.NETWORK_ERROR;\r\n}; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\keywordExtractor.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\logger.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":25,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":25,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[590,633],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":31,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":31,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[721,763],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":37,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":37,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"info"},"fix":{"range":[851,893],"text":""},"desc":"Remove the console.info()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":43,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":43,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[994,1035],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":50,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":50,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"time"},"fix":{"range":[1146,1188],"text":""},"desc":"Remove the console.time()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":56,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":56,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"timeEnd"},"fix":{"range":[1289,1334],"text":""},"desc":"Remove the console.timeEnd()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":70,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":70,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1603,1635],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// 환경별 로깅 제어 유틸리티\r\nconst isDevelopment = (typeof process !== 'undefined' && process.env?.NODE_ENV === 'development') || false;\r\nconst isTest = (typeof process !== 'undefined' && process.env?.NODE_ENV === 'test') || false;\r\n\r\n// 로그 레벨 정의\r\nconst LOG_LEVELS = {\r\n  ERROR: 0,\r\n  WARN: 1,\r\n  INFO: 2,\r\n  DEBUG: 3\r\n};\r\n\r\n// 현재 로그 레벨 설정 (환경변수로 제어 가능)\r\nconst currentLogLevel = isDevelopment \r\n  ? LOG_LEVELS.DEBUG \r\n  : LOG_LEVELS.ERROR;\r\n\r\nclass Logger {\r\n  constructor(module = 'App') {\r\n    this.module = module;\r\n  }\r\n\r\n  error(...args) {\r\n    if (currentLogLevel >= LOG_LEVELS.ERROR) {\r\n      console.error(`[${this.module}]`, ...args);\r\n    }\r\n  }\r\n\r\n  warn(...args) {\r\n    if (currentLogLevel >= LOG_LEVELS.WARN) {\r\n      console.warn(`[${this.module}]`, ...args);\r\n    }\r\n  }\r\n\r\n  info(...args) {\r\n    if (currentLogLevel >= LOG_LEVELS.INFO) {\r\n      console.info(`[${this.module}]`, ...args);\r\n    }\r\n  }\r\n\r\n  debug(...args) {\r\n    if (currentLogLevel >= LOG_LEVELS.DEBUG && !isTest) {\r\n      console.log(`[${this.module}]`, ...args);\r\n    }\r\n  }\r\n\r\n  // 성능 측정용\r\n  time(label) {\r\n    if (currentLogLevel >= LOG_LEVELS.DEBUG && !isTest) {\r\n      console.time(`[${this.module}] ${label}`);\r\n    }\r\n  }\r\n\r\n  timeEnd(label) {\r\n    if (currentLogLevel >= LOG_LEVELS.DEBUG && !isTest) {\r\n      console.timeEnd(`[${this.module}] ${label}`);\r\n    }\r\n  }\r\n}\r\n\r\n// 모듈별 로거 생성 함수\r\nexport const createLogger = (module) => new Logger(module);\r\n\r\n// 기본 로거\r\nexport const logger = new Logger('App');\r\n\r\n// 레거시 console.log 대체용 (점진적 마이그레이션)\r\nexport const debugLog = (...args) => {\r\n  if (isDevelopment && !isTest) {\r\n    console.log('[DEBUG]', ...args);\r\n  }\r\n};\r\n\r\nexport default logger; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\halim\\Desktop\\miki_v4\\v7\\home\\ubuntu\\miki-editor\\src\\utils\\searchCache.js","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":27,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":27,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[801,848],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":42,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":42,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1275,1326],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":57,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":57,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[1692,1741],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":94,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":94,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[2522,2570],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":106,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":106,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2922,2984],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":126,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":126,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3370,3418],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":145,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":145,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3804,3853],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":180,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":180,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[4687,4735],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":226,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":226,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5934,5983],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":279,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":279,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[7315,7365],"text":""},"desc":"Remove the console.warn()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 검색 결과 캐싱 및 관리를 위한 유틸리티 클래스\r\n * 메모리 및 로컬 스토리지를 활용하여 검색 결과 캐싱\r\n */\r\n\r\nclass SearchCache {\r\n  constructor(options = {}) {\r\n    this.memoryCache = new Map(); // 메모리 내 캐시\r\n    this.localStoragePrefix = options.localStoragePrefix || 'miki_search_cache_';\r\n    this.defaultTtl = options.defaultTtl || 1000 * 60 * 30; // 기본 TTL: 30분\r\n    this.maxCacheSize = options.maxCacheSize || 100; // 최대 캐시 항목 수\r\n    this.useLocalStorage = options.useLocalStorage !== false; // 로컬스토리지 사용 여부\r\n    \r\n    // 초기화 시 캐시 정리\r\n    this.cleanup();\r\n  }\r\n  \r\n  /**\r\n   * 캐시에서 검색 결과 가져오기\r\n   * @param {string} key - 캐시 키\r\n   * @returns {Object|null} - 캐시된 결과 또는 null\r\n   */\r\n  get(key) {\r\n    // 1. 메모리 캐시 확인\r\n    const memoryItem = this.memoryCache.get(key);\r\n    if (memoryItem && memoryItem.expiry > Date.now()) {\r\n      console.log(`[SearchCache] 메모리 캐시 히트: ${key}`);\r\n      return memoryItem.value;\r\n    }\r\n    \r\n    // 2. 메모리 캐시에 없거나 만료된 경우 로컬 스토리지 확인\r\n    if (this.useLocalStorage) {\r\n      try {\r\n        const storageKey = this.localStoragePrefix + key;\r\n        const storedItem = localStorage.getItem(storageKey);\r\n        \r\n        if (storedItem) {\r\n          const item = JSON.parse(storedItem);\r\n          \r\n          // 만료 확인\r\n          if (item.expiry > Date.now()) {\r\n            console.log(`[SearchCache] 로컬 스토리지 캐시 히트: ${key}`);\r\n            \r\n            // 메모리 캐시에도 추가\r\n            this.memoryCache.set(key, {\r\n              value: item.value,\r\n              expiry: item.expiry\r\n            });\r\n            \r\n            return item.value;\r\n          } else {\r\n            // 만료된 항목 제거\r\n            localStorage.removeItem(storageKey);\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.warn('[SearchCache] 로컬 스토리지 액세스 오류:', e);\r\n      }\r\n    }\r\n    \r\n    // 캐시 미스\r\n    return null;\r\n  }\r\n  \r\n  /**\r\n   * 검색 결과를 캐시에 저장\r\n   * @param {string} key - 캐시 키\r\n   * @param {Object} value - 저장할 값\r\n   * @param {number} ttl - 캐시 유효 시간(ms)\r\n   */\r\n  set(key, value, ttl = this.defaultTtl) {\r\n    const expiry = Date.now() + ttl;\r\n    \r\n    // 1. 메모리 캐시에 저장\r\n    this.memoryCache.set(key, {\r\n      value,\r\n      expiry\r\n    });\r\n    \r\n    // 메모리 캐시 크기 제한\r\n    if (this.memoryCache.size > this.maxCacheSize) {\r\n      this.pruneMemoryCache();\r\n    }\r\n    \r\n    // 2. 로컬 스토리지에 저장\r\n    if (this.useLocalStorage) {\r\n      try {\r\n        const storageKey = this.localStoragePrefix + key;\r\n        localStorage.setItem(storageKey, JSON.stringify({\r\n          value,\r\n          expiry\r\n        }));\r\n      } catch (e) {\r\n        console.warn('[SearchCache] 로컬 스토리지 저장 오류:', e);\r\n        // 저장 실패 시 가장 오래된 항목 제거 후 재시도\r\n        this.pruneLocalStorageCache();\r\n        \r\n        try {\r\n          const storageKey = this.localStoragePrefix + key;\r\n          localStorage.setItem(storageKey, JSON.stringify({\r\n            value,\r\n            expiry\r\n          }));\r\n        } catch (retryError) {\r\n          // 재시도 실패 시 무시\r\n          console.error('[SearchCache] 로컬 스토리지 저장 재시도 실패:', retryError);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 특정 키의 캐시 삭제\r\n   * @param {string} key - 삭제할 캐시 키\r\n   */\r\n  delete(key) {\r\n    // 메모리 캐시에서 삭제\r\n    this.memoryCache.delete(key);\r\n    \r\n    // 로컬 스토리지에서 삭제\r\n    if (this.useLocalStorage) {\r\n      try {\r\n        const storageKey = this.localStoragePrefix + key;\r\n        localStorage.removeItem(storageKey);\r\n      } catch (e) {\r\n        console.warn('[SearchCache] 로컬 스토리지 삭제 오류:', e);\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 모든 캐시 항목 제거\r\n   */\r\n  clear() {\r\n    // 메모리 캐시 초기화\r\n    this.memoryCache.clear();\r\n    \r\n    // 로컬 스토리지 캐시 초기화\r\n    if (this.useLocalStorage) {\r\n      try {\r\n        Object.keys(localStorage)\r\n          .filter(key => key.startsWith(this.localStoragePrefix))\r\n          .forEach(key => localStorage.removeItem(key));\r\n      } catch (e) {\r\n        console.warn('[SearchCache] 로컬 스토리지 초기화 오류:', e);\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 만료된 캐시 항목 제거\r\n   */\r\n  cleanup() {\r\n    const now = Date.now();\r\n    \r\n    // 메모리 캐시 정리\r\n    for (const [key, item] of this.memoryCache.entries()) {\r\n      if (item.expiry < now) {\r\n        this.memoryCache.delete(key);\r\n      }\r\n    }\r\n    \r\n    // 로컬 스토리지 캐시 정리\r\n    if (this.useLocalStorage) {\r\n      try {\r\n        Object.keys(localStorage)\r\n          .filter(key => key.startsWith(this.localStoragePrefix))\r\n          .forEach(key => {\r\n            try {\r\n              const item = JSON.parse(localStorage.getItem(key));\r\n              if (item.expiry < now) {\r\n                localStorage.removeItem(key);\r\n              }\r\n            } catch (e) {\r\n              // 파싱 오류 시 항목 제거\r\n              localStorage.removeItem(key);\r\n            }\r\n          });\r\n      } catch (e) {\r\n        console.warn('[SearchCache] 로컬 스토리지 정리 오류:', e);\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 메모리 캐시 정리 (가장 오래된 항목부터 제거)\r\n   */\r\n  pruneMemoryCache() {\r\n    // 만료 시간 기준 정렬\r\n    const entries = Array.from(this.memoryCache.entries())\r\n      .sort((a, b) => a[1].expiry - b[1].expiry);\r\n    \r\n    // 절반 제거\r\n    const removeCount = Math.floor(this.memoryCache.size / 2);\r\n    entries.slice(0, removeCount).forEach(([key]) => {\r\n      this.memoryCache.delete(key);\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * 로컬 스토리지 캐시 정리 (가장 오래된 항목부터 제거)\r\n   */\r\n  pruneLocalStorageCache() {\r\n    try {\r\n      // 캐시 항목 추출 및 정렬\r\n      const cacheItems = Object.keys(localStorage)\r\n        .filter(key => key.startsWith(this.localStoragePrefix))\r\n        .map(key => {\r\n          try {\r\n            return {\r\n              key,\r\n              value: JSON.parse(localStorage.getItem(key))\r\n            };\r\n          } catch (e) {\r\n            return { key, value: { expiry: 0 } };\r\n          }\r\n        })\r\n        .sort((a, b) => a.value.expiry - b.value.expiry);\r\n      \r\n      // 절반 제거\r\n      const removeCount = Math.floor(cacheItems.length / 2);\r\n      cacheItems.slice(0, removeCount).forEach(item => {\r\n        localStorage.removeItem(item.key);\r\n      });\r\n    } catch (e) {\r\n      console.error('[SearchCache] 로컬 스토리지 정리 오류:', e);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * 검색 쿼리에 대한 캐시 키 생성\r\n   * @param {string} type - 검색 유형 (keyword, ai 등)\r\n   * @param {string} query - 검색 쿼리\r\n   * @param {Object} options - 추가 옵션\r\n   * @returns {string} - 캐시 키\r\n   */\r\n  static generateKey(type, query, options = {}) {\r\n    // 기본 키 생성\r\n    let key = `${type}_${query.toLowerCase().trim()}`;\r\n    \r\n    // 옵션에 따른 키 변형\r\n    if (options) {\r\n      const optionsStr = Object.entries(options)\r\n        .filter(([_, value]) => value !== undefined)\r\n        .sort(([keyA], [keyB]) => keyA.localeCompare(keyB))\r\n        .map(([key, value]) => `${key}:${JSON.stringify(value)}`)\r\n        .join('_');\r\n      \r\n      if (optionsStr) {\r\n        key += `_${optionsStr}`;\r\n      }\r\n    }\r\n    \r\n    return key;\r\n  }\r\n  \r\n  /**\r\n   * 모든 캐시 키 반환\r\n   * @returns {Array<string>} - 모든 캐시 키 배열\r\n   */\r\n  getAllKeys() {\r\n    const keys = new Set();\r\n    \r\n    // 메모리 캐시 키 추가\r\n    for (const key of this.memoryCache.keys()) {\r\n      keys.add(key);\r\n    }\r\n    \r\n    // 로컬 스토리지 캐시 키 추가\r\n    if (this.useLocalStorage) {\r\n      try {\r\n        Object.keys(localStorage)\r\n          .filter(key => key.startsWith(this.localStoragePrefix))\r\n          .forEach(key => {\r\n            const cacheKey = key.replace(this.localStoragePrefix, '');\r\n            keys.add(cacheKey);\r\n          });\r\n      } catch (e) {\r\n        console.warn('[SearchCache] 로컬 스토리지 키 조회 오류:', e);\r\n      }\r\n    }\r\n    \r\n    return Array.from(keys);\r\n  }\r\n}\r\n\r\nexport default SearchCache; ","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]